<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.50.0 (0)
 -->
<!-- Title: classes_ldm.models.diffusion.ddpm Pages: 1 -->
<svg width="4586pt" height="1971pt"
 viewBox="0.00 0.00 4586.00 1971.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 1967)">
<title>classes_ldm.models.diffusion.ddpm</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-1967 4582,-1967 4582,4 -4,4"/>
<!-- diffusion.ddpm.DDPM -->
<g id="node1" class="node">
<title>diffusion.ddpm.DDPM</title>
<polygon fill="none" stroke="black" points="899,-1218.5 899,-1962.5 1571,-1962.5 1571,-1218.5 899,-1218.5"/>
<text text-anchor="middle" x="1235" y="-1947.3" font-family="Times,serif" font-size="14.00">DDPM</text>
<polyline fill="none" stroke="black" points="899,-1939.5 1571,-1939.5 "/>
<text text-anchor="start" x="907" y="-1924.3" font-family="Times,serif" font-size="14.00">channels : int</text>
<text text-anchor="start" x="907" y="-1909.3" font-family="Times,serif" font-size="14.00">clip_denoised : bool</text>
<text text-anchor="start" x="907" y="-1894.3" font-family="Times,serif" font-size="14.00">cond_stage_model : NoneType</text>
<text text-anchor="start" x="907" y="-1879.3" font-family="Times,serif" font-size="14.00">first_stage_key : str</text>
<text text-anchor="start" x="907" y="-1864.3" font-family="Times,serif" font-size="14.00">image_size : int</text>
<text text-anchor="start" x="907" y="-1849.3" font-family="Times,serif" font-size="14.00">l_simple_weight : float</text>
<text text-anchor="start" x="907" y="-1834.3" font-family="Times,serif" font-size="14.00">learn_logvar : bool</text>
<text text-anchor="start" x="907" y="-1819.3" font-family="Times,serif" font-size="14.00">linear_end : float</text>
<text text-anchor="start" x="907" y="-1804.3" font-family="Times,serif" font-size="14.00">linear_start : float</text>
<text text-anchor="start" x="907" y="-1789.3" font-family="Times,serif" font-size="14.00">log_every_t : int</text>
<text text-anchor="start" x="907" y="-1774.3" font-family="Times,serif" font-size="14.00">logvar</text>
<text text-anchor="start" x="907" y="-1759.3" font-family="Times,serif" font-size="14.00">loss_type : str</text>
<text text-anchor="start" x="907" y="-1744.3" font-family="Times,serif" font-size="14.00">model</text>
<text text-anchor="start" x="907" y="-1729.3" font-family="Times,serif" font-size="14.00">model_ema</text>
<text text-anchor="start" x="907" y="-1714.3" font-family="Times,serif" font-size="14.00">monitor : str</text>
<text text-anchor="start" x="907" y="-1699.3" font-family="Times,serif" font-size="14.00">num_timesteps : int</text>
<text text-anchor="start" x="907" y="-1684.3" font-family="Times,serif" font-size="14.00">original_elbo_weight : float</text>
<text text-anchor="start" x="907" y="-1669.3" font-family="Times,serif" font-size="14.00">parameterization : str</text>
<text text-anchor="start" x="907" y="-1654.3" font-family="Times,serif" font-size="14.00">scheduler_config : NoneType</text>
<text text-anchor="start" x="907" y="-1639.3" font-family="Times,serif" font-size="14.00">use_ema : bool</text>
<text text-anchor="start" x="907" y="-1624.3" font-family="Times,serif" font-size="14.00">use_positional_encodings : bool</text>
<text text-anchor="start" x="907" y="-1609.3" font-family="Times,serif" font-size="14.00">use_scheduler</text>
<text text-anchor="start" x="907" y="-1594.3" font-family="Times,serif" font-size="14.00">v_posterior : float</text>
<polyline fill="none" stroke="black" points="899,-1586.5 1571,-1586.5 "/>
<text text-anchor="start" x="907" y="-1571.3" font-family="Times,serif" font-size="14.00">configure_optimizers()</text>
<text text-anchor="start" x="907" y="-1556.3" font-family="Times,serif" font-size="14.00">ema_scope(context)</text>
<text text-anchor="start" x="907" y="-1541.3" font-family="Times,serif" font-size="14.00">forward(x)</text>
<text text-anchor="start" x="907" y="-1526.3" font-family="Times,serif" font-size="14.00">get_input(batch, k)</text>
<text text-anchor="start" x="907" y="-1511.3" font-family="Times,serif" font-size="14.00">get_loss(pred, target, mean)</text>
<text text-anchor="start" x="907" y="-1496.3" font-family="Times,serif" font-size="14.00">get_v(x, noise, t)</text>
<text text-anchor="start" x="907" y="-1481.3" font-family="Times,serif" font-size="14.00">init_from_ckpt(path, ignore_keys, only_model)</text>
<text text-anchor="start" x="907" y="-1466.3" font-family="Times,serif" font-size="14.00">log_images(batch, N, n_row, sample, return_keys)</text>
<text text-anchor="start" x="907" y="-1451.3" font-family="Times,serif" font-size="14.00">on_train_batch_end()</text>
<text text-anchor="start" x="907" y="-1436.3" font-family="Times,serif" font-size="14.00">p_losses(x_start, t, noise)</text>
<text text-anchor="start" x="907" y="-1421.3" font-family="Times,serif" font-size="14.00">p_mean_variance(x, t, clip_denoised: bool)</text>
<text text-anchor="start" x="907" y="-1406.3" font-family="Times,serif" font-size="14.00">p_sample(x, t, clip_denoised, repeat_noise)</text>
<text text-anchor="start" x="907" y="-1391.3" font-family="Times,serif" font-size="14.00">p_sample_loop(shape, return_intermediates)</text>
<text text-anchor="start" x="907" y="-1376.3" font-family="Times,serif" font-size="14.00">predict_start_from_noise(x_t, t, noise)</text>
<text text-anchor="start" x="907" y="-1361.3" font-family="Times,serif" font-size="14.00">predict_start_from_z_and_v(x, v, t)</text>
<text text-anchor="start" x="907" y="-1346.3" font-family="Times,serif" font-size="14.00">q_mean_variance(x_start, t)</text>
<text text-anchor="start" x="907" y="-1331.3" font-family="Times,serif" font-size="14.00">q_posterior(x_start, x_t, t)</text>
<text text-anchor="start" x="907" y="-1316.3" font-family="Times,serif" font-size="14.00">q_sample(x_start, t, noise)</text>
<text text-anchor="start" x="907" y="-1301.3" font-family="Times,serif" font-size="14.00">q_sample_respace(x_start, t, sqrt_alphas_cumprod, sqrt_one_minus_alphas_cumprod, noise)</text>
<text text-anchor="start" x="907" y="-1286.3" font-family="Times,serif" font-size="14.00">register_schedule(given_betas, beta_schedule, timesteps, linear_start, linear_end, cosine_s)</text>
<text text-anchor="start" x="907" y="-1271.3" font-family="Times,serif" font-size="14.00">sample(batch_size, return_intermediates)</text>
<text text-anchor="start" x="907" y="-1256.3" font-family="Times,serif" font-size="14.00">shared_step(batch)</text>
<text text-anchor="start" x="907" y="-1241.3" font-family="Times,serif" font-size="14.00">training_step(batch, batch_idx)</text>
<text text-anchor="start" x="907" y="-1226.3" font-family="Times,serif" font-size="14.00">validation_step(batch, batch_idx)</text>
</g>
<!-- diffusion.ddpm.DiffusionWrapper -->
<g id="node2" class="node">
<title>diffusion.ddpm.DiffusionWrapper</title>
<polygon fill="none" stroke="black" points="0,-602.5 0,-686.5 496,-686.5 496,-602.5 0,-602.5"/>
<text text-anchor="middle" x="248" y="-671.3" font-family="Times,serif" font-size="14.00">DiffusionWrapper</text>
<polyline fill="none" stroke="black" points="0,-663.5 496,-663.5 "/>
<text text-anchor="start" x="8" y="-648.3" font-family="Times,serif" font-size="14.00">conditioning_key</text>
<text text-anchor="start" x="8" y="-633.3" font-family="Times,serif" font-size="14.00">diffusion_model</text>
<polyline fill="none" stroke="black" points="0,-625.5 496,-625.5 "/>
<text text-anchor="start" x="8" y="-610.3" font-family="Times,serif" font-size="14.00">forward(x, t, c_concat: list, c_crossattn: list, struct_cond, seg_cond)</text>
</g>
<!-- diffusion.ddpm.DiffusionWrapper&#45;&gt;diffusion.ddpm.DDPM -->
<g id="edge5" class="edge">
<title>diffusion.ddpm.DiffusionWrapper&#45;&gt;diffusion.ddpm.DDPM</title>
<path fill="none" stroke="black" d="M259.3,-686.85C287.02,-781.85 366.41,-1018.83 505,-1167 611.52,-1280.88 755.74,-1373.13 887.86,-1442.03"/>
<polygon fill="black" stroke="black" points="887.91,-1442.06 895.08,-1441.27 898.57,-1447.58 891.4,-1448.37 887.91,-1442.06"/>
<text text-anchor="middle" x="559" y="-1188.8" font-family="Times,serif" font-size="14.00" fill="green">model</text>
</g>
<!-- diffusion.ddpm.LatentDiffusion -->
<g id="node3" class="node">
<title>diffusion.ddpm.LatentDiffusion</title>
<polygon fill="none" stroke="black" points="514.5,-295 514.5,-994 1955.5,-994 1955.5,-295 514.5,-295"/>
<text text-anchor="middle" x="1235" y="-978.8" font-family="Times,serif" font-size="14.00">LatentDiffusion</text>
<polyline fill="none" stroke="black" points="514.5,-971 1955.5,-971 "/>
<text text-anchor="start" x="522.5" y="-955.8" font-family="Times,serif" font-size="14.00">bbox_tokenizer : NoneType</text>
<text text-anchor="start" x="522.5" y="-940.8" font-family="Times,serif" font-size="14.00">clip_denoised : bool</text>
<text text-anchor="start" x="522.5" y="-925.8" font-family="Times,serif" font-size="14.00">colorize</text>
<text text-anchor="start" x="522.5" y="-910.8" font-family="Times,serif" font-size="14.00">concat_mode : bool</text>
<text text-anchor="start" x="522.5" y="-895.8" font-family="Times,serif" font-size="14.00">cond_ids</text>
<text text-anchor="start" x="522.5" y="-880.8" font-family="Times,serif" font-size="14.00">cond_stage_forward : NoneType</text>
<text text-anchor="start" x="522.5" y="-865.8" font-family="Times,serif" font-size="14.00">cond_stage_key : str</text>
<text text-anchor="start" x="522.5" y="-850.8" font-family="Times,serif" font-size="14.00">cond_stage_model : NoneType</text>
<text text-anchor="start" x="522.5" y="-835.8" font-family="Times,serif" font-size="14.00">cond_stage_trainable : bool</text>
<text text-anchor="start" x="522.5" y="-820.8" font-family="Times,serif" font-size="14.00">first_stage_model</text>
<text text-anchor="start" x="522.5" y="-805.8" font-family="Times,serif" font-size="14.00">num_downs : int</text>
<text text-anchor="start" x="522.5" y="-790.8" font-family="Times,serif" font-size="14.00">num_timesteps_cond</text>
<text text-anchor="start" x="522.5" y="-775.8" font-family="Times,serif" font-size="14.00">restarted_from_ckpt : bool</text>
<text text-anchor="start" x="522.5" y="-760.8" font-family="Times,serif" font-size="14.00">scale_by_std : bool</text>
<text text-anchor="start" x="522.5" y="-745.8" font-family="Times,serif" font-size="14.00">scale_factor : float</text>
<text text-anchor="start" x="522.5" y="-730.8" font-family="Times,serif" font-size="14.00">shorten_cond_schedule</text>
<polyline fill="none" stroke="black" points="514.5,-723 1955.5,-723 "/>
<text text-anchor="start" x="522.5" y="-707.8" font-family="Times,serif" font-size="14.00">apply_model(x_noisy, t, cond, return_ids)</text>
<text text-anchor="start" x="522.5" y="-692.8" font-family="Times,serif" font-size="14.00">configure_optimizers()</text>
<text text-anchor="start" x="522.5" y="-677.8" font-family="Times,serif" font-size="14.00">decode_first_stage(z, predict_cids, force_not_quantize)</text>
<text text-anchor="start" x="522.5" y="-662.8" font-family="Times,serif" font-size="14.00">delta_border(h, w)</text>
<text text-anchor="start" x="522.5" y="-647.8" font-family="Times,serif" font-size="14.00">differentiable_decode_first_stage(z, predict_cids, force_not_quantize)</text>
<text text-anchor="start" x="522.5" y="-632.8" font-family="Times,serif" font-size="14.00">encode_first_stage(x)</text>
<text text-anchor="start" x="522.5" y="-617.8" font-family="Times,serif" font-size="14.00">forward(x, c)</text>
<text text-anchor="start" x="522.5" y="-602.8" font-family="Times,serif" font-size="14.00">get_first_stage_encoding(encoder_posterior)</text>
<text text-anchor="start" x="522.5" y="-587.8" font-family="Times,serif" font-size="14.00">get_fold_unfold(x, kernel_size, stride, uf, df)</text>
<text text-anchor="start" x="522.5" y="-572.8" font-family="Times,serif" font-size="14.00">get_input(batch, k, return_first_stage_outputs, force_c_encode, cond_key, return_original_cond, bs)</text>
<text text-anchor="start" x="522.5" y="-557.8" font-family="Times,serif" font-size="14.00">get_learned_conditioning(c)</text>
<text text-anchor="start" x="522.5" y="-542.8" font-family="Times,serif" font-size="14.00">get_weighting(h, w, Ly, Lx, device)</text>
<text text-anchor="start" x="522.5" y="-527.8" font-family="Times,serif" font-size="14.00">instantiate_cond_stage(config)</text>
<text text-anchor="start" x="522.5" y="-512.8" font-family="Times,serif" font-size="14.00">instantiate_first_stage(config)</text>
<text text-anchor="start" x="522.5" y="-497.8" font-family="Times,serif" font-size="14.00">log_images(batch, N, n_row, sample, ddim_steps, ddim_eta, return_keys, quantize_denoised, inpaint, plot_denoise_rows, plot_progressive_rows, plot_diffusion_rows)</text>
<text text-anchor="start" x="522.5" y="-482.8" font-family="Times,serif" font-size="14.00">make_cond_schedule()</text>
<text text-anchor="start" x="522.5" y="-467.8" font-family="Times,serif" font-size="14.00">meshgrid(h, w)</text>
<text text-anchor="start" x="522.5" y="-452.8" font-family="Times,serif" font-size="14.00">on_train_batch_start(batch, batch_idx, dataloader_idx)</text>
<text text-anchor="start" x="522.5" y="-437.8" font-family="Times,serif" font-size="14.00">p_losses(x_start, cond, t, noise)</text>
<text text-anchor="start" x="522.5" y="-422.8" font-family="Times,serif" font-size="14.00">p_mean_variance(x, c, t, clip_denoised: bool, return_codebook_ids, quantize_denoised, return_x0, score_corrector, corrector_kwargs)</text>
<text text-anchor="start" x="522.5" y="-407.8" font-family="Times,serif" font-size="14.00">p_sample(x, c, t, clip_denoised, repeat_noise, return_codebook_ids, quantize_denoised, return_x0, temperature, noise_dropout, score_corrector, corrector_kwargs)</text>
<text text-anchor="start" x="522.5" y="-392.8" font-family="Times,serif" font-size="14.00">p_sample_loop(cond, shape, return_intermediates, x_T, verbose, callback, timesteps, quantize_denoised, mask, x0, img_callback, start_T, log_every_t)</text>
<text text-anchor="start" x="522.5" y="-377.8" font-family="Times,serif" font-size="14.00">progressive_denoising(cond, shape, verbose, callback, quantize_denoised, img_callback, mask, x0, temperature, noise_dropout, score_corrector, corrector_kwargs, batch_size, x_T, start_T, log_every_t)</text>
<text text-anchor="start" x="522.5" y="-362.8" font-family="Times,serif" font-size="14.00">register_schedule(given_betas, beta_schedule, timesteps, linear_start, linear_end, cosine_s)</text>
<text text-anchor="start" x="522.5" y="-347.8" font-family="Times,serif" font-size="14.00">sample(cond, batch_size, return_intermediates, x_T, verbose, timesteps, quantize_denoised, mask, x0, shape)</text>
<text text-anchor="start" x="522.5" y="-332.8" font-family="Times,serif" font-size="14.00">sample_log(cond, batch_size, ddim, ddim_steps)</text>
<text text-anchor="start" x="522.5" y="-317.8" font-family="Times,serif" font-size="14.00">shared_step(batch)</text>
<text text-anchor="start" x="522.5" y="-302.8" font-family="Times,serif" font-size="14.00">to_rgb(x)</text>
</g>
<!-- diffusion.ddpm.LatentDiffusion&#45;&gt;diffusion.ddpm.DDPM -->
<g id="edge1" class="edge">
<title>diffusion.ddpm.LatentDiffusion&#45;&gt;diffusion.ddpm.DDPM</title>
<path fill="none" stroke="black" d="M1235,-994.33C1235,-1063.91 1235,-1137.33 1235,-1207.95"/>
<polygon fill="none" stroke="black" points="1231.5,-1208.35 1235,-1218.35 1238.5,-1208.35 1231.5,-1208.35"/>
</g>
<!-- diffusion.ddpm.LatentDiffusionSRTextWT -->
<g id="node4" class="node">
<title>diffusion.ddpm.LatentDiffusionSRTextWT</title>
<polygon fill="none" stroke="black" points="1974,-122.5 1974,-1166.5 4578,-1166.5 4578,-122.5 1974,-122.5"/>
<text text-anchor="middle" x="3276" y="-1151.3" font-family="Times,serif" font-size="14.00">LatentDiffusionSRTextWT</text>
<polyline fill="none" stroke="black" points="1974,-1143.5 4578,-1143.5 "/>
<text text-anchor="start" x="1982" y="-1128.3" font-family="Times,serif" font-size="14.00">bbox_tokenizer : NoneType</text>
<text text-anchor="start" x="1982" y="-1113.3" font-family="Times,serif" font-size="14.00">clip_denoised : bool</text>
<text text-anchor="start" x="1982" y="-1098.3" font-family="Times,serif" font-size="14.00">colorize</text>
<text text-anchor="start" x="1982" y="-1083.3" font-family="Times,serif" font-size="14.00">concat_mode : bool</text>
<text text-anchor="start" x="1982" y="-1068.3" font-family="Times,serif" font-size="14.00">cond_ids</text>
<text text-anchor="start" x="1982" y="-1053.3" font-family="Times,serif" font-size="14.00">cond_stage_forward : NoneType</text>
<text text-anchor="start" x="1982" y="-1038.3" font-family="Times,serif" font-size="14.00">cond_stage_key : str</text>
<text text-anchor="start" x="1982" y="-1023.3" font-family="Times,serif" font-size="14.00">cond_stage_model : NoneType</text>
<text text-anchor="start" x="1982" y="-1008.3" font-family="Times,serif" font-size="14.00">cond_stage_trainable : bool</text>
<text text-anchor="start" x="1982" y="-993.3" font-family="Times,serif" font-size="14.00">first_stage_model</text>
<text text-anchor="start" x="1982" y="-978.3" font-family="Times,serif" font-size="14.00">gt</text>
<text text-anchor="start" x="1982" y="-963.3" font-family="Times,serif" font-size="14.00">lq</text>
<text text-anchor="start" x="1982" y="-948.3" font-family="Times,serif" font-size="14.00">mix_ratio : float</text>
<text text-anchor="start" x="1982" y="-933.3" font-family="Times,serif" font-size="14.00">num_downs : int</text>
<text text-anchor="start" x="1982" y="-918.3" font-family="Times,serif" font-size="14.00">num_timesteps_cond</text>
<text text-anchor="start" x="1982" y="-903.3" font-family="Times,serif" font-size="14.00">ori_timesteps : list</text>
<text text-anchor="start" x="1982" y="-888.3" font-family="Times,serif" font-size="14.00">p2_gamma : NoneType</text>
<text text-anchor="start" x="1982" y="-873.3" font-family="Times,serif" font-size="14.00">p2_k : NoneType</text>
<text text-anchor="start" x="1982" y="-858.3" font-family="Times,serif" font-size="14.00">queue_gt</text>
<text text-anchor="start" x="1982" y="-843.3" font-family="Times,serif" font-size="14.00">queue_lr</text>
<text text-anchor="start" x="1982" y="-828.3" font-family="Times,serif" font-size="14.00">queue_ptr : int</text>
<text text-anchor="start" x="1982" y="-813.3" font-family="Times,serif" font-size="14.00">queue_size</text>
<text text-anchor="start" x="1982" y="-798.3" font-family="Times,serif" font-size="14.00">random_size : bool</text>
<text text-anchor="start" x="1982" y="-783.3" font-family="Times,serif" font-size="14.00">restarted_from_ckpt : bool</text>
<text text-anchor="start" x="1982" y="-768.3" font-family="Times,serif" font-size="14.00">scale_by_std : bool</text>
<text text-anchor="start" x="1982" y="-753.3" font-family="Times,serif" font-size="14.00">scale_factor : float</text>
<text text-anchor="start" x="1982" y="-738.3" font-family="Times,serif" font-size="14.00">shorten_cond_schedule</text>
<text text-anchor="start" x="1982" y="-723.3" font-family="Times,serif" font-size="14.00">snr : NoneType</text>
<text text-anchor="start" x="1982" y="-708.3" font-family="Times,serif" font-size="14.00">structcond_stage_model</text>
<text text-anchor="start" x="1982" y="-693.3" font-family="Times,serif" font-size="14.00">test_gt : bool</text>
<text text-anchor="start" x="1982" y="-678.3" font-family="Times,serif" font-size="14.00">time_replace : NoneType</text>
<text text-anchor="start" x="1982" y="-663.3" font-family="Times,serif" font-size="14.00">unfrozen_diff : bool</text>
<text text-anchor="start" x="1982" y="-648.3" font-family="Times,serif" font-size="14.00">use_usm : bool</text>
<polyline fill="none" stroke="black" points="1974,-640.5 4578,-640.5 "/>
<text text-anchor="start" x="1982" y="-625.3" font-family="Times,serif" font-size="14.00">apply_model(x_noisy, t, cond, struct_cond, return_ids)</text>
<text text-anchor="start" x="1982" y="-610.3" font-family="Times,serif" font-size="14.00">configure_optimizers()</text>
<text text-anchor="start" x="1982" y="-595.3" font-family="Times,serif" font-size="14.00">decode_first_stage(z, predict_cids, force_not_quantize)</text>
<text text-anchor="start" x="1982" y="-580.3" font-family="Times,serif" font-size="14.00">delta_border(h, w)</text>
<text text-anchor="start" x="1982" y="-565.3" font-family="Times,serif" font-size="14.00">differentiable_decode_first_stage(z, predict_cids, force_not_quantize)</text>
<text text-anchor="start" x="1982" y="-550.3" font-family="Times,serif" font-size="14.00">encode_first_stage(x)</text>
<text text-anchor="start" x="1982" y="-535.3" font-family="Times,serif" font-size="14.00">forward(x, c, gt)</text>
<text text-anchor="start" x="1982" y="-520.3" font-family="Times,serif" font-size="14.00">get_first_stage_encoding(encoder_posterior)</text>
<text text-anchor="start" x="1982" y="-505.3" font-family="Times,serif" font-size="14.00">get_fold_unfold(x, kernel_size, stride, uf, df)</text>
<text text-anchor="start" x="1982" y="-490.3" font-family="Times,serif" font-size="14.00">get_input(batch, k, return_first_stage_outputs, force_c_encode, cond_key, return_original_cond, bs, val, text_cond, return_gt, resize_lq)</text>
<text text-anchor="start" x="1982" y="-475.3" font-family="Times,serif" font-size="14.00">get_learned_conditioning(c)</text>
<text text-anchor="start" x="1982" y="-460.3" font-family="Times,serif" font-size="14.00">get_weighting(h, w, Ly, Lx, device)</text>
<text text-anchor="start" x="1982" y="-445.3" font-family="Times,serif" font-size="14.00">instantiate_cond_stage(config)</text>
<text text-anchor="start" x="1982" y="-430.3" font-family="Times,serif" font-size="14.00">instantiate_first_stage(config)</text>
<text text-anchor="start" x="1982" y="-415.3" font-family="Times,serif" font-size="14.00">instantiate_structcond_stage(config)</text>
<text text-anchor="start" x="1982" y="-400.3" font-family="Times,serif" font-size="14.00">log_images(batch, N, n_row, sample, ddim_steps, ddim_eta, return_keys, quantize_denoised, inpaint, plot_denoise_rows, plot_progressive_rows, plot_diffusion_rows)</text>
<text text-anchor="start" x="1982" y="-385.3" font-family="Times,serif" font-size="14.00">make_cond_schedule()</text>
<text text-anchor="start" x="1982" y="-370.3" font-family="Times,serif" font-size="14.00">meshgrid(h, w)</text>
<text text-anchor="start" x="1982" y="-355.3" font-family="Times,serif" font-size="14.00">on_train_batch_start(batch, batch_idx, dataloader_idx)</text>
<text text-anchor="start" x="1982" y="-340.3" font-family="Times,serif" font-size="14.00">p_losses(x_start, cond, struct_cond, t, t_ori, z_gt, noise)</text>
<text text-anchor="start" x="1982" y="-325.3" font-family="Times,serif" font-size="14.00">p_mean_variance(x, c, struct_cond, t, clip_denoised: bool, return_codebook_ids, quantize_denoised, return_x0, score_corrector, corrector_kwargs, t_replace, unconditional_conditioning, unconditional_guidance_scale, reference_sr, reference_lr, reference_step, reference_range)</text>
<text text-anchor="start" x="1982" y="-310.3" font-family="Times,serif" font-size="14.00">p_mean_variance_canvas(x, c, struct_cond, t, clip_denoised: bool, return_codebook_ids, quantize_denoised, return_x0, score_corrector, corrector_kwargs, t_replace, tile_size, tile_overlap, batch_size, tile_weights, unconditional_conditioning, unconditional_guidance_scale, reference_sr, reference_lr, reference_step, reference_range)</text>
<text text-anchor="start" x="1982" y="-295.3" font-family="Times,serif" font-size="14.00">p_sample(x, c, struct_cond, t, clip_denoised, repeat_noise, return_codebook_ids, quantize_denoised, return_x0, temperature, noise_dropout, score_corrector, corrector_kwargs, t_replace, unconditional_conditioning, unconditional_guidance_scale, reference_sr, reference_lr, reference_step, reference_range)</text>
<text text-anchor="start" x="1982" y="-280.3" font-family="Times,serif" font-size="14.00">p_sample_canvas(x, c, struct_cond, t, clip_denoised, repeat_noise, return_codebook_ids, quantize_denoised, return_x0, temperature, noise_dropout, score_corrector, corrector_kwargs, t_replace, tile_size, tile_overlap, batch_size, tile_weights, unconditional_conditioning, unconditional_guidance_scale, reference_sr, reference_lr, reference_step, reference_range)</text>
<text text-anchor="start" x="1982" y="-265.3" font-family="Times,serif" font-size="14.00">p_sample_loop(cond, struct_cond, shape, return_intermediates, x_T, verbose, callback, timesteps, quantize_denoised, mask, x0, img_callback, start_T, log_every_t, time_replace, adain_fea, interfea_path, unconditional_conditioning, unconditional_guidance_scale, reference_sr, reference_lr, reference_step, reference_range)</text>
<text text-anchor="start" x="1982" y="-250.3" font-family="Times,serif" font-size="14.00">p_sample_loop_canvas(cond, struct_cond, shape, return_intermediates, x_T, verbose, callback, timesteps, quantize_denoised, mask, x0, img_callback, start_T, log_every_t, time_replace, adain_fea, interfea_path, tile_size, tile_overlap, batch_size, unconditional_conditioning, unconditional_guidance_scale, reference_sr, reference_lr, reference_step, reference_range)</text>
<text text-anchor="start" x="1982" y="-235.3" font-family="Times,serif" font-size="14.00">progressive_denoising(cond, struct_cond, shape, verbose, callback, quantize_denoised, img_callback, mask, x0, temperature, noise_dropout, score_corrector, corrector_kwargs, batch_size, x_T, start_T, log_every_t)</text>
<text text-anchor="start" x="1982" y="-220.3" font-family="Times,serif" font-size="14.00">randn_cropinput(lq, gt, base_size)</text>
<text text-anchor="start" x="1982" y="-205.3" font-family="Times,serif" font-size="14.00">register_schedule(given_betas, beta_schedule, timesteps, linear_start, linear_end, cosine_s)</text>
<text text-anchor="start" x="1982" y="-190.3" font-family="Times,serif" font-size="14.00">sample(cond, struct_cond, batch_size, return_intermediates, x_T, verbose, timesteps, quantize_denoised, mask, x0, shape, time_replace, adain_fea, interfea_path, start_T, unconditional_conditioning, unconditional_guidance_scale, reference_sr, reference_lr, reference_step, reference_range)</text>
<text text-anchor="start" x="1982" y="-175.3" font-family="Times,serif" font-size="14.00">sample_canvas(cond, struct_cond, batch_size, return_intermediates, x_T, verbose, timesteps, quantize_denoised, mask, x0, shape, time_replace, adain_fea, interfea_path, tile_size, tile_overlap, batch_size_sample, log_every_t, unconditional_conditioning, unconditional_guidance_scale)</text>
<text text-anchor="start" x="1982" y="-160.3" font-family="Times,serif" font-size="14.00">sample_log(cond, struct_cond, batch_size, ddim, ddim_steps)</text>
<text text-anchor="start" x="1982" y="-145.3" font-family="Times,serif" font-size="14.00">shared_step(batch)</text>
<text text-anchor="start" x="1982" y="-130.3" font-family="Times,serif" font-size="14.00">to_rgb(x)</text>
</g>
<!-- diffusion.ddpm.LatentDiffusionSRTextWT&#45;&gt;diffusion.ddpm.DDPM -->
<g id="edge2" class="edge">
<title>diffusion.ddpm.LatentDiffusionSRTextWT&#45;&gt;diffusion.ddpm.DDPM</title>
<path fill="none" stroke="black" d="M2149.53,-1166.51C1942.52,-1262.26 1741.38,-1355.29 1580.69,-1429.61"/>
<polygon fill="none" stroke="black" points="1578.75,-1426.65 1571.14,-1434.03 1581.68,-1433.01 1578.75,-1426.65"/>
</g>
<!-- diffusion.ddpm.LatentDiffusionSRTextWTFFHQ -->
<g id="node5" class="node">
<title>diffusion.ddpm.LatentDiffusionSRTextWTFFHQ</title>
<polygon fill="none" stroke="black" points="2787.5,-0.5 2787.5,-84.5 3764.5,-84.5 3764.5,-0.5 2787.5,-0.5"/>
<text text-anchor="middle" x="3276" y="-69.3" font-family="Times,serif" font-size="14.00">LatentDiffusionSRTextWTFFHQ</text>
<polyline fill="none" stroke="black" points="2787.5,-61.5 3764.5,-61.5 "/>
<text text-anchor="start" x="2795.5" y="-46.3" font-family="Times,serif" font-size="14.00">gt</text>
<text text-anchor="start" x="2795.5" y="-31.3" font-family="Times,serif" font-size="14.00">lq</text>
<polyline fill="none" stroke="black" points="2787.5,-23.5 3764.5,-23.5 "/>
<text text-anchor="start" x="2795.5" y="-8.3" font-family="Times,serif" font-size="14.00">get_input(batch, k, return_first_stage_outputs, force_c_encode, cond_key, return_original_cond, bs, val, text_cond, return_gt, resize_lq)</text>
</g>
<!-- diffusion.ddpm.LatentDiffusionSRTextWTFFHQ&#45;&gt;diffusion.ddpm.LatentDiffusionSRTextWT -->
<g id="edge3" class="edge">
<title>diffusion.ddpm.LatentDiffusionSRTextWTFFHQ&#45;&gt;diffusion.ddpm.LatentDiffusionSRTextWT</title>
<path fill="none" stroke="black" d="M3276,-84.74C3276,-92.97 3276,-102.25 3276,-112.44"/>
<polygon fill="none" stroke="black" points="3272.5,-112.47 3276,-122.47 3279.5,-112.47 3272.5,-112.47"/>
</g>
<!-- diffusion.ddpm.Layout2ImgDiffusion -->
<g id="node6" class="node">
<title>diffusion.ddpm.Layout2ImgDiffusion</title>
<polygon fill="none" stroke="black" points="1151.5,-7.5 1151.5,-77.5 1318.5,-77.5 1318.5,-7.5 1151.5,-7.5"/>
<text text-anchor="middle" x="1235" y="-62.3" font-family="Times,serif" font-size="14.00">Layout2ImgDiffusion</text>
<polyline fill="none" stroke="black" points="1151.5,-54.5 1318.5,-54.5 "/>
<polyline fill="none" stroke="black" points="1151.5,-30.5 1318.5,-30.5 "/>
<text text-anchor="start" x="1159.5" y="-15.3" font-family="Times,serif" font-size="14.00">log_images(batch, N)</text>
</g>
<!-- diffusion.ddpm.Layout2ImgDiffusion&#45;&gt;diffusion.ddpm.LatentDiffusion -->
<g id="edge4" class="edge">
<title>diffusion.ddpm.Layout2ImgDiffusion&#45;&gt;diffusion.ddpm.LatentDiffusion</title>
<path fill="none" stroke="black" d="M1235,-77.91C1235,-120.97 1235,-199.44 1235,-284.51"/>
<polygon fill="none" stroke="black" points="1231.5,-284.64 1235,-294.64 1238.5,-284.64 1231.5,-284.64"/>
</g>
</g>
</svg>
