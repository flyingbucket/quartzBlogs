<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.50.0 (0)
 -->
<!-- Title: classes_ldm.models.diffusion Pages: 1 -->
<svg width="9187pt" height="2376pt"
 viewBox="0.00 0.00 9186.50 2376.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 2372)">
<title>classes_ldm.models.diffusion</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-2372 9182.5,-2372 9182.5,4 -4,4"/>
<!-- diffusion.ddim.DDIMSampler -->
<g id="node1" class="node">
<title>diffusion.ddim.DDIMSampler</title>
<polygon fill="none" stroke="black" points="0,-98 0,-392 2290,-392 2290,-98 0,-98"/>
<text text-anchor="middle" x="1145" y="-376.8" font-family="Times,serif" font-size="14.00">DDIMSampler</text>
<polyline fill="none" stroke="black" points="0,-369 2290,-369 "/>
<text text-anchor="start" x="8" y="-353.8" font-family="Times,serif" font-size="14.00">ddim_timesteps</text>
<text text-anchor="start" x="8" y="-338.8" font-family="Times,serif" font-size="14.00">ddpm_num_timesteps</text>
<text text-anchor="start" x="8" y="-323.8" font-family="Times,serif" font-size="14.00">model</text>
<text text-anchor="start" x="8" y="-308.8" font-family="Times,serif" font-size="14.00">schedule : str</text>
<polyline fill="none" stroke="black" points="0,-301 2290,-301 "/>
<text text-anchor="start" x="8" y="-285.8" font-family="Times,serif" font-size="14.00">ddim_sampling(cond, shape, x_T, ddim_use_original_steps, callback, timesteps, quantize_denoised, mask, x0, img_callback, log_every_t, temperature, noise_dropout, score_corrector, corrector_kwargs, unconditional_guidance_scale, unconditional_conditioning)</text>
<text text-anchor="start" x="8" y="-270.8" font-family="Times,serif" font-size="14.00">ddim_sampling_sr_t(cond, struct_cond, shape, x_T, ddim_use_original_steps, callback, timesteps, quantize_denoised, mask, x0, img_callback, log_every_t, temperature, noise_dropout, score_corrector, corrector_kwargs, unconditional_guidance_scale, unconditional_conditioning)</text>
<text text-anchor="start" x="8" y="-255.8" font-family="Times,serif" font-size="14.00">ddim_sampling_sr_t_canvas(cond, struct_cond, shape, x_T, ddim_use_original_steps, callback, timesteps, quantize_denoised, mask, x0, img_callback, log_every_t, temperature, noise_dropout, score_corrector, corrector_kwargs, unconditional_guidance_scale, unconditional_conditioning, tile_size, tile_overlap, batch_size)</text>
<text text-anchor="start" x="8" y="-240.8" font-family="Times,serif" font-size="14.00">decode(x_latent, cond, t_start, unconditional_guidance_scale, unconditional_conditioning, use_original_steps)</text>
<text text-anchor="start" x="8" y="-225.8" font-family="Times,serif" font-size="14.00">make_schedule(ddim_num_steps, ddim_discretize, ddim_eta, verbose)</text>
<text text-anchor="start" x="8" y="-210.8" font-family="Times,serif" font-size="14.00">p_sample_ddim(x, c, t, index, repeat_noise, use_original_steps, quantize_denoised, temperature, noise_dropout, score_corrector, corrector_kwargs, unconditional_guidance_scale, unconditional_conditioning)</text>
<text text-anchor="start" x="8" y="-195.8" font-family="Times,serif" font-size="14.00">p_sample_ddim_sr_t(x, c, struct_c, t, index, repeat_noise, use_original_steps, quantize_denoised, temperature, noise_dropout, score_corrector, corrector_kwargs, unconditional_guidance_scale, unconditional_conditioning)</text>
<text text-anchor="start" x="8" y="-180.8" font-family="Times,serif" font-size="14.00">p_sample_ddim_sr_tcanvas(x, c, struct_c, t, index, repeat_noise, use_original_steps, quantize_denoised, temperature, noise_dropout, score_corrector, corrector_kwargs, unconditional_guidance_scale, unconditional_conditioning, tile_size, tile_overlap, batch_size, tile_weights)</text>
<text text-anchor="start" x="8" y="-165.8" font-family="Times,serif" font-size="14.00">q_sample(x_start, t, noise, ddim_num_steps)</text>
<text text-anchor="start" x="8" y="-150.8" font-family="Times,serif" font-size="14.00">register_buffer(name, attr)</text>
<text text-anchor="start" x="8" y="-135.8" font-family="Times,serif" font-size="14.00">sample(S, batch_size, shape, conditioning, callback, normals_sequence, img_callback, quantize_x0, eta, mask, x0, temperature, noise_dropout, score_corrector, corrector_kwargs, verbose, x_T, log_every_t, unconditional_guidance_scale, unconditional_conditioning)</text>
<text text-anchor="start" x="8" y="-120.8" font-family="Times,serif" font-size="14.00">sample_sr_t(S, batch_size, shape, conditioning, struct_cond, callback, normals_sequence, img_callback, quantize_x0, eta, mask, x0, temperature, noise_dropout, score_corrector, corrector_kwargs, verbose, x_T, log_every_t, unconditional_guidance_scale, unconditional_conditioning)</text>
<text text-anchor="start" x="8" y="-105.8" font-family="Times,serif" font-size="14.00">stochastic_encode(x0, t, use_original_steps, noise)</text>
</g>
<!-- diffusion.ddpm.DDPM -->
<g id="node2" class="node">
<title>diffusion.ddpm.DDPM</title>
<polygon fill="none" stroke="black" points="2056,-1623.5 2056,-2367.5 2728,-2367.5 2728,-1623.5 2056,-1623.5"/>
<text text-anchor="middle" x="2392" y="-2352.3" font-family="Times,serif" font-size="14.00">DDPM</text>
<polyline fill="none" stroke="black" points="2056,-2344.5 2728,-2344.5 "/>
<text text-anchor="start" x="2064" y="-2329.3" font-family="Times,serif" font-size="14.00">channels : int</text>
<text text-anchor="start" x="2064" y="-2314.3" font-family="Times,serif" font-size="14.00">clip_denoised : bool</text>
<text text-anchor="start" x="2064" y="-2299.3" font-family="Times,serif" font-size="14.00">cond_stage_model : NoneType</text>
<text text-anchor="start" x="2064" y="-2284.3" font-family="Times,serif" font-size="14.00">first_stage_key : str</text>
<text text-anchor="start" x="2064" y="-2269.3" font-family="Times,serif" font-size="14.00">image_size : int</text>
<text text-anchor="start" x="2064" y="-2254.3" font-family="Times,serif" font-size="14.00">l_simple_weight : float</text>
<text text-anchor="start" x="2064" y="-2239.3" font-family="Times,serif" font-size="14.00">learn_logvar : bool</text>
<text text-anchor="start" x="2064" y="-2224.3" font-family="Times,serif" font-size="14.00">linear_end : float</text>
<text text-anchor="start" x="2064" y="-2209.3" font-family="Times,serif" font-size="14.00">linear_start : float</text>
<text text-anchor="start" x="2064" y="-2194.3" font-family="Times,serif" font-size="14.00">log_every_t : int</text>
<text text-anchor="start" x="2064" y="-2179.3" font-family="Times,serif" font-size="14.00">logvar</text>
<text text-anchor="start" x="2064" y="-2164.3" font-family="Times,serif" font-size="14.00">loss_type : str</text>
<text text-anchor="start" x="2064" y="-2149.3" font-family="Times,serif" font-size="14.00">model</text>
<text text-anchor="start" x="2064" y="-2134.3" font-family="Times,serif" font-size="14.00">model_ema</text>
<text text-anchor="start" x="2064" y="-2119.3" font-family="Times,serif" font-size="14.00">monitor : str</text>
<text text-anchor="start" x="2064" y="-2104.3" font-family="Times,serif" font-size="14.00">num_timesteps : int</text>
<text text-anchor="start" x="2064" y="-2089.3" font-family="Times,serif" font-size="14.00">original_elbo_weight : float</text>
<text text-anchor="start" x="2064" y="-2074.3" font-family="Times,serif" font-size="14.00">parameterization : str</text>
<text text-anchor="start" x="2064" y="-2059.3" font-family="Times,serif" font-size="14.00">scheduler_config : NoneType</text>
<text text-anchor="start" x="2064" y="-2044.3" font-family="Times,serif" font-size="14.00">use_ema : bool</text>
<text text-anchor="start" x="2064" y="-2029.3" font-family="Times,serif" font-size="14.00">use_positional_encodings : bool</text>
<text text-anchor="start" x="2064" y="-2014.3" font-family="Times,serif" font-size="14.00">use_scheduler</text>
<text text-anchor="start" x="2064" y="-1999.3" font-family="Times,serif" font-size="14.00">v_posterior : float</text>
<polyline fill="none" stroke="black" points="2056,-1991.5 2728,-1991.5 "/>
<text text-anchor="start" x="2064" y="-1976.3" font-family="Times,serif" font-size="14.00">configure_optimizers()</text>
<text text-anchor="start" x="2064" y="-1961.3" font-family="Times,serif" font-size="14.00">ema_scope(context)</text>
<text text-anchor="start" x="2064" y="-1946.3" font-family="Times,serif" font-size="14.00">forward(x)</text>
<text text-anchor="start" x="2064" y="-1931.3" font-family="Times,serif" font-size="14.00">get_input(batch, k)</text>
<text text-anchor="start" x="2064" y="-1916.3" font-family="Times,serif" font-size="14.00">get_loss(pred, target, mean)</text>
<text text-anchor="start" x="2064" y="-1901.3" font-family="Times,serif" font-size="14.00">get_v(x, noise, t)</text>
<text text-anchor="start" x="2064" y="-1886.3" font-family="Times,serif" font-size="14.00">init_from_ckpt(path, ignore_keys, only_model)</text>
<text text-anchor="start" x="2064" y="-1871.3" font-family="Times,serif" font-size="14.00">log_images(batch, N, n_row, sample, return_keys)</text>
<text text-anchor="start" x="2064" y="-1856.3" font-family="Times,serif" font-size="14.00">on_train_batch_end()</text>
<text text-anchor="start" x="2064" y="-1841.3" font-family="Times,serif" font-size="14.00">p_losses(x_start, t, noise)</text>
<text text-anchor="start" x="2064" y="-1826.3" font-family="Times,serif" font-size="14.00">p_mean_variance(x, t, clip_denoised: bool)</text>
<text text-anchor="start" x="2064" y="-1811.3" font-family="Times,serif" font-size="14.00">p_sample(x, t, clip_denoised, repeat_noise)</text>
<text text-anchor="start" x="2064" y="-1796.3" font-family="Times,serif" font-size="14.00">p_sample_loop(shape, return_intermediates)</text>
<text text-anchor="start" x="2064" y="-1781.3" font-family="Times,serif" font-size="14.00">predict_start_from_noise(x_t, t, noise)</text>
<text text-anchor="start" x="2064" y="-1766.3" font-family="Times,serif" font-size="14.00">predict_start_from_z_and_v(x, v, t)</text>
<text text-anchor="start" x="2064" y="-1751.3" font-family="Times,serif" font-size="14.00">q_mean_variance(x_start, t)</text>
<text text-anchor="start" x="2064" y="-1736.3" font-family="Times,serif" font-size="14.00">q_posterior(x_start, x_t, t)</text>
<text text-anchor="start" x="2064" y="-1721.3" font-family="Times,serif" font-size="14.00">q_sample(x_start, t, noise)</text>
<text text-anchor="start" x="2064" y="-1706.3" font-family="Times,serif" font-size="14.00">q_sample_respace(x_start, t, sqrt_alphas_cumprod, sqrt_one_minus_alphas_cumprod, noise)</text>
<text text-anchor="start" x="2064" y="-1691.3" font-family="Times,serif" font-size="14.00">register_schedule(given_betas, beta_schedule, timesteps, linear_start, linear_end, cosine_s)</text>
<text text-anchor="start" x="2064" y="-1676.3" font-family="Times,serif" font-size="14.00">sample(batch_size, return_intermediates)</text>
<text text-anchor="start" x="2064" y="-1661.3" font-family="Times,serif" font-size="14.00">shared_step(batch)</text>
<text text-anchor="start" x="2064" y="-1646.3" font-family="Times,serif" font-size="14.00">training_step(batch, batch_idx)</text>
<text text-anchor="start" x="2064" y="-1631.3" font-family="Times,serif" font-size="14.00">validation_step(batch, batch_idx)</text>
</g>
<!-- diffusion.ddpm_inv.DDPM -->
<g id="node3" class="node">
<title>diffusion.ddpm_inv.DDPM</title>
<polygon fill="none" stroke="black" points="5823.5,-1623.5 5823.5,-2367.5 6494.5,-2367.5 6494.5,-1623.5 5823.5,-1623.5"/>
<text text-anchor="middle" x="6159" y="-2352.3" font-family="Times,serif" font-size="14.00">DDPM</text>
<polyline fill="none" stroke="black" points="5823.5,-2344.5 6494.5,-2344.5 "/>
<text text-anchor="start" x="5831.5" y="-2329.3" font-family="Times,serif" font-size="14.00">channels : int</text>
<text text-anchor="start" x="5831.5" y="-2314.3" font-family="Times,serif" font-size="14.00">clip_denoised : bool</text>
<text text-anchor="start" x="5831.5" y="-2299.3" font-family="Times,serif" font-size="14.00">cond_stage_model : NoneType</text>
<text text-anchor="start" x="5831.5" y="-2284.3" font-family="Times,serif" font-size="14.00">embedding_reg_weight : float</text>
<text text-anchor="start" x="5831.5" y="-2269.3" font-family="Times,serif" font-size="14.00">first_stage_key : str</text>
<text text-anchor="start" x="5831.5" y="-2254.3" font-family="Times,serif" font-size="14.00">image_size : int</text>
<text text-anchor="start" x="5831.5" y="-2239.3" font-family="Times,serif" font-size="14.00">l_simple_weight : float</text>
<text text-anchor="start" x="5831.5" y="-2224.3" font-family="Times,serif" font-size="14.00">learn_logvar : bool</text>
<text text-anchor="start" x="5831.5" y="-2209.3" font-family="Times,serif" font-size="14.00">linear_end : float</text>
<text text-anchor="start" x="5831.5" y="-2194.3" font-family="Times,serif" font-size="14.00">linear_start : float</text>
<text text-anchor="start" x="5831.5" y="-2179.3" font-family="Times,serif" font-size="14.00">log_every_t : int</text>
<text text-anchor="start" x="5831.5" y="-2164.3" font-family="Times,serif" font-size="14.00">logvar</text>
<text text-anchor="start" x="5831.5" y="-2149.3" font-family="Times,serif" font-size="14.00">loss_type : str</text>
<text text-anchor="start" x="5831.5" y="-2134.3" font-family="Times,serif" font-size="14.00">model</text>
<text text-anchor="start" x="5831.5" y="-2119.3" font-family="Times,serif" font-size="14.00">model_ema</text>
<text text-anchor="start" x="5831.5" y="-2104.3" font-family="Times,serif" font-size="14.00">model_lr : float</text>
<text text-anchor="start" x="5831.5" y="-2089.3" font-family="Times,serif" font-size="14.00">monitor : str</text>
<text text-anchor="start" x="5831.5" y="-2074.3" font-family="Times,serif" font-size="14.00">num_timesteps : int</text>
<text text-anchor="start" x="5831.5" y="-2059.3" font-family="Times,serif" font-size="14.00">original_elbo_weight : float</text>
<text text-anchor="start" x="5831.5" y="-2044.3" font-family="Times,serif" font-size="14.00">parameterization : str</text>
<text text-anchor="start" x="5831.5" y="-2029.3" font-family="Times,serif" font-size="14.00">scheduler_config : NoneType</text>
<text text-anchor="start" x="5831.5" y="-2014.3" font-family="Times,serif" font-size="14.00">unfreeze_model : bool</text>
<text text-anchor="start" x="5831.5" y="-1999.3" font-family="Times,serif" font-size="14.00">use_ema : bool</text>
<text text-anchor="start" x="5831.5" y="-1984.3" font-family="Times,serif" font-size="14.00">use_positional_encodings : bool</text>
<text text-anchor="start" x="5831.5" y="-1969.3" font-family="Times,serif" font-size="14.00">use_scheduler</text>
<text text-anchor="start" x="5831.5" y="-1954.3" font-family="Times,serif" font-size="14.00">v_posterior : float</text>
<polyline fill="none" stroke="black" points="5823.5,-1946.5 6494.5,-1946.5 "/>
<text text-anchor="start" x="5831.5" y="-1931.3" font-family="Times,serif" font-size="14.00">configure_optimizers()</text>
<text text-anchor="start" x="5831.5" y="-1916.3" font-family="Times,serif" font-size="14.00">ema_scope(context)</text>
<text text-anchor="start" x="5831.5" y="-1901.3" font-family="Times,serif" font-size="14.00">forward(x)</text>
<text text-anchor="start" x="5831.5" y="-1886.3" font-family="Times,serif" font-size="14.00">get_input(batch, k)</text>
<text text-anchor="start" x="5831.5" y="-1871.3" font-family="Times,serif" font-size="14.00">get_loss(pred, target, mean)</text>
<text text-anchor="start" x="5831.5" y="-1856.3" font-family="Times,serif" font-size="14.00">init_from_ckpt(path, ignore_keys, only_model)</text>
<text text-anchor="start" x="5831.5" y="-1841.3" font-family="Times,serif" font-size="14.00">log_images(batch, N, n_row, sample, return_keys)</text>
<text text-anchor="start" x="5831.5" y="-1826.3" font-family="Times,serif" font-size="14.00">on_train_batch_end()</text>
<text text-anchor="start" x="5831.5" y="-1811.3" font-family="Times,serif" font-size="14.00">p_losses(x_start, t, noise)</text>
<text text-anchor="start" x="5831.5" y="-1796.3" font-family="Times,serif" font-size="14.00">p_mean_variance(x, t, clip_denoised: bool)</text>
<text text-anchor="start" x="5831.5" y="-1781.3" font-family="Times,serif" font-size="14.00">p_sample(x, t, clip_denoised, repeat_noise)</text>
<text text-anchor="start" x="5831.5" y="-1766.3" font-family="Times,serif" font-size="14.00">p_sample_loop(shape, return_intermediates)</text>
<text text-anchor="start" x="5831.5" y="-1751.3" font-family="Times,serif" font-size="14.00">predict_start_from_noise(x_t, t, noise)</text>
<text text-anchor="start" x="5831.5" y="-1736.3" font-family="Times,serif" font-size="14.00">q_mean_variance(x_start, t)</text>
<text text-anchor="start" x="5831.5" y="-1721.3" font-family="Times,serif" font-size="14.00">q_posterior(x_start, x_t, t)</text>
<text text-anchor="start" x="5831.5" y="-1706.3" font-family="Times,serif" font-size="14.00">q_sample(x_start, t, noise)</text>
<text text-anchor="start" x="5831.5" y="-1691.3" font-family="Times,serif" font-size="14.00">register_schedule(given_betas, beta_schedule, timesteps, linear_start, linear_end, cosine_s)</text>
<text text-anchor="start" x="5831.5" y="-1676.3" font-family="Times,serif" font-size="14.00">sample(batch_size, return_intermediates)</text>
<text text-anchor="start" x="5831.5" y="-1661.3" font-family="Times,serif" font-size="14.00">shared_step(batch)</text>
<text text-anchor="start" x="5831.5" y="-1646.3" font-family="Times,serif" font-size="14.00">training_step(batch, batch_idx)</text>
<text text-anchor="start" x="5831.5" y="-1631.3" font-family="Times,serif" font-size="14.00">validation_step(batch, batch_idx)</text>
</g>
<!-- diffusion.ddpm.DiffusionWrapper -->
<g id="node4" class="node">
<title>diffusion.ddpm.DiffusionWrapper</title>
<polygon fill="none" stroke="black" points="1157,-1007.5 1157,-1091.5 1653,-1091.5 1653,-1007.5 1157,-1007.5"/>
<text text-anchor="middle" x="1405" y="-1076.3" font-family="Times,serif" font-size="14.00">DiffusionWrapper</text>
<polyline fill="none" stroke="black" points="1157,-1068.5 1653,-1068.5 "/>
<text text-anchor="start" x="1165" y="-1053.3" font-family="Times,serif" font-size="14.00">conditioning_key</text>
<text text-anchor="start" x="1165" y="-1038.3" font-family="Times,serif" font-size="14.00">diffusion_model</text>
<polyline fill="none" stroke="black" points="1157,-1030.5 1653,-1030.5 "/>
<text text-anchor="start" x="1165" y="-1015.3" font-family="Times,serif" font-size="14.00">forward(x, t, c_concat: list, c_crossattn: list, struct_cond, seg_cond)</text>
</g>
<!-- diffusion.ddpm.DiffusionWrapper&#45;&gt;diffusion.ddpm.DDPM -->
<g id="edge7" class="edge">
<title>diffusion.ddpm.DiffusionWrapper&#45;&gt;diffusion.ddpm.DDPM</title>
<path fill="none" stroke="black" d="M1416.3,-1091.85C1444.02,-1186.85 1523.41,-1423.83 1662,-1572 1768.52,-1685.88 1912.74,-1778.13 2044.86,-1847.03"/>
<polygon fill="black" stroke="black" points="2044.91,-1847.06 2052.08,-1846.27 2055.57,-1852.58 2048.4,-1853.37 2044.91,-1847.06"/>
<text text-anchor="middle" x="1716" y="-1593.8" font-family="Times,serif" font-size="14.00" fill="green">model</text>
</g>
<!-- diffusion.ddpm_inv.DiffusionWrapper -->
<g id="node5" class="node">
<title>diffusion.ddpm_inv.DiffusionWrapper</title>
<polygon fill="none" stroke="black" points="5753.5,-1000 5753.5,-1099 6082.5,-1099 6082.5,-1000 5753.5,-1000"/>
<text text-anchor="middle" x="5918" y="-1083.8" font-family="Times,serif" font-size="14.00">DiffusionWrapper</text>
<polyline fill="none" stroke="black" points="5753.5,-1076 6082.5,-1076 "/>
<text text-anchor="start" x="5761.5" y="-1060.8" font-family="Times,serif" font-size="14.00">conditioning_key</text>
<text text-anchor="start" x="5761.5" y="-1045.8" font-family="Times,serif" font-size="14.00">diffusion_model</text>
<text text-anchor="start" x="5761.5" y="-1030.8" font-family="Times,serif" font-size="14.00">train</text>
<polyline fill="none" stroke="black" points="5753.5,-1023 6082.5,-1023 "/>
<text text-anchor="start" x="5761.5" y="-1007.8" font-family="Times,serif" font-size="14.00">forward(x, t, c_concat: list, c_crossattn: list)</text>
</g>
<!-- diffusion.ddpm_inv.DiffusionWrapper&#45;&gt;diffusion.ddpm_inv.DDPM -->
<g id="edge8" class="edge">
<title>diffusion.ddpm_inv.DiffusionWrapper&#45;&gt;diffusion.ddpm_inv.DDPM</title>
<path fill="none" stroke="black" d="M5930.45,-1099.27C5954.81,-1194.68 6010.8,-1414.01 6061.27,-1611.68"/>
<polygon fill="black" stroke="black" points="6061.31,-1611.84 6066.67,-1616.66 6064.28,-1623.46 6058.92,-1618.64 6061.31,-1611.84"/>
<text text-anchor="middle" x="6079" y="-1593.8" font-family="Times,serif" font-size="14.00" fill="green">model</text>
</g>
<!-- diffusion.ddpm.LatentDiffusion -->
<g id="node6" class="node">
<title>diffusion.ddpm.LatentDiffusion</title>
<polygon fill="none" stroke="black" points="1671.5,-700 1671.5,-1399 3112.5,-1399 3112.5,-700 1671.5,-700"/>
<text text-anchor="middle" x="2392" y="-1383.8" font-family="Times,serif" font-size="14.00">LatentDiffusion</text>
<polyline fill="none" stroke="black" points="1671.5,-1376 3112.5,-1376 "/>
<text text-anchor="start" x="1679.5" y="-1360.8" font-family="Times,serif" font-size="14.00">bbox_tokenizer : NoneType</text>
<text text-anchor="start" x="1679.5" y="-1345.8" font-family="Times,serif" font-size="14.00">clip_denoised : bool</text>
<text text-anchor="start" x="1679.5" y="-1330.8" font-family="Times,serif" font-size="14.00">colorize</text>
<text text-anchor="start" x="1679.5" y="-1315.8" font-family="Times,serif" font-size="14.00">concat_mode : bool</text>
<text text-anchor="start" x="1679.5" y="-1300.8" font-family="Times,serif" font-size="14.00">cond_ids</text>
<text text-anchor="start" x="1679.5" y="-1285.8" font-family="Times,serif" font-size="14.00">cond_stage_forward : NoneType</text>
<text text-anchor="start" x="1679.5" y="-1270.8" font-family="Times,serif" font-size="14.00">cond_stage_key : str</text>
<text text-anchor="start" x="1679.5" y="-1255.8" font-family="Times,serif" font-size="14.00">cond_stage_model : NoneType</text>
<text text-anchor="start" x="1679.5" y="-1240.8" font-family="Times,serif" font-size="14.00">cond_stage_trainable : bool</text>
<text text-anchor="start" x="1679.5" y="-1225.8" font-family="Times,serif" font-size="14.00">first_stage_model</text>
<text text-anchor="start" x="1679.5" y="-1210.8" font-family="Times,serif" font-size="14.00">num_downs : int</text>
<text text-anchor="start" x="1679.5" y="-1195.8" font-family="Times,serif" font-size="14.00">num_timesteps_cond</text>
<text text-anchor="start" x="1679.5" y="-1180.8" font-family="Times,serif" font-size="14.00">restarted_from_ckpt : bool</text>
<text text-anchor="start" x="1679.5" y="-1165.8" font-family="Times,serif" font-size="14.00">scale_by_std : bool</text>
<text text-anchor="start" x="1679.5" y="-1150.8" font-family="Times,serif" font-size="14.00">scale_factor : float</text>
<text text-anchor="start" x="1679.5" y="-1135.8" font-family="Times,serif" font-size="14.00">shorten_cond_schedule</text>
<polyline fill="none" stroke="black" points="1671.5,-1128 3112.5,-1128 "/>
<text text-anchor="start" x="1679.5" y="-1112.8" font-family="Times,serif" font-size="14.00">apply_model(x_noisy, t, cond, return_ids)</text>
<text text-anchor="start" x="1679.5" y="-1097.8" font-family="Times,serif" font-size="14.00">configure_optimizers()</text>
<text text-anchor="start" x="1679.5" y="-1082.8" font-family="Times,serif" font-size="14.00">decode_first_stage(z, predict_cids, force_not_quantize)</text>
<text text-anchor="start" x="1679.5" y="-1067.8" font-family="Times,serif" font-size="14.00">delta_border(h, w)</text>
<text text-anchor="start" x="1679.5" y="-1052.8" font-family="Times,serif" font-size="14.00">differentiable_decode_first_stage(z, predict_cids, force_not_quantize)</text>
<text text-anchor="start" x="1679.5" y="-1037.8" font-family="Times,serif" font-size="14.00">encode_first_stage(x)</text>
<text text-anchor="start" x="1679.5" y="-1022.8" font-family="Times,serif" font-size="14.00">forward(x, c)</text>
<text text-anchor="start" x="1679.5" y="-1007.8" font-family="Times,serif" font-size="14.00">get_first_stage_encoding(encoder_posterior)</text>
<text text-anchor="start" x="1679.5" y="-992.8" font-family="Times,serif" font-size="14.00">get_fold_unfold(x, kernel_size, stride, uf, df)</text>
<text text-anchor="start" x="1679.5" y="-977.8" font-family="Times,serif" font-size="14.00">get_input(batch, k, return_first_stage_outputs, force_c_encode, cond_key, return_original_cond, bs)</text>
<text text-anchor="start" x="1679.5" y="-962.8" font-family="Times,serif" font-size="14.00">get_learned_conditioning(c)</text>
<text text-anchor="start" x="1679.5" y="-947.8" font-family="Times,serif" font-size="14.00">get_weighting(h, w, Ly, Lx, device)</text>
<text text-anchor="start" x="1679.5" y="-932.8" font-family="Times,serif" font-size="14.00">instantiate_cond_stage(config)</text>
<text text-anchor="start" x="1679.5" y="-917.8" font-family="Times,serif" font-size="14.00">instantiate_first_stage(config)</text>
<text text-anchor="start" x="1679.5" y="-902.8" font-family="Times,serif" font-size="14.00">log_images(batch, N, n_row, sample, ddim_steps, ddim_eta, return_keys, quantize_denoised, inpaint, plot_denoise_rows, plot_progressive_rows, plot_diffusion_rows)</text>
<text text-anchor="start" x="1679.5" y="-887.8" font-family="Times,serif" font-size="14.00">make_cond_schedule()</text>
<text text-anchor="start" x="1679.5" y="-872.8" font-family="Times,serif" font-size="14.00">meshgrid(h, w)</text>
<text text-anchor="start" x="1679.5" y="-857.8" font-family="Times,serif" font-size="14.00">on_train_batch_start(batch, batch_idx, dataloader_idx)</text>
<text text-anchor="start" x="1679.5" y="-842.8" font-family="Times,serif" font-size="14.00">p_losses(x_start, cond, t, noise)</text>
<text text-anchor="start" x="1679.5" y="-827.8" font-family="Times,serif" font-size="14.00">p_mean_variance(x, c, t, clip_denoised: bool, return_codebook_ids, quantize_denoised, return_x0, score_corrector, corrector_kwargs)</text>
<text text-anchor="start" x="1679.5" y="-812.8" font-family="Times,serif" font-size="14.00">p_sample(x, c, t, clip_denoised, repeat_noise, return_codebook_ids, quantize_denoised, return_x0, temperature, noise_dropout, score_corrector, corrector_kwargs)</text>
<text text-anchor="start" x="1679.5" y="-797.8" font-family="Times,serif" font-size="14.00">p_sample_loop(cond, shape, return_intermediates, x_T, verbose, callback, timesteps, quantize_denoised, mask, x0, img_callback, start_T, log_every_t)</text>
<text text-anchor="start" x="1679.5" y="-782.8" font-family="Times,serif" font-size="14.00">progressive_denoising(cond, shape, verbose, callback, quantize_denoised, img_callback, mask, x0, temperature, noise_dropout, score_corrector, corrector_kwargs, batch_size, x_T, start_T, log_every_t)</text>
<text text-anchor="start" x="1679.5" y="-767.8" font-family="Times,serif" font-size="14.00">register_schedule(given_betas, beta_schedule, timesteps, linear_start, linear_end, cosine_s)</text>
<text text-anchor="start" x="1679.5" y="-752.8" font-family="Times,serif" font-size="14.00">sample(cond, batch_size, return_intermediates, x_T, verbose, timesteps, quantize_denoised, mask, x0, shape)</text>
<text text-anchor="start" x="1679.5" y="-737.8" font-family="Times,serif" font-size="14.00">sample_log(cond, batch_size, ddim, ddim_steps)</text>
<text text-anchor="start" x="1679.5" y="-722.8" font-family="Times,serif" font-size="14.00">shared_step(batch)</text>
<text text-anchor="start" x="1679.5" y="-707.8" font-family="Times,serif" font-size="14.00">to_rgb(x)</text>
</g>
<!-- diffusion.ddpm.LatentDiffusion&#45;&gt;diffusion.ddpm.DDPM -->
<g id="edge1" class="edge">
<title>diffusion.ddpm.LatentDiffusion&#45;&gt;diffusion.ddpm.DDPM</title>
<path fill="none" stroke="black" d="M2392,-1399.33C2392,-1468.91 2392,-1542.33 2392,-1612.95"/>
<polygon fill="none" stroke="black" points="2388.5,-1613.35 2392,-1623.35 2395.5,-1613.35 2388.5,-1613.35"/>
</g>
<!-- diffusion.ddpm_inv.LatentDiffusion -->
<g id="node7" class="node">
<title>diffusion.ddpm_inv.LatentDiffusion</title>
<polygon fill="none" stroke="black" points="6100.5,-662.5 6100.5,-1436.5 7541.5,-1436.5 7541.5,-662.5 6100.5,-662.5"/>
<text text-anchor="middle" x="6821" y="-1421.3" font-family="Times,serif" font-size="14.00">LatentDiffusion</text>
<polyline fill="none" stroke="black" points="6100.5,-1413.5 7541.5,-1413.5 "/>
<text text-anchor="start" x="6108.5" y="-1398.3" font-family="Times,serif" font-size="14.00">bbox_tokenizer : NoneType</text>
<text text-anchor="start" x="6108.5" y="-1383.3" font-family="Times,serif" font-size="14.00">clip_denoised : bool</text>
<text text-anchor="start" x="6108.5" y="-1368.3" font-family="Times,serif" font-size="14.00">colorize</text>
<text text-anchor="start" x="6108.5" y="-1353.3" font-family="Times,serif" font-size="14.00">concat_mode : bool</text>
<text text-anchor="start" x="6108.5" y="-1338.3" font-family="Times,serif" font-size="14.00">cond_ids</text>
<text text-anchor="start" x="6108.5" y="-1323.3" font-family="Times,serif" font-size="14.00">cond_stage_forward : NoneType</text>
<text text-anchor="start" x="6108.5" y="-1308.3" font-family="Times,serif" font-size="14.00">cond_stage_key : str</text>
<text text-anchor="start" x="6108.5" y="-1293.3" font-family="Times,serif" font-size="14.00">cond_stage_model : NoneType</text>
<text text-anchor="start" x="6108.5" y="-1278.3" font-family="Times,serif" font-size="14.00">cond_stage_trainable : bool</text>
<text text-anchor="start" x="6108.5" y="-1263.3" font-family="Times,serif" font-size="14.00">embedding_manager</text>
<text text-anchor="start" x="6108.5" y="-1248.3" font-family="Times,serif" font-size="14.00">first_stage_model</text>
<text text-anchor="start" x="6108.5" y="-1233.3" font-family="Times,serif" font-size="14.00">num_downs : int</text>
<text text-anchor="start" x="6108.5" y="-1218.3" font-family="Times,serif" font-size="14.00">num_timesteps_cond</text>
<text text-anchor="start" x="6108.5" y="-1203.3" font-family="Times,serif" font-size="14.00">restarted_from_ckpt : bool</text>
<text text-anchor="start" x="6108.5" y="-1188.3" font-family="Times,serif" font-size="14.00">scale_by_std : bool</text>
<text text-anchor="start" x="6108.5" y="-1173.3" font-family="Times,serif" font-size="14.00">scale_factor : float</text>
<text text-anchor="start" x="6108.5" y="-1158.3" font-family="Times,serif" font-size="14.00">shorten_cond_schedule</text>
<polyline fill="none" stroke="black" points="6100.5,-1150.5 7541.5,-1150.5 "/>
<text text-anchor="start" x="6108.5" y="-1135.3" font-family="Times,serif" font-size="14.00">apply_model(x_noisy, t, cond, return_ids)</text>
<text text-anchor="start" x="6108.5" y="-1120.3" font-family="Times,serif" font-size="14.00">configure_opt_embedding()</text>
<text text-anchor="start" x="6108.5" y="-1105.3" font-family="Times,serif" font-size="14.00">configure_opt_model()</text>
<text text-anchor="start" x="6108.5" y="-1090.3" font-family="Times,serif" font-size="14.00">configure_optimizers()</text>
<text text-anchor="start" x="6108.5" y="-1075.3" font-family="Times,serif" font-size="14.00">decode_first_stage(z, predict_cids, force_not_quantize)</text>
<text text-anchor="start" x="6108.5" y="-1060.3" font-family="Times,serif" font-size="14.00">delta_border(h, w)</text>
<text text-anchor="start" x="6108.5" y="-1045.3" font-family="Times,serif" font-size="14.00">differentiable_decode_first_stage(z, predict_cids, force_not_quantize)</text>
<text text-anchor="start" x="6108.5" y="-1030.3" font-family="Times,serif" font-size="14.00">encode_first_stage(x)</text>
<text text-anchor="start" x="6108.5" y="-1015.3" font-family="Times,serif" font-size="14.00">forward(x, c)</text>
<text text-anchor="start" x="6108.5" y="-1000.3" font-family="Times,serif" font-size="14.00">get_first_stage_encoding(encoder_posterior)</text>
<text text-anchor="start" x="6108.5" y="-985.3" font-family="Times,serif" font-size="14.00">get_fold_unfold(x, kernel_size, stride, uf, df)</text>
<text text-anchor="start" x="6108.5" y="-970.3" font-family="Times,serif" font-size="14.00">get_input(batch, k, return_first_stage_outputs, force_c_encode, cond_key, return_original_cond, bs)</text>
<text text-anchor="start" x="6108.5" y="-955.3" font-family="Times,serif" font-size="14.00">get_learned_conditioning(c)</text>
<text text-anchor="start" x="6108.5" y="-940.3" font-family="Times,serif" font-size="14.00">get_weighting(h, w, Ly, Lx, device)</text>
<text text-anchor="start" x="6108.5" y="-925.3" font-family="Times,serif" font-size="14.00">instantiate_cond_stage(config)</text>
<text text-anchor="start" x="6108.5" y="-910.3" font-family="Times,serif" font-size="14.00">instantiate_embedding_manager(config, embedder)</text>
<text text-anchor="start" x="6108.5" y="-895.3" font-family="Times,serif" font-size="14.00">instantiate_first_stage(config)</text>
<text text-anchor="start" x="6108.5" y="-880.3" font-family="Times,serif" font-size="14.00">log_images(batch, N, n_row, sample, ddim_steps, ddim_eta, return_keys, quantize_denoised, inpaint, plot_denoise_rows, plot_progressive_rows, plot_diffusion_rows)</text>
<text text-anchor="start" x="6108.5" y="-865.3" font-family="Times,serif" font-size="14.00">make_cond_schedule()</text>
<text text-anchor="start" x="6108.5" y="-850.3" font-family="Times,serif" font-size="14.00">meshgrid(h, w)</text>
<text text-anchor="start" x="6108.5" y="-835.3" font-family="Times,serif" font-size="14.00">on_save_checkpoint(checkpoint)</text>
<text text-anchor="start" x="6108.5" y="-820.3" font-family="Times,serif" font-size="14.00">on_train_batch_start(batch, batch_idx, dataloader_idx)</text>
<text text-anchor="start" x="6108.5" y="-805.3" font-family="Times,serif" font-size="14.00">p_losses(x_start, cond, t, noise)</text>
<text text-anchor="start" x="6108.5" y="-790.3" font-family="Times,serif" font-size="14.00">p_mean_variance(x, c, t, clip_denoised: bool, return_codebook_ids, quantize_denoised, return_x0, score_corrector, corrector_kwargs)</text>
<text text-anchor="start" x="6108.5" y="-775.3" font-family="Times,serif" font-size="14.00">p_sample(x, c, t, clip_denoised, repeat_noise, return_codebook_ids, quantize_denoised, return_x0, temperature, noise_dropout, score_corrector, corrector_kwargs)</text>
<text text-anchor="start" x="6108.5" y="-760.3" font-family="Times,serif" font-size="14.00">p_sample_loop(cond, shape, return_intermediates, x_T, verbose, callback, timesteps, quantize_denoised, mask, x0, img_callback, start_T, log_every_t)</text>
<text text-anchor="start" x="6108.5" y="-745.3" font-family="Times,serif" font-size="14.00">progressive_denoising(cond, shape, verbose, callback, quantize_denoised, img_callback, mask, x0, temperature, noise_dropout, score_corrector, corrector_kwargs, batch_size, x_T, start_T, log_every_t)</text>
<text text-anchor="start" x="6108.5" y="-730.3" font-family="Times,serif" font-size="14.00">register_schedule(given_betas, beta_schedule, timesteps, linear_start, linear_end, cosine_s)</text>
<text text-anchor="start" x="6108.5" y="-715.3" font-family="Times,serif" font-size="14.00">sample(cond, batch_size, return_intermediates, x_T, verbose, timesteps, quantize_denoised, mask, x0, shape)</text>
<text text-anchor="start" x="6108.5" y="-700.3" font-family="Times,serif" font-size="14.00">sample_log(cond, batch_size, ddim, ddim_steps)</text>
<text text-anchor="start" x="6108.5" y="-685.3" font-family="Times,serif" font-size="14.00">shared_step(batch)</text>
<text text-anchor="start" x="6108.5" y="-670.3" font-family="Times,serif" font-size="14.00">to_rgb(x)</text>
</g>
<!-- diffusion.ddpm_inv.LatentDiffusion&#45;&gt;diffusion.ddpm_inv.DDPM -->
<g id="edge5" class="edge">
<title>diffusion.ddpm_inv.LatentDiffusion&#45;&gt;diffusion.ddpm_inv.DDPM</title>
<path fill="none" stroke="black" d="M6550.31,-1436.5C6509.02,-1495.38 6466.43,-1556.11 6425.24,-1614.85"/>
<polygon fill="none" stroke="black" points="6422.31,-1612.93 6419.43,-1623.13 6428.04,-1616.95 6422.31,-1612.93"/>
</g>
<!-- diffusion.ddpm.LatentDiffusionSRTextWT -->
<g id="node8" class="node">
<title>diffusion.ddpm.LatentDiffusionSRTextWT</title>
<polygon fill="none" stroke="black" points="3131,-527.5 3131,-1571.5 5735,-1571.5 5735,-527.5 3131,-527.5"/>
<text text-anchor="middle" x="4433" y="-1556.3" font-family="Times,serif" font-size="14.00">LatentDiffusionSRTextWT</text>
<polyline fill="none" stroke="black" points="3131,-1548.5 5735,-1548.5 "/>
<text text-anchor="start" x="3139" y="-1533.3" font-family="Times,serif" font-size="14.00">bbox_tokenizer : NoneType</text>
<text text-anchor="start" x="3139" y="-1518.3" font-family="Times,serif" font-size="14.00">clip_denoised : bool</text>
<text text-anchor="start" x="3139" y="-1503.3" font-family="Times,serif" font-size="14.00">colorize</text>
<text text-anchor="start" x="3139" y="-1488.3" font-family="Times,serif" font-size="14.00">concat_mode : bool</text>
<text text-anchor="start" x="3139" y="-1473.3" font-family="Times,serif" font-size="14.00">cond_ids</text>
<text text-anchor="start" x="3139" y="-1458.3" font-family="Times,serif" font-size="14.00">cond_stage_forward : NoneType</text>
<text text-anchor="start" x="3139" y="-1443.3" font-family="Times,serif" font-size="14.00">cond_stage_key : str</text>
<text text-anchor="start" x="3139" y="-1428.3" font-family="Times,serif" font-size="14.00">cond_stage_model : NoneType</text>
<text text-anchor="start" x="3139" y="-1413.3" font-family="Times,serif" font-size="14.00">cond_stage_trainable : bool</text>
<text text-anchor="start" x="3139" y="-1398.3" font-family="Times,serif" font-size="14.00">first_stage_model</text>
<text text-anchor="start" x="3139" y="-1383.3" font-family="Times,serif" font-size="14.00">gt</text>
<text text-anchor="start" x="3139" y="-1368.3" font-family="Times,serif" font-size="14.00">lq</text>
<text text-anchor="start" x="3139" y="-1353.3" font-family="Times,serif" font-size="14.00">mix_ratio : float</text>
<text text-anchor="start" x="3139" y="-1338.3" font-family="Times,serif" font-size="14.00">num_downs : int</text>
<text text-anchor="start" x="3139" y="-1323.3" font-family="Times,serif" font-size="14.00">num_timesteps_cond</text>
<text text-anchor="start" x="3139" y="-1308.3" font-family="Times,serif" font-size="14.00">ori_timesteps : list</text>
<text text-anchor="start" x="3139" y="-1293.3" font-family="Times,serif" font-size="14.00">p2_gamma : NoneType</text>
<text text-anchor="start" x="3139" y="-1278.3" font-family="Times,serif" font-size="14.00">p2_k : NoneType</text>
<text text-anchor="start" x="3139" y="-1263.3" font-family="Times,serif" font-size="14.00">queue_gt</text>
<text text-anchor="start" x="3139" y="-1248.3" font-family="Times,serif" font-size="14.00">queue_lr</text>
<text text-anchor="start" x="3139" y="-1233.3" font-family="Times,serif" font-size="14.00">queue_ptr : int</text>
<text text-anchor="start" x="3139" y="-1218.3" font-family="Times,serif" font-size="14.00">queue_size</text>
<text text-anchor="start" x="3139" y="-1203.3" font-family="Times,serif" font-size="14.00">random_size : bool</text>
<text text-anchor="start" x="3139" y="-1188.3" font-family="Times,serif" font-size="14.00">restarted_from_ckpt : bool</text>
<text text-anchor="start" x="3139" y="-1173.3" font-family="Times,serif" font-size="14.00">scale_by_std : bool</text>
<text text-anchor="start" x="3139" y="-1158.3" font-family="Times,serif" font-size="14.00">scale_factor : float</text>
<text text-anchor="start" x="3139" y="-1143.3" font-family="Times,serif" font-size="14.00">shorten_cond_schedule</text>
<text text-anchor="start" x="3139" y="-1128.3" font-family="Times,serif" font-size="14.00">snr : NoneType</text>
<text text-anchor="start" x="3139" y="-1113.3" font-family="Times,serif" font-size="14.00">structcond_stage_model</text>
<text text-anchor="start" x="3139" y="-1098.3" font-family="Times,serif" font-size="14.00">test_gt : bool</text>
<text text-anchor="start" x="3139" y="-1083.3" font-family="Times,serif" font-size="14.00">time_replace : NoneType</text>
<text text-anchor="start" x="3139" y="-1068.3" font-family="Times,serif" font-size="14.00">unfrozen_diff : bool</text>
<text text-anchor="start" x="3139" y="-1053.3" font-family="Times,serif" font-size="14.00">use_usm : bool</text>
<polyline fill="none" stroke="black" points="3131,-1045.5 5735,-1045.5 "/>
<text text-anchor="start" x="3139" y="-1030.3" font-family="Times,serif" font-size="14.00">apply_model(x_noisy, t, cond, struct_cond, return_ids)</text>
<text text-anchor="start" x="3139" y="-1015.3" font-family="Times,serif" font-size="14.00">configure_optimizers()</text>
<text text-anchor="start" x="3139" y="-1000.3" font-family="Times,serif" font-size="14.00">decode_first_stage(z, predict_cids, force_not_quantize)</text>
<text text-anchor="start" x="3139" y="-985.3" font-family="Times,serif" font-size="14.00">delta_border(h, w)</text>
<text text-anchor="start" x="3139" y="-970.3" font-family="Times,serif" font-size="14.00">differentiable_decode_first_stage(z, predict_cids, force_not_quantize)</text>
<text text-anchor="start" x="3139" y="-955.3" font-family="Times,serif" font-size="14.00">encode_first_stage(x)</text>
<text text-anchor="start" x="3139" y="-940.3" font-family="Times,serif" font-size="14.00">forward(x, c, gt)</text>
<text text-anchor="start" x="3139" y="-925.3" font-family="Times,serif" font-size="14.00">get_first_stage_encoding(encoder_posterior)</text>
<text text-anchor="start" x="3139" y="-910.3" font-family="Times,serif" font-size="14.00">get_fold_unfold(x, kernel_size, stride, uf, df)</text>
<text text-anchor="start" x="3139" y="-895.3" font-family="Times,serif" font-size="14.00">get_input(batch, k, return_first_stage_outputs, force_c_encode, cond_key, return_original_cond, bs, val, text_cond, return_gt, resize_lq)</text>
<text text-anchor="start" x="3139" y="-880.3" font-family="Times,serif" font-size="14.00">get_learned_conditioning(c)</text>
<text text-anchor="start" x="3139" y="-865.3" font-family="Times,serif" font-size="14.00">get_weighting(h, w, Ly, Lx, device)</text>
<text text-anchor="start" x="3139" y="-850.3" font-family="Times,serif" font-size="14.00">instantiate_cond_stage(config)</text>
<text text-anchor="start" x="3139" y="-835.3" font-family="Times,serif" font-size="14.00">instantiate_first_stage(config)</text>
<text text-anchor="start" x="3139" y="-820.3" font-family="Times,serif" font-size="14.00">instantiate_structcond_stage(config)</text>
<text text-anchor="start" x="3139" y="-805.3" font-family="Times,serif" font-size="14.00">log_images(batch, N, n_row, sample, ddim_steps, ddim_eta, return_keys, quantize_denoised, inpaint, plot_denoise_rows, plot_progressive_rows, plot_diffusion_rows)</text>
<text text-anchor="start" x="3139" y="-790.3" font-family="Times,serif" font-size="14.00">make_cond_schedule()</text>
<text text-anchor="start" x="3139" y="-775.3" font-family="Times,serif" font-size="14.00">meshgrid(h, w)</text>
<text text-anchor="start" x="3139" y="-760.3" font-family="Times,serif" font-size="14.00">on_train_batch_start(batch, batch_idx, dataloader_idx)</text>
<text text-anchor="start" x="3139" y="-745.3" font-family="Times,serif" font-size="14.00">p_losses(x_start, cond, struct_cond, t, t_ori, z_gt, noise)</text>
<text text-anchor="start" x="3139" y="-730.3" font-family="Times,serif" font-size="14.00">p_mean_variance(x, c, struct_cond, t, clip_denoised: bool, return_codebook_ids, quantize_denoised, return_x0, score_corrector, corrector_kwargs, t_replace, unconditional_conditioning, unconditional_guidance_scale, reference_sr, reference_lr, reference_step, reference_range)</text>
<text text-anchor="start" x="3139" y="-715.3" font-family="Times,serif" font-size="14.00">p_mean_variance_canvas(x, c, struct_cond, t, clip_denoised: bool, return_codebook_ids, quantize_denoised, return_x0, score_corrector, corrector_kwargs, t_replace, tile_size, tile_overlap, batch_size, tile_weights, unconditional_conditioning, unconditional_guidance_scale, reference_sr, reference_lr, reference_step, reference_range)</text>
<text text-anchor="start" x="3139" y="-700.3" font-family="Times,serif" font-size="14.00">p_sample(x, c, struct_cond, t, clip_denoised, repeat_noise, return_codebook_ids, quantize_denoised, return_x0, temperature, noise_dropout, score_corrector, corrector_kwargs, t_replace, unconditional_conditioning, unconditional_guidance_scale, reference_sr, reference_lr, reference_step, reference_range)</text>
<text text-anchor="start" x="3139" y="-685.3" font-family="Times,serif" font-size="14.00">p_sample_canvas(x, c, struct_cond, t, clip_denoised, repeat_noise, return_codebook_ids, quantize_denoised, return_x0, temperature, noise_dropout, score_corrector, corrector_kwargs, t_replace, tile_size, tile_overlap, batch_size, tile_weights, unconditional_conditioning, unconditional_guidance_scale, reference_sr, reference_lr, reference_step, reference_range)</text>
<text text-anchor="start" x="3139" y="-670.3" font-family="Times,serif" font-size="14.00">p_sample_loop(cond, struct_cond, shape, return_intermediates, x_T, verbose, callback, timesteps, quantize_denoised, mask, x0, img_callback, start_T, log_every_t, time_replace, adain_fea, interfea_path, unconditional_conditioning, unconditional_guidance_scale, reference_sr, reference_lr, reference_step, reference_range)</text>
<text text-anchor="start" x="3139" y="-655.3" font-family="Times,serif" font-size="14.00">p_sample_loop_canvas(cond, struct_cond, shape, return_intermediates, x_T, verbose, callback, timesteps, quantize_denoised, mask, x0, img_callback, start_T, log_every_t, time_replace, adain_fea, interfea_path, tile_size, tile_overlap, batch_size, unconditional_conditioning, unconditional_guidance_scale, reference_sr, reference_lr, reference_step, reference_range)</text>
<text text-anchor="start" x="3139" y="-640.3" font-family="Times,serif" font-size="14.00">progressive_denoising(cond, struct_cond, shape, verbose, callback, quantize_denoised, img_callback, mask, x0, temperature, noise_dropout, score_corrector, corrector_kwargs, batch_size, x_T, start_T, log_every_t)</text>
<text text-anchor="start" x="3139" y="-625.3" font-family="Times,serif" font-size="14.00">randn_cropinput(lq, gt, base_size)</text>
<text text-anchor="start" x="3139" y="-610.3" font-family="Times,serif" font-size="14.00">register_schedule(given_betas, beta_schedule, timesteps, linear_start, linear_end, cosine_s)</text>
<text text-anchor="start" x="3139" y="-595.3" font-family="Times,serif" font-size="14.00">sample(cond, struct_cond, batch_size, return_intermediates, x_T, verbose, timesteps, quantize_denoised, mask, x0, shape, time_replace, adain_fea, interfea_path, start_T, unconditional_conditioning, unconditional_guidance_scale, reference_sr, reference_lr, reference_step, reference_range)</text>
<text text-anchor="start" x="3139" y="-580.3" font-family="Times,serif" font-size="14.00">sample_canvas(cond, struct_cond, batch_size, return_intermediates, x_T, verbose, timesteps, quantize_denoised, mask, x0, shape, time_replace, adain_fea, interfea_path, tile_size, tile_overlap, batch_size_sample, log_every_t, unconditional_conditioning, unconditional_guidance_scale)</text>
<text text-anchor="start" x="3139" y="-565.3" font-family="Times,serif" font-size="14.00">sample_log(cond, struct_cond, batch_size, ddim, ddim_steps)</text>
<text text-anchor="start" x="3139" y="-550.3" font-family="Times,serif" font-size="14.00">shared_step(batch)</text>
<text text-anchor="start" x="3139" y="-535.3" font-family="Times,serif" font-size="14.00">to_rgb(x)</text>
</g>
<!-- diffusion.ddpm.LatentDiffusionSRTextWT&#45;&gt;diffusion.ddpm.DDPM -->
<g id="edge2" class="edge">
<title>diffusion.ddpm.LatentDiffusionSRTextWT&#45;&gt;diffusion.ddpm.DDPM</title>
<path fill="none" stroke="black" d="M3306.53,-1571.51C3099.52,-1667.26 2898.38,-1760.29 2737.69,-1834.61"/>
<polygon fill="none" stroke="black" points="2735.75,-1831.65 2728.14,-1839.03 2738.68,-1838.01 2735.75,-1831.65"/>
</g>
<!-- diffusion.ddpm.LatentDiffusionSRTextWTFFHQ -->
<g id="node9" class="node">
<title>diffusion.ddpm.LatentDiffusionSRTextWTFFHQ</title>
<polygon fill="none" stroke="black" points="3944.5,-203 3944.5,-287 4921.5,-287 4921.5,-203 3944.5,-203"/>
<text text-anchor="middle" x="4433" y="-271.8" font-family="Times,serif" font-size="14.00">LatentDiffusionSRTextWTFFHQ</text>
<polyline fill="none" stroke="black" points="3944.5,-264 4921.5,-264 "/>
<text text-anchor="start" x="3952.5" y="-248.8" font-family="Times,serif" font-size="14.00">gt</text>
<text text-anchor="start" x="3952.5" y="-233.8" font-family="Times,serif" font-size="14.00">lq</text>
<polyline fill="none" stroke="black" points="3944.5,-226 4921.5,-226 "/>
<text text-anchor="start" x="3952.5" y="-210.8" font-family="Times,serif" font-size="14.00">get_input(batch, k, return_first_stage_outputs, force_c_encode, cond_key, return_original_cond, bs, val, text_cond, return_gt, resize_lq)</text>
</g>
<!-- diffusion.ddpm.LatentDiffusionSRTextWTFFHQ&#45;&gt;diffusion.ddpm.LatentDiffusionSRTextWT -->
<g id="edge3" class="edge">
<title>diffusion.ddpm.LatentDiffusionSRTextWTFFHQ&#45;&gt;diffusion.ddpm.LatentDiffusionSRTextWT</title>
<path fill="none" stroke="black" d="M4433,-287.18C4433,-335.19 4433,-420.37 4433,-516.84"/>
<polygon fill="none" stroke="black" points="4429.5,-517.12 4433,-527.12 4436.5,-517.12 4429.5,-517.12"/>
</g>
<!-- diffusion.ddpm.Layout2ImgDiffusion -->
<g id="node10" class="node">
<title>diffusion.ddpm.Layout2ImgDiffusion</title>
<polygon fill="none" stroke="black" points="2308.5,-210 2308.5,-280 2475.5,-280 2475.5,-210 2308.5,-210"/>
<text text-anchor="middle" x="2392" y="-264.8" font-family="Times,serif" font-size="14.00">Layout2ImgDiffusion</text>
<polyline fill="none" stroke="black" points="2308.5,-257 2475.5,-257 "/>
<polyline fill="none" stroke="black" points="2308.5,-233 2475.5,-233 "/>
<text text-anchor="start" x="2316.5" y="-217.8" font-family="Times,serif" font-size="14.00">log_images(batch, N)</text>
</g>
<!-- diffusion.ddpm.Layout2ImgDiffusion&#45;&gt;diffusion.ddpm.LatentDiffusion -->
<g id="edge4" class="edge">
<title>diffusion.ddpm.Layout2ImgDiffusion&#45;&gt;diffusion.ddpm.LatentDiffusion</title>
<path fill="none" stroke="black" d="M2392,-280.23C2392,-352.09 2392,-525.64 2392,-689.64"/>
<polygon fill="none" stroke="black" points="2388.5,-689.93 2392,-699.93 2395.5,-689.93 2388.5,-689.93"/>
</g>
<!-- diffusion.ddpm_inv.Layout2ImgDiffusion -->
<g id="node11" class="node">
<title>diffusion.ddpm_inv.Layout2ImgDiffusion</title>
<polygon fill="none" stroke="black" points="6737.5,-210 6737.5,-280 6904.5,-280 6904.5,-210 6737.5,-210"/>
<text text-anchor="middle" x="6821" y="-264.8" font-family="Times,serif" font-size="14.00">Layout2ImgDiffusion</text>
<polyline fill="none" stroke="black" points="6737.5,-257 6904.5,-257 "/>
<polyline fill="none" stroke="black" points="6737.5,-233 6904.5,-233 "/>
<text text-anchor="start" x="6745.5" y="-217.8" font-family="Times,serif" font-size="14.00">log_images(batch, N)</text>
</g>
<!-- diffusion.ddpm_inv.Layout2ImgDiffusion&#45;&gt;diffusion.ddpm_inv.LatentDiffusion -->
<g id="edge6" class="edge">
<title>diffusion.ddpm_inv.Layout2ImgDiffusion&#45;&gt;diffusion.ddpm_inv.LatentDiffusion</title>
<path fill="none" stroke="black" d="M6821,-280.23C6821,-346.68 6821,-500.07 6821,-652.46"/>
<polygon fill="none" stroke="black" points="6817.5,-652.5 6821,-662.5 6824.5,-652.5 6817.5,-652.5"/>
</g>
<!-- diffusion.classifier.NoisyLatentImageClassifier -->
<g id="node12" class="node">
<title>diffusion.classifier.NoisyLatentImageClassifier</title>
<polygon fill="none" stroke="black" points="6923,-0.5 6923,-489.5 7267,-489.5 7267,-0.5 6923,-0.5"/>
<text text-anchor="middle" x="7095" y="-474.3" font-family="Times,serif" font-size="14.00">NoisyLatentImageClassifier</text>
<polyline fill="none" stroke="black" points="6923,-466.5 7267,-466.5 "/>
<text text-anchor="start" x="6931" y="-451.3" font-family="Times,serif" font-size="14.00">diffusion_config</text>
<text text-anchor="start" x="6931" y="-436.3" font-family="Times,serif" font-size="14.00">diffusion_model</text>
<text text-anchor="start" x="6931" y="-421.3" font-family="Times,serif" font-size="14.00">label_key : NoneType</text>
<text text-anchor="start" x="6931" y="-406.3" font-family="Times,serif" font-size="14.00">log_steps : int</text>
<text text-anchor="start" x="6931" y="-391.3" font-family="Times,serif" font-size="14.00">log_time_interval</text>
<text text-anchor="start" x="6931" y="-376.3" font-family="Times,serif" font-size="14.00">model</text>
<text text-anchor="start" x="6931" y="-361.3" font-family="Times,serif" font-size="14.00">monitor : str</text>
<text text-anchor="start" x="6931" y="-346.3" font-family="Times,serif" font-size="14.00">noisy_acc</text>
<text text-anchor="start" x="6931" y="-331.3" font-family="Times,serif" font-size="14.00">num_classes</text>
<text text-anchor="start" x="6931" y="-316.3" font-family="Times,serif" font-size="14.00">numd</text>
<text text-anchor="start" x="6931" y="-301.3" font-family="Times,serif" font-size="14.00">scheduler_config : NoneType</text>
<text text-anchor="start" x="6931" y="-286.3" font-family="Times,serif" font-size="14.00">use_scheduler</text>
<text text-anchor="start" x="6931" y="-271.3" font-family="Times,serif" font-size="14.00">weight_decay : float</text>
<polyline fill="none" stroke="black" points="6923,-263.5 7267,-263.5 "/>
<text text-anchor="start" x="6931" y="-248.3" font-family="Times,serif" font-size="14.00">compute_top_k(logits, labels, k, reduction)</text>
<text text-anchor="start" x="6931" y="-233.3" font-family="Times,serif" font-size="14.00">configure_optimizers()</text>
<text text-anchor="start" x="6931" y="-218.3" font-family="Times,serif" font-size="14.00">forward(x_noisy, t)</text>
<text text-anchor="start" x="6931" y="-203.3" font-family="Times,serif" font-size="14.00">get_conditioning(batch, k)</text>
<text text-anchor="start" x="6931" y="-188.3" font-family="Times,serif" font-size="14.00">get_input(batch, k)</text>
<text text-anchor="start" x="6931" y="-173.3" font-family="Times,serif" font-size="14.00">get_x_noisy(x, t, noise)</text>
<text text-anchor="start" x="6931" y="-158.3" font-family="Times,serif" font-size="14.00">init_from_ckpt(path, ignore_keys, only_model)</text>
<text text-anchor="start" x="6931" y="-143.3" font-family="Times,serif" font-size="14.00">load_classifier(ckpt_path, pool)</text>
<text text-anchor="start" x="6931" y="-128.3" font-family="Times,serif" font-size="14.00">load_diffusion()</text>
<text text-anchor="start" x="6931" y="-113.3" font-family="Times,serif" font-size="14.00">log_images(batch, N)</text>
<text text-anchor="start" x="6931" y="-98.3" font-family="Times,serif" font-size="14.00">on_train_epoch_start()</text>
<text text-anchor="start" x="6931" y="-83.3" font-family="Times,serif" font-size="14.00">on_validation_start()</text>
<text text-anchor="start" x="6931" y="-68.3" font-family="Times,serif" font-size="14.00">reset_noise_accs()</text>
<text text-anchor="start" x="6931" y="-53.3" font-family="Times,serif" font-size="14.00">shared_step(batch, t)</text>
<text text-anchor="start" x="6931" y="-38.3" font-family="Times,serif" font-size="14.00">training_step(batch, batch_idx)</text>
<text text-anchor="start" x="6931" y="-23.3" font-family="Times,serif" font-size="14.00">validation_step(batch, batch_idx)</text>
<text text-anchor="start" x="6931" y="-8.3" font-family="Times,serif" font-size="14.00">write_logs(loss, logits, targets)</text>
</g>
<!-- diffusion.plms.PLMSSampler -->
<g id="node13" class="node">
<title>diffusion.plms.PLMSSampler</title>
<polygon fill="none" stroke="black" points="7285.5,-158 7285.5,-332 9178.5,-332 9178.5,-158 7285.5,-158"/>
<text text-anchor="middle" x="8232" y="-316.8" font-family="Times,serif" font-size="14.00">PLMSSampler</text>
<polyline fill="none" stroke="black" points="7285.5,-309 9178.5,-309 "/>
<text text-anchor="start" x="7293.5" y="-293.8" font-family="Times,serif" font-size="14.00">ddim_timesteps</text>
<text text-anchor="start" x="7293.5" y="-278.8" font-family="Times,serif" font-size="14.00">ddpm_num_timesteps</text>
<text text-anchor="start" x="7293.5" y="-263.8" font-family="Times,serif" font-size="14.00">model</text>
<text text-anchor="start" x="7293.5" y="-248.8" font-family="Times,serif" font-size="14.00">schedule : str</text>
<polyline fill="none" stroke="black" points="7285.5,-241 9178.5,-241 "/>
<text text-anchor="start" x="7293.5" y="-225.8" font-family="Times,serif" font-size="14.00">make_schedule(ddim_num_steps, ddim_discretize, ddim_eta, verbose)</text>
<text text-anchor="start" x="7293.5" y="-210.8" font-family="Times,serif" font-size="14.00">p_sample_plms(x, c, t, index, repeat_noise, use_original_steps, quantize_denoised, temperature, noise_dropout, score_corrector, corrector_kwargs, unconditional_guidance_scale, unconditional_conditioning, old_eps, t_next)</text>
<text text-anchor="start" x="7293.5" y="-195.8" font-family="Times,serif" font-size="14.00">plms_sampling(cond, shape, x_T, ddim_use_original_steps, callback, timesteps, quantize_denoised, mask, x0, img_callback, log_every_t, temperature, noise_dropout, score_corrector, corrector_kwargs, unconditional_guidance_scale, unconditional_conditioning)</text>
<text text-anchor="start" x="7293.5" y="-180.8" font-family="Times,serif" font-size="14.00">register_buffer(name, attr)</text>
<text text-anchor="start" x="7293.5" y="-165.8" font-family="Times,serif" font-size="14.00">sample(S, batch_size, shape, conditioning, callback, normals_sequence, img_callback, quantize_x0, eta, mask, x0, temperature, noise_dropout, score_corrector, corrector_kwargs, verbose, x_T, log_every_t, unconditional_guidance_scale, unconditional_conditioning)</text>
</g>
</g>
</svg>
