<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.50.0 (0)
 -->
<!-- Title: classes_ldm.modules.attention Pages: 1 -->
<svg width="1404pt" height="409pt"
 viewBox="0.00 0.00 1403.50 409.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 405)">
<title>classes_ldm.modules.attention</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-405 1399.5,-405 1399.5,4 -4,4"/>
<!-- attention.BasicTransformerBlock -->
<g id="node1" class="node">
<title>attention.BasicTransformerBlock</title>
<polygon fill="none" stroke="black" points="70.5,-226.5 70.5,-385.5 253.5,-385.5 253.5,-226.5 70.5,-226.5"/>
<text text-anchor="middle" x="162" y="-370.3" font-family="Times,serif" font-size="14.00">BasicTransformerBlock</text>
<polyline fill="none" stroke="black" points="70.5,-362.5 253.5,-362.5 "/>
<text text-anchor="start" x="78.5" y="-347.3" font-family="Times,serif" font-size="14.00">attn1</text>
<text text-anchor="start" x="78.5" y="-332.3" font-family="Times,serif" font-size="14.00">attn2</text>
<text text-anchor="start" x="78.5" y="-317.3" font-family="Times,serif" font-size="14.00">checkpoint : bool</text>
<text text-anchor="start" x="78.5" y="-302.3" font-family="Times,serif" font-size="14.00">ff</text>
<text text-anchor="start" x="78.5" y="-287.3" font-family="Times,serif" font-size="14.00">norm1</text>
<text text-anchor="start" x="78.5" y="-272.3" font-family="Times,serif" font-size="14.00">norm2</text>
<text text-anchor="start" x="78.5" y="-257.3" font-family="Times,serif" font-size="14.00">norm3</text>
<polyline fill="none" stroke="black" points="70.5,-249.5 253.5,-249.5 "/>
<text text-anchor="start" x="78.5" y="-234.3" font-family="Times,serif" font-size="14.00">forward(x, context)</text>
</g>
<!-- attention.BasicTransformerBlockV2 -->
<g id="node2" class="node">
<title>attention.BasicTransformerBlockV2</title>
<polygon fill="none" stroke="black" points="302.5,-211.5 302.5,-400.5 511.5,-400.5 511.5,-211.5 302.5,-211.5"/>
<text text-anchor="middle" x="407" y="-385.3" font-family="Times,serif" font-size="14.00">BasicTransformerBlockV2</text>
<polyline fill="none" stroke="black" points="302.5,-377.5 511.5,-377.5 "/>
<text text-anchor="start" x="310.5" y="-362.3" font-family="Times,serif" font-size="14.00">ATTENTION_MODES : dict</text>
<text text-anchor="start" x="310.5" y="-347.3" font-family="Times,serif" font-size="14.00">attn1</text>
<text text-anchor="start" x="310.5" y="-332.3" font-family="Times,serif" font-size="14.00">attn2</text>
<text text-anchor="start" x="310.5" y="-317.3" font-family="Times,serif" font-size="14.00">checkpoint : bool</text>
<text text-anchor="start" x="310.5" y="-302.3" font-family="Times,serif" font-size="14.00">disable_self_attn : bool</text>
<text text-anchor="start" x="310.5" y="-287.3" font-family="Times,serif" font-size="14.00">ff</text>
<text text-anchor="start" x="310.5" y="-272.3" font-family="Times,serif" font-size="14.00">norm1</text>
<text text-anchor="start" x="310.5" y="-257.3" font-family="Times,serif" font-size="14.00">norm2</text>
<text text-anchor="start" x="310.5" y="-242.3" font-family="Times,serif" font-size="14.00">norm3</text>
<polyline fill="none" stroke="black" points="302.5,-234.5 511.5,-234.5 "/>
<text text-anchor="start" x="310.5" y="-219.3" font-family="Times,serif" font-size="14.00">forward(x, context)</text>
</g>
<!-- attention.CrossAttention -->
<g id="node3" class="node">
<title>attention.CrossAttention</title>
<polygon fill="none" stroke="black" points="0,-8 0,-152 200,-152 200,-8 0,-8"/>
<text text-anchor="middle" x="100" y="-136.8" font-family="Times,serif" font-size="14.00">CrossAttention</text>
<polyline fill="none" stroke="black" points="0,-129 200,-129 "/>
<text text-anchor="start" x="8" y="-113.8" font-family="Times,serif" font-size="14.00">heads : int</text>
<text text-anchor="start" x="8" y="-98.8" font-family="Times,serif" font-size="14.00">scale : float</text>
<text text-anchor="start" x="8" y="-83.8" font-family="Times,serif" font-size="14.00">to_k</text>
<text text-anchor="start" x="8" y="-68.8" font-family="Times,serif" font-size="14.00">to_out</text>
<text text-anchor="start" x="8" y="-53.8" font-family="Times,serif" font-size="14.00">to_q</text>
<text text-anchor="start" x="8" y="-38.8" font-family="Times,serif" font-size="14.00">to_v</text>
<polyline fill="none" stroke="black" points="0,-31 200,-31 "/>
<text text-anchor="start" x="8" y="-15.8" font-family="Times,serif" font-size="14.00">forward(x, context, mask)</text>
</g>
<!-- attention.CrossAttention&#45;&gt;attention.BasicTransformerBlock -->
<g id="edge1" class="edge">
<title>attention.CrossAttention&#45;&gt;attention.BasicTransformerBlock</title>
<path fill="none" stroke="black" d="M95.43,-152.19C96.01,-165.89 97.63,-180.01 101,-193 102.9,-200.31 105.37,-207.67 108.24,-214.92"/>
<polygon fill="black" stroke="black" points="108.34,-215.17 114.37,-219.13 113.04,-226.22 107.01,-222.26 108.34,-215.17"/>
<text text-anchor="middle" x="120.5" y="-181.8" font-family="Times,serif" font-size="14.00" fill="green">attn1</text>
</g>
<!-- attention.CrossAttention&#45;&gt;attention.BasicTransformerBlock -->
<g id="edge2" class="edge">
<title>attention.CrossAttention&#45;&gt;attention.BasicTransformerBlock</title>
<path fill="none" stroke="black" d="M131.4,-152.15C134.59,-160.76 137.55,-169.51 140,-178 143.39,-189.73 146.33,-202.23 148.87,-214.64"/>
<polygon fill="black" stroke="black" points="148.88,-214.7 153.95,-219.82 151.17,-226.47 146.1,-221.35 148.88,-214.7"/>
<text text-anchor="middle" x="163.5" y="-181.8" font-family="Times,serif" font-size="14.00" fill="green">attn2</text>
</g>
<!-- attention.FeedForward -->
<g id="node4" class="node">
<title>attention.FeedForward</title>
<polygon fill="none" stroke="black" points="218.5,-45.5 218.5,-114.5 329.5,-114.5 329.5,-45.5 218.5,-45.5"/>
<text text-anchor="middle" x="274" y="-99.3" font-family="Times,serif" font-size="14.00">FeedForward</text>
<polyline fill="none" stroke="black" points="218.5,-91.5 329.5,-91.5 "/>
<text text-anchor="start" x="226.5" y="-76.3" font-family="Times,serif" font-size="14.00">net</text>
<polyline fill="none" stroke="black" points="218.5,-68.5 329.5,-68.5 "/>
<text text-anchor="start" x="226.5" y="-53.3" font-family="Times,serif" font-size="14.00">forward(x)</text>
</g>
<!-- attention.FeedForward&#45;&gt;attention.BasicTransformerBlock -->
<g id="edge3" class="edge">
<title>attention.FeedForward&#45;&gt;attention.BasicTransformerBlock</title>
<path fill="none" stroke="black" d="M257.23,-114.54C243.9,-141.19 224.62,-179.76 206.88,-215.24"/>
<polygon fill="black" stroke="black" points="206.8,-215.39 207.7,-222.55 201.44,-226.13 200.54,-218.97 206.8,-215.39"/>
<text text-anchor="middle" x="230" y="-181.8" font-family="Times,serif" font-size="14.00" fill="green">ff</text>
</g>
<!-- attention.FeedForward&#45;&gt;attention.BasicTransformerBlockV2 -->
<g id="edge4" class="edge">
<title>attention.FeedForward&#45;&gt;attention.BasicTransformerBlockV2</title>
<path fill="none" stroke="black" d="M293.91,-114.54C307.58,-137.56 326.54,-169.48 345.02,-200.61"/>
<polygon fill="black" stroke="black" points="345.14,-200.81 351.64,-203.93 351.26,-211.13 344.76,-208.01 345.14,-200.81"/>
<text text-anchor="middle" x="346" y="-181.8" font-family="Times,serif" font-size="14.00" fill="green">ff</text>
</g>
<!-- attention.GEGLU -->
<g id="node5" class="node">
<title>attention.GEGLU</title>
<polygon fill="none" stroke="black" points="609,-45.5 609,-114.5 701,-114.5 701,-45.5 609,-45.5"/>
<text text-anchor="middle" x="655" y="-99.3" font-family="Times,serif" font-size="14.00">GEGLU</text>
<polyline fill="none" stroke="black" points="609,-91.5 701,-91.5 "/>
<text text-anchor="start" x="617" y="-76.3" font-family="Times,serif" font-size="14.00">proj</text>
<polyline fill="none" stroke="black" points="609,-68.5 701,-68.5 "/>
<text text-anchor="start" x="617" y="-53.3" font-family="Times,serif" font-size="14.00">forward(x)</text>
</g>
<!-- attention.LinearAttention -->
<g id="node6" class="node">
<title>attention.LinearAttention</title>
<polygon fill="none" stroke="black" points="719.5,-30.5 719.5,-129.5 848.5,-129.5 848.5,-30.5 719.5,-30.5"/>
<text text-anchor="middle" x="784" y="-114.3" font-family="Times,serif" font-size="14.00">LinearAttention</text>
<polyline fill="none" stroke="black" points="719.5,-106.5 848.5,-106.5 "/>
<text text-anchor="start" x="727.5" y="-91.3" font-family="Times,serif" font-size="14.00">heads : int</text>
<text text-anchor="start" x="727.5" y="-76.3" font-family="Times,serif" font-size="14.00">to_out</text>
<text text-anchor="start" x="727.5" y="-61.3" font-family="Times,serif" font-size="14.00">to_qkv</text>
<polyline fill="none" stroke="black" points="719.5,-53.5 848.5,-53.5 "/>
<text text-anchor="start" x="727.5" y="-38.3" font-family="Times,serif" font-size="14.00">forward(x)</text>
</g>
<!-- attention.MemoryEfficientCrossAttention -->
<g id="node7" class="node">
<title>attention.MemoryEfficientCrossAttention</title>
<polygon fill="none" stroke="black" points="347.5,-0.5 347.5,-159.5 590.5,-159.5 590.5,-0.5 347.5,-0.5"/>
<text text-anchor="middle" x="469" y="-144.3" font-family="Times,serif" font-size="14.00">MemoryEfficientCrossAttention</text>
<polyline fill="none" stroke="black" points="347.5,-136.5 590.5,-136.5 "/>
<text text-anchor="start" x="355.5" y="-121.3" font-family="Times,serif" font-size="14.00">attention_op : Optional[Any]</text>
<text text-anchor="start" x="355.5" y="-106.3" font-family="Times,serif" font-size="14.00">dim_head : int</text>
<text text-anchor="start" x="355.5" y="-91.3" font-family="Times,serif" font-size="14.00">heads : int</text>
<text text-anchor="start" x="355.5" y="-76.3" font-family="Times,serif" font-size="14.00">to_k</text>
<text text-anchor="start" x="355.5" y="-61.3" font-family="Times,serif" font-size="14.00">to_out</text>
<text text-anchor="start" x="355.5" y="-46.3" font-family="Times,serif" font-size="14.00">to_q</text>
<text text-anchor="start" x="355.5" y="-31.3" font-family="Times,serif" font-size="14.00">to_v</text>
<polyline fill="none" stroke="black" points="347.5,-23.5 590.5,-23.5 "/>
<text text-anchor="start" x="355.5" y="-8.3" font-family="Times,serif" font-size="14.00">forward(x, context, mask)</text>
</g>
<!-- attention.MemoryEfficientCrossAttention&#45;&gt;attention.BasicTransformerBlockV2 -->
<g id="edge5" class="edge">
<title>attention.MemoryEfficientCrossAttention&#45;&gt;attention.BasicTransformerBlockV2</title>
<path fill="none" stroke="black" d="M414.85,-159.52C412.15,-165.6 409.82,-171.79 408,-178 406.02,-184.78 404.51,-191.85 403.4,-199.03"/>
<polygon fill="black" stroke="black" points="403.37,-199.29 406.6,-205.74 401.89,-211.2 398.66,-204.75 403.37,-199.29"/>
<text text-anchor="middle" x="427.5" y="-181.8" font-family="Times,serif" font-size="14.00" fill="green">attn1</text>
</g>
<!-- attention.MemoryEfficientCrossAttention&#45;&gt;attention.BasicTransformerBlockV2 -->
<g id="edge6" class="edge">
<title>attention.MemoryEfficientCrossAttention&#45;&gt;attention.BasicTransformerBlockV2</title>
<path fill="none" stroke="black" d="M455.09,-159.68C452.65,-170.92 449.94,-182.3 447,-193 446.41,-195.15 445.8,-197.31 445.17,-199.49"/>
<polygon fill="black" stroke="black" points="445.1,-199.73 447.2,-206.62 441.64,-211.22 439.54,-204.32 445.1,-199.73"/>
<text text-anchor="middle" x="469.5" y="-181.8" font-family="Times,serif" font-size="14.00" fill="green">attn2</text>
</g>
<!-- attention.SpatialSelfAttention -->
<g id="node8" class="node">
<title>attention.SpatialSelfAttention</title>
<polygon fill="none" stroke="black" points="866.5,-8 866.5,-152 1027.5,-152 1027.5,-8 866.5,-8"/>
<text text-anchor="middle" x="947" y="-136.8" font-family="Times,serif" font-size="14.00">SpatialSelfAttention</text>
<polyline fill="none" stroke="black" points="866.5,-129 1027.5,-129 "/>
<text text-anchor="start" x="874.5" y="-113.8" font-family="Times,serif" font-size="14.00">in_channels</text>
<text text-anchor="start" x="874.5" y="-98.8" font-family="Times,serif" font-size="14.00">k</text>
<text text-anchor="start" x="874.5" y="-83.8" font-family="Times,serif" font-size="14.00">norm</text>
<text text-anchor="start" x="874.5" y="-68.8" font-family="Times,serif" font-size="14.00">proj_out</text>
<text text-anchor="start" x="874.5" y="-53.8" font-family="Times,serif" font-size="14.00">q</text>
<text text-anchor="start" x="874.5" y="-38.8" font-family="Times,serif" font-size="14.00">v</text>
<polyline fill="none" stroke="black" points="866.5,-31 1027.5,-31 "/>
<text text-anchor="start" x="874.5" y="-15.8" font-family="Times,serif" font-size="14.00">forward(x)</text>
</g>
<!-- attention.SpatialTransformer -->
<g id="node9" class="node">
<title>attention.SpatialTransformer</title>
<polygon fill="none" stroke="black" points="1046,-15.5 1046,-144.5 1202,-144.5 1202,-15.5 1046,-15.5"/>
<text text-anchor="middle" x="1124" y="-129.3" font-family="Times,serif" font-size="14.00">SpatialTransformer</text>
<polyline fill="none" stroke="black" points="1046,-121.5 1202,-121.5 "/>
<text text-anchor="start" x="1054" y="-106.3" font-family="Times,serif" font-size="14.00">in_channels</text>
<text text-anchor="start" x="1054" y="-91.3" font-family="Times,serif" font-size="14.00">norm</text>
<text text-anchor="start" x="1054" y="-76.3" font-family="Times,serif" font-size="14.00">proj_in</text>
<text text-anchor="start" x="1054" y="-61.3" font-family="Times,serif" font-size="14.00">proj_out</text>
<text text-anchor="start" x="1054" y="-46.3" font-family="Times,serif" font-size="14.00">transformer_blocks</text>
<polyline fill="none" stroke="black" points="1046,-38.5 1202,-38.5 "/>
<text text-anchor="start" x="1054" y="-23.3" font-family="Times,serif" font-size="14.00">forward(x, context)</text>
</g>
<!-- attention.SpatialTransformerV2 -->
<g id="node10" class="node">
<title>attention.SpatialTransformerV2</title>
<polygon fill="none" stroke="black" points="1220.5,-8 1220.5,-152 1395.5,-152 1395.5,-8 1220.5,-8"/>
<text text-anchor="middle" x="1308" y="-136.8" font-family="Times,serif" font-size="14.00">SpatialTransformerV2</text>
<polyline fill="none" stroke="black" points="1220.5,-129 1395.5,-129 "/>
<text text-anchor="start" x="1228.5" y="-113.8" font-family="Times,serif" font-size="14.00">in_channels</text>
<text text-anchor="start" x="1228.5" y="-98.8" font-family="Times,serif" font-size="14.00">norm</text>
<text text-anchor="start" x="1228.5" y="-83.8" font-family="Times,serif" font-size="14.00">proj_in</text>
<text text-anchor="start" x="1228.5" y="-68.8" font-family="Times,serif" font-size="14.00">proj_out</text>
<text text-anchor="start" x="1228.5" y="-53.8" font-family="Times,serif" font-size="14.00">transformer_blocks</text>
<text text-anchor="start" x="1228.5" y="-38.8" font-family="Times,serif" font-size="14.00">use_linear : bool</text>
<polyline fill="none" stroke="black" points="1220.5,-31 1395.5,-31 "/>
<text text-anchor="start" x="1228.5" y="-15.8" font-family="Times,serif" font-size="14.00">forward(x, context)</text>
</g>
</g>
</svg>
