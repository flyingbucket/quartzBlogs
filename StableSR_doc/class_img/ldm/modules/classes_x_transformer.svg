<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.50.0 (0)
 -->
<!-- Title: classes_ldm.modules.x_transformer Pages: 1 -->
<svg width="2371pt" height="634pt"
 viewBox="0.00 0.00 2371.00 634.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 630)">
<title>classes_ldm.modules.x_transformer</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-630 2367,-630 2367,4 -4,4"/>
<!-- x_transformer.AbsolutePositionalEmbedding -->
<g id="node1" class="node">
<title>x_transformer.AbsolutePositionalEmbedding</title>
<polygon fill="none" stroke="black" points="151.5,-120.5 151.5,-204.5 381.5,-204.5 381.5,-120.5 151.5,-120.5"/>
<text text-anchor="middle" x="266.5" y="-189.3" font-family="Times,serif" font-size="14.00">AbsolutePositionalEmbedding</text>
<polyline fill="none" stroke="black" points="151.5,-181.5 381.5,-181.5 "/>
<text text-anchor="start" x="159.5" y="-166.3" font-family="Times,serif" font-size="14.00">emb</text>
<polyline fill="none" stroke="black" points="151.5,-158.5 381.5,-158.5 "/>
<text text-anchor="start" x="159.5" y="-143.3" font-family="Times,serif" font-size="14.00">forward(x)</text>
<text text-anchor="start" x="159.5" y="-128.3" font-family="Times,serif" font-size="14.00">init_()</text>
</g>
<!-- x_transformer.TransformerWrapper -->
<g id="node14" class="node">
<title>x_transformer.TransformerWrapper</title>
<polygon fill="none" stroke="black" points="0,-376.5 0,-625.5 533,-625.5 533,-376.5 0,-376.5"/>
<text text-anchor="middle" x="266.5" y="-610.3" font-family="Times,serif" font-size="14.00">TransformerWrapper</text>
<polyline fill="none" stroke="black" points="0,-602.5 533,-602.5 "/>
<text text-anchor="start" x="8" y="-587.3" font-family="Times,serif" font-size="14.00">attn_layers</text>
<text text-anchor="start" x="8" y="-572.3" font-family="Times,serif" font-size="14.00">emb_dropout</text>
<text text-anchor="start" x="8" y="-557.3" font-family="Times,serif" font-size="14.00">max_mem_len : float</text>
<text text-anchor="start" x="8" y="-542.3" font-family="Times,serif" font-size="14.00">max_seq_len</text>
<text text-anchor="start" x="8" y="-527.3" font-family="Times,serif" font-size="14.00">memory_tokens</text>
<text text-anchor="start" x="8" y="-512.3" font-family="Times,serif" font-size="14.00">norm</text>
<text text-anchor="start" x="8" y="-497.3" font-family="Times,serif" font-size="14.00">num_memory_tokens : NoneType</text>
<text text-anchor="start" x="8" y="-482.3" font-family="Times,serif" font-size="14.00">num_tokens</text>
<text text-anchor="start" x="8" y="-467.3" font-family="Times,serif" font-size="14.00">pos_emb</text>
<text text-anchor="start" x="8" y="-452.3" font-family="Times,serif" font-size="14.00">project_emb</text>
<text text-anchor="start" x="8" y="-437.3" font-family="Times,serif" font-size="14.00">to_logits</text>
<text text-anchor="start" x="8" y="-422.3" font-family="Times,serif" font-size="14.00">token_emb</text>
<polyline fill="none" stroke="black" points="0,-414.5 533,-414.5 "/>
<text text-anchor="start" x="8" y="-399.3" font-family="Times,serif" font-size="14.00">forward(x, return_embeddings, mask, return_mems, return_attn, mems)</text>
<text text-anchor="start" x="8" y="-384.3" font-family="Times,serif" font-size="14.00">init_()</text>
</g>
<!-- x_transformer.AbsolutePositionalEmbedding&#45;&gt;x_transformer.TransformerWrapper -->
<g id="edge2" class="edge">
<title>x_transformer.AbsolutePositionalEmbedding&#45;&gt;x_transformer.TransformerWrapper</title>
<path fill="none" stroke="black" d="M266.5,-204.76C266.5,-244.58 266.5,-307.07 266.5,-364.33"/>
<polygon fill="black" stroke="black" points="266.5,-364.46 270.5,-370.46 266.5,-376.46 262.5,-370.46 266.5,-364.46"/>
<text text-anchor="middle" x="298" y="-346.8" font-family="Times,serif" font-size="14.00" fill="green">pos_emb</text>
</g>
<!-- x_transformer.Attention -->
<g id="node2" class="node">
<title>x_transformer.Attention</title>
<polygon fill="none" stroke="black" points="400,-0.5 400,-324.5 1007,-324.5 1007,-0.5 400,-0.5"/>
<text text-anchor="middle" x="703.5" y="-309.3" font-family="Times,serif" font-size="14.00">Attention</text>
<polyline fill="none" stroke="black" points="400,-301.5 1007,-301.5 "/>
<text text-anchor="start" x="408" y="-286.3" font-family="Times,serif" font-size="14.00">attn_fn</text>
<text text-anchor="start" x="408" y="-271.3" font-family="Times,serif" font-size="14.00">attn_on_attn : bool</text>
<text text-anchor="start" x="408" y="-256.3" font-family="Times,serif" font-size="14.00">causal : bool</text>
<text text-anchor="start" x="408" y="-241.3" font-family="Times,serif" font-size="14.00">dropout</text>
<text text-anchor="start" x="408" y="-226.3" font-family="Times,serif" font-size="14.00">heads : int</text>
<text text-anchor="start" x="408" y="-211.3" font-family="Times,serif" font-size="14.00">mask : NoneType</text>
<text text-anchor="start" x="408" y="-196.3" font-family="Times,serif" font-size="14.00">mem_k</text>
<text text-anchor="start" x="408" y="-181.3" font-family="Times,serif" font-size="14.00">mem_v</text>
<text text-anchor="start" x="408" y="-166.3" font-family="Times,serif" font-size="14.00">num_mem_kv : int</text>
<text text-anchor="start" x="408" y="-151.3" font-family="Times,serif" font-size="14.00">post_softmax_proj</text>
<text text-anchor="start" x="408" y="-136.3" font-family="Times,serif" font-size="14.00">pre_softmax_proj</text>
<text text-anchor="start" x="408" y="-121.3" font-family="Times,serif" font-size="14.00">scale : float</text>
<text text-anchor="start" x="408" y="-106.3" font-family="Times,serif" font-size="14.00">sparse_topk : NoneType</text>
<text text-anchor="start" x="408" y="-91.3" font-family="Times,serif" font-size="14.00">talking_heads : bool</text>
<text text-anchor="start" x="408" y="-76.3" font-family="Times,serif" font-size="14.00">to_k</text>
<text text-anchor="start" x="408" y="-61.3" font-family="Times,serif" font-size="14.00">to_out</text>
<text text-anchor="start" x="408" y="-46.3" font-family="Times,serif" font-size="14.00">to_q</text>
<text text-anchor="start" x="408" y="-31.3" font-family="Times,serif" font-size="14.00">to_v</text>
<polyline fill="none" stroke="black" points="400,-23.5 1007,-23.5 "/>
<text text-anchor="start" x="408" y="-8.3" font-family="Times,serif" font-size="14.00">forward(x, context, mask, context_mask, rel_pos, sinusoidal_emb, prev_attn, mem)</text>
</g>
<!-- x_transformer.AttentionLayers -->
<g id="node3" class="node">
<title>x_transformer.AttentionLayers</title>
<polygon fill="none" stroke="black" points="825.5,-384 825.5,-618 1301.5,-618 1301.5,-384 825.5,-384"/>
<text text-anchor="middle" x="1063.5" y="-602.8" font-family="Times,serif" font-size="14.00">AttentionLayers</text>
<polyline fill="none" stroke="black" points="825.5,-595 1301.5,-595 "/>
<text text-anchor="start" x="833.5" y="-579.8" font-family="Times,serif" font-size="14.00">cross_residual_attn : bool</text>
<text text-anchor="start" x="833.5" y="-564.8" font-family="Times,serif" font-size="14.00">depth</text>
<text text-anchor="start" x="833.5" y="-549.8" font-family="Times,serif" font-size="14.00">dim</text>
<text text-anchor="start" x="833.5" y="-534.8" font-family="Times,serif" font-size="14.00">has_pos_emb : bool</text>
<text text-anchor="start" x="833.5" y="-519.8" font-family="Times,serif" font-size="14.00">layer_types : NoneType</text>
<text text-anchor="start" x="833.5" y="-504.8" font-family="Times,serif" font-size="14.00">layers</text>
<text text-anchor="start" x="833.5" y="-489.8" font-family="Times,serif" font-size="14.00">num_attn_layers</text>
<text text-anchor="start" x="833.5" y="-474.8" font-family="Times,serif" font-size="14.00">pia_pos_emb : NoneType</text>
<text text-anchor="start" x="833.5" y="-459.8" font-family="Times,serif" font-size="14.00">pre_norm : bool</text>
<text text-anchor="start" x="833.5" y="-444.8" font-family="Times,serif" font-size="14.00">rel_pos : NoneType</text>
<text text-anchor="start" x="833.5" y="-429.8" font-family="Times,serif" font-size="14.00">residual_attn : bool</text>
<text text-anchor="start" x="833.5" y="-414.8" font-family="Times,serif" font-size="14.00">rotary_pos_emb</text>
<polyline fill="none" stroke="black" points="825.5,-407 1301.5,-407 "/>
<text text-anchor="start" x="833.5" y="-391.8" font-family="Times,serif" font-size="14.00">forward(x, context, mask, context_mask, mems, return_hiddens)</text>
</g>
<!-- x_transformer.Encoder -->
<g id="node4" class="node">
<title>x_transformer.Encoder</title>
<polygon fill="none" stroke="black" points="1025.5,-127.5 1025.5,-197.5 1101.5,-197.5 1101.5,-127.5 1025.5,-127.5"/>
<text text-anchor="middle" x="1063.5" y="-182.3" font-family="Times,serif" font-size="14.00">Encoder</text>
<polyline fill="none" stroke="black" points="1025.5,-174.5 1101.5,-174.5 "/>
<polyline fill="none" stroke="black" points="1025.5,-150.5 1101.5,-150.5 "/>
<text text-anchor="middle" x="1063.5" y="-135.3" font-family="Times,serif" font-size="14.00"> </text>
</g>
<!-- x_transformer.Encoder&#45;&gt;x_transformer.AttentionLayers -->
<g id="edge1" class="edge">
<title>x_transformer.Encoder&#45;&gt;x_transformer.AttentionLayers</title>
<path fill="none" stroke="black" d="M1063.5,-197.62C1063.5,-238.85 1063.5,-310.59 1063.5,-373.85"/>
<polygon fill="none" stroke="black" points="1060,-373.92 1063.5,-383.92 1067,-373.92 1060,-373.92"/>
</g>
<!-- x_transformer.FeedForward -->
<g id="node5" class="node">
<title>x_transformer.FeedForward</title>
<polygon fill="none" stroke="black" points="1120,-128 1120,-197 1231,-197 1231,-128 1120,-128"/>
<text text-anchor="middle" x="1175.5" y="-181.8" font-family="Times,serif" font-size="14.00">FeedForward</text>
<polyline fill="none" stroke="black" points="1120,-174 1231,-174 "/>
<text text-anchor="start" x="1128" y="-158.8" font-family="Times,serif" font-size="14.00">net</text>
<polyline fill="none" stroke="black" points="1120,-151 1231,-151 "/>
<text text-anchor="start" x="1128" y="-135.8" font-family="Times,serif" font-size="14.00">forward(x)</text>
</g>
<!-- x_transformer.FixedPositionalEmbedding -->
<g id="node6" class="node">
<title>x_transformer.FixedPositionalEmbedding</title>
<polygon fill="none" stroke="black" points="1249.5,-127.5 1249.5,-197.5 1457.5,-197.5 1457.5,-127.5 1249.5,-127.5"/>
<text text-anchor="middle" x="1353.5" y="-182.3" font-family="Times,serif" font-size="14.00">FixedPositionalEmbedding</text>
<polyline fill="none" stroke="black" points="1249.5,-174.5 1457.5,-174.5 "/>
<polyline fill="none" stroke="black" points="1249.5,-150.5 1457.5,-150.5 "/>
<text text-anchor="start" x="1257.5" y="-135.3" font-family="Times,serif" font-size="14.00">forward(x, seq_dim, offset)</text>
</g>
<!-- x_transformer.GEGLU -->
<g id="node7" class="node">
<title>x_transformer.GEGLU</title>
<polygon fill="none" stroke="black" points="1475.5,-128 1475.5,-197 1567.5,-197 1567.5,-128 1475.5,-128"/>
<text text-anchor="middle" x="1521.5" y="-181.8" font-family="Times,serif" font-size="14.00">GEGLU</text>
<polyline fill="none" stroke="black" points="1475.5,-174 1567.5,-174 "/>
<text text-anchor="start" x="1483.5" y="-158.8" font-family="Times,serif" font-size="14.00">proj</text>
<polyline fill="none" stroke="black" points="1475.5,-151 1567.5,-151 "/>
<text text-anchor="start" x="1483.5" y="-135.8" font-family="Times,serif" font-size="14.00">forward(x)</text>
</g>
<!-- x_transformer.GRUGating -->
<g id="node8" class="node">
<title>x_transformer.GRUGating</title>
<polygon fill="none" stroke="black" points="1585.5,-128 1585.5,-197 1743.5,-197 1743.5,-128 1585.5,-128"/>
<text text-anchor="middle" x="1664.5" y="-181.8" font-family="Times,serif" font-size="14.00">GRUGating</text>
<polyline fill="none" stroke="black" points="1585.5,-174 1743.5,-174 "/>
<text text-anchor="start" x="1593.5" y="-158.8" font-family="Times,serif" font-size="14.00">gru</text>
<polyline fill="none" stroke="black" points="1585.5,-151 1743.5,-151 "/>
<text text-anchor="start" x="1593.5" y="-135.8" font-family="Times,serif" font-size="14.00">forward(x, residual)</text>
</g>
<!-- x_transformer.RMSNorm -->
<g id="node9" class="node">
<title>x_transformer.RMSNorm</title>
<polygon fill="none" stroke="black" points="1761.5,-113 1761.5,-212 1853.5,-212 1853.5,-113 1761.5,-113"/>
<text text-anchor="middle" x="1807.5" y="-196.8" font-family="Times,serif" font-size="14.00">RMSNorm</text>
<polyline fill="none" stroke="black" points="1761.5,-189 1853.5,-189 "/>
<text text-anchor="start" x="1769.5" y="-173.8" font-family="Times,serif" font-size="14.00">eps : float</text>
<text text-anchor="start" x="1769.5" y="-158.8" font-family="Times,serif" font-size="14.00">g</text>
<text text-anchor="start" x="1769.5" y="-143.8" font-family="Times,serif" font-size="14.00">scale</text>
<polyline fill="none" stroke="black" points="1761.5,-136 1853.5,-136 "/>
<text text-anchor="start" x="1769.5" y="-120.8" font-family="Times,serif" font-size="14.00">forward(x)</text>
</g>
<!-- x_transformer.Residual -->
<g id="node10" class="node">
<title>x_transformer.Residual</title>
<polygon fill="none" stroke="black" points="1871.5,-127.5 1871.5,-197.5 2029.5,-197.5 2029.5,-127.5 1871.5,-127.5"/>
<text text-anchor="middle" x="1950.5" y="-182.3" font-family="Times,serif" font-size="14.00">Residual</text>
<polyline fill="none" stroke="black" points="1871.5,-174.5 2029.5,-174.5 "/>
<polyline fill="none" stroke="black" points="1871.5,-150.5 2029.5,-150.5 "/>
<text text-anchor="start" x="1879.5" y="-135.3" font-family="Times,serif" font-size="14.00">forward(x, residual)</text>
</g>
<!-- x_transformer.Rezero -->
<g id="node11" class="node">
<title>x_transformer.Rezero</title>
<polygon fill="none" stroke="black" points="2047.5,-120.5 2047.5,-204.5 2139.5,-204.5 2139.5,-120.5 2047.5,-120.5"/>
<text text-anchor="middle" x="2093.5" y="-189.3" font-family="Times,serif" font-size="14.00">Rezero</text>
<polyline fill="none" stroke="black" points="2047.5,-181.5 2139.5,-181.5 "/>
<text text-anchor="start" x="2055.5" y="-166.3" font-family="Times,serif" font-size="14.00">fn</text>
<text text-anchor="start" x="2055.5" y="-151.3" font-family="Times,serif" font-size="14.00">g</text>
<polyline fill="none" stroke="black" points="2047.5,-143.5 2139.5,-143.5 "/>
<text text-anchor="start" x="2055.5" y="-128.3" font-family="Times,serif" font-size="14.00">forward(x)</text>
</g>
<!-- x_transformer.Scale -->
<g id="node12" class="node">
<title>x_transformer.Scale</title>
<polygon fill="none" stroke="black" points="2157.5,-120.5 2157.5,-204.5 2249.5,-204.5 2249.5,-120.5 2157.5,-120.5"/>
<text text-anchor="middle" x="2203.5" y="-189.3" font-family="Times,serif" font-size="14.00">Scale</text>
<polyline fill="none" stroke="black" points="2157.5,-181.5 2249.5,-181.5 "/>
<text text-anchor="start" x="2165.5" y="-166.3" font-family="Times,serif" font-size="14.00">fn</text>
<text text-anchor="start" x="2165.5" y="-151.3" font-family="Times,serif" font-size="14.00">value</text>
<polyline fill="none" stroke="black" points="2157.5,-143.5 2249.5,-143.5 "/>
<text text-anchor="start" x="2165.5" y="-128.3" font-family="Times,serif" font-size="14.00">forward(x)</text>
</g>
<!-- x_transformer.ScaleNorm -->
<g id="node13" class="node">
<title>x_transformer.ScaleNorm</title>
<polygon fill="none" stroke="black" points="2268,-113 2268,-212 2363,-212 2363,-113 2268,-113"/>
<text text-anchor="middle" x="2315.5" y="-196.8" font-family="Times,serif" font-size="14.00">ScaleNorm</text>
<polyline fill="none" stroke="black" points="2268,-189 2363,-189 "/>
<text text-anchor="start" x="2276" y="-173.8" font-family="Times,serif" font-size="14.00">eps : float</text>
<text text-anchor="start" x="2276" y="-158.8" font-family="Times,serif" font-size="14.00">g</text>
<text text-anchor="start" x="2276" y="-143.8" font-family="Times,serif" font-size="14.00">scale</text>
<polyline fill="none" stroke="black" points="2268,-136 2363,-136 "/>
<text text-anchor="start" x="2276" y="-120.8" font-family="Times,serif" font-size="14.00">forward(x)</text>
</g>
</g>
</svg>
