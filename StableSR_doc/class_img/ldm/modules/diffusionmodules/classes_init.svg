<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.50.0 (0)
 -->
<!-- Title: classes_ldm.modules.diffusionmodules Pages: 1 -->
<svg width="4653pt" height="1115pt"
 viewBox="0.00 0.00 4653.00 1115.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 1111)">
<title>classes_ldm.modules.diffusionmodules</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-1111 4649,-1111 4649,4 -4,4"/>
<!-- diffusionmodules.openaimodel.AttentionBlock -->
<g id="node1" class="node">
<title>diffusionmodules.openaimodel.AttentionBlock</title>
<polygon fill="none" stroke="black" points="237.5,-406.5 237.5,-565.5 406.5,-565.5 406.5,-406.5 237.5,-406.5"/>
<text text-anchor="middle" x="322" y="-550.3" font-family="Times,serif" font-size="14.00">AttentionBlock</text>
<polyline fill="none" stroke="black" points="237.5,-542.5 406.5,-542.5 "/>
<text text-anchor="start" x="245.5" y="-527.3" font-family="Times,serif" font-size="14.00">attention</text>
<text text-anchor="start" x="245.5" y="-512.3" font-family="Times,serif" font-size="14.00">channels</text>
<text text-anchor="start" x="245.5" y="-497.3" font-family="Times,serif" font-size="14.00">norm</text>
<text text-anchor="start" x="245.5" y="-482.3" font-family="Times,serif" font-size="14.00">num_heads : int</text>
<text text-anchor="start" x="245.5" y="-467.3" font-family="Times,serif" font-size="14.00">proj_out</text>
<text text-anchor="start" x="245.5" y="-452.3" font-family="Times,serif" font-size="14.00">qkv</text>
<text text-anchor="start" x="245.5" y="-437.3" font-family="Times,serif" font-size="14.00">use_checkpoint : bool</text>
<polyline fill="none" stroke="black" points="237.5,-429.5 406.5,-429.5 "/>
<text text-anchor="start" x="245.5" y="-414.3" font-family="Times,serif" font-size="14.00">forward(x)</text>
</g>
<!-- diffusionmodules.openaimodel.AttentionPool2d -->
<g id="node2" class="node">
<title>diffusionmodules.openaimodel.AttentionPool2d</title>
<polygon fill="none" stroke="black" points="22.5,-421.5 22.5,-550.5 195.5,-550.5 195.5,-421.5 22.5,-421.5"/>
<text text-anchor="middle" x="109" y="-535.3" font-family="Times,serif" font-size="14.00">AttentionPool2d</text>
<polyline fill="none" stroke="black" points="22.5,-527.5 195.5,-527.5 "/>
<text text-anchor="start" x="30.5" y="-512.3" font-family="Times,serif" font-size="14.00">attention</text>
<text text-anchor="start" x="30.5" y="-497.3" font-family="Times,serif" font-size="14.00">c_proj</text>
<text text-anchor="start" x="30.5" y="-482.3" font-family="Times,serif" font-size="14.00">num_heads</text>
<text text-anchor="start" x="30.5" y="-467.3" font-family="Times,serif" font-size="14.00">positional_embedding</text>
<text text-anchor="start" x="30.5" y="-452.3" font-family="Times,serif" font-size="14.00">qkv_proj</text>
<polyline fill="none" stroke="black" points="22.5,-444.5 195.5,-444.5 "/>
<text text-anchor="start" x="30.5" y="-429.3" font-family="Times,serif" font-size="14.00">forward(x)</text>
</g>
<!-- diffusionmodules.model.AttnBlock -->
<g id="node3" class="node">
<title>diffusionmodules.model.AttnBlock</title>
<polygon fill="none" stroke="black" points="472,-75.5 472,-219.5 572,-219.5 572,-75.5 472,-75.5"/>
<text text-anchor="middle" x="522" y="-204.3" font-family="Times,serif" font-size="14.00">AttnBlock</text>
<polyline fill="none" stroke="black" points="472,-196.5 572,-196.5 "/>
<text text-anchor="start" x="480" y="-181.3" font-family="Times,serif" font-size="14.00">in_channels</text>
<text text-anchor="start" x="480" y="-166.3" font-family="Times,serif" font-size="14.00">k</text>
<text text-anchor="start" x="480" y="-151.3" font-family="Times,serif" font-size="14.00">norm</text>
<text text-anchor="start" x="480" y="-136.3" font-family="Times,serif" font-size="14.00">proj_out</text>
<text text-anchor="start" x="480" y="-121.3" font-family="Times,serif" font-size="14.00">q</text>
<text text-anchor="start" x="480" y="-106.3" font-family="Times,serif" font-size="14.00">v</text>
<polyline fill="none" stroke="black" points="472,-98.5 572,-98.5 "/>
<text text-anchor="start" x="480" y="-83.3" font-family="Times,serif" font-size="14.00">forward(x)</text>
</g>
<!-- diffusionmodules.model.LatentRescaler -->
<g id="node15" class="node">
<title>diffusionmodules.model.LatentRescaler</title>
<polygon fill="none" stroke="black" points="619.5,-414 619.5,-558 744.5,-558 744.5,-414 619.5,-414"/>
<text text-anchor="middle" x="682" y="-542.8" font-family="Times,serif" font-size="14.00">LatentRescaler</text>
<polyline fill="none" stroke="black" points="619.5,-535 744.5,-535 "/>
<text text-anchor="start" x="627.5" y="-519.8" font-family="Times,serif" font-size="14.00">attn</text>
<text text-anchor="start" x="627.5" y="-504.8" font-family="Times,serif" font-size="14.00">conv_in</text>
<text text-anchor="start" x="627.5" y="-489.8" font-family="Times,serif" font-size="14.00">conv_out</text>
<text text-anchor="start" x="627.5" y="-474.8" font-family="Times,serif" font-size="14.00">factor</text>
<text text-anchor="start" x="627.5" y="-459.8" font-family="Times,serif" font-size="14.00">res_block1</text>
<text text-anchor="start" x="627.5" y="-444.8" font-family="Times,serif" font-size="14.00">res_block2</text>
<polyline fill="none" stroke="black" points="619.5,-437 744.5,-437 "/>
<text text-anchor="start" x="627.5" y="-421.8" font-family="Times,serif" font-size="14.00">forward(x)</text>
</g>
<!-- diffusionmodules.model.AttnBlock&#45;&gt;diffusionmodules.model.LatentRescaler -->
<g id="edge4" class="edge">
<title>diffusionmodules.model.AttnBlock&#45;&gt;diffusionmodules.model.LatentRescaler</title>
<path fill="none" stroke="black" d="M548.87,-219.56C558.47,-243.74 569.72,-270.76 581,-295 597.79,-331.06 618.08,-369.99 636.06,-403.17"/>
<polygon fill="black" stroke="black" points="636.07,-403.19 642.46,-406.55 641.81,-413.73 635.43,-410.37 636.07,-403.19"/>
<text text-anchor="middle" x="612" y="-316.8" font-family="Times,serif" font-size="14.00" fill="green">attn</text>
</g>
<!-- diffusionmodules.util.CheckpointFunction -->
<g id="node4" class="node">
<title>diffusionmodules.util.CheckpointFunction</title>
<polygon fill="none" stroke="black" points="826.5,-105 826.5,-190 1085.5,-190 1085.5,-105 826.5,-105"/>
<text text-anchor="middle" x="956" y="-174.8" font-family="Times,serif" font-size="14.00">CheckpointFunction</text>
<polyline fill="none" stroke="black" points="826.5,-167 1085.5,-167 "/>
<polyline fill="none" stroke="black" points="826.5,-143 1085.5,-143 "/>
<text text-anchor="start" x="834.5" y="-127.8" font-family="Times,serif" font-size="14.00">backward(ctx)</text>
<text text-anchor="start" x="834.5" y="-112.8" font-family="Times,serif" font-size="14.00">forward(ctx, run_function, length)</text>
</g>
<!-- diffusionmodules.model.Decoder -->
<g id="node5" class="node">
<title>diffusionmodules.model.Decoder</title>
<polygon fill="none" stroke="black" points="435,-346.5 435,-625.5 589,-625.5 589,-346.5 435,-346.5"/>
<text text-anchor="middle" x="512" y="-610.3" font-family="Times,serif" font-size="14.00">Decoder</text>
<polyline fill="none" stroke="black" points="435,-602.5 589,-602.5 "/>
<text text-anchor="start" x="443" y="-587.3" font-family="Times,serif" font-size="14.00">ch</text>
<text text-anchor="start" x="443" y="-572.3" font-family="Times,serif" font-size="14.00">conv_in</text>
<text text-anchor="start" x="443" y="-557.3" font-family="Times,serif" font-size="14.00">conv_out</text>
<text text-anchor="start" x="443" y="-542.3" font-family="Times,serif" font-size="14.00">give_pre_end : bool</text>
<text text-anchor="start" x="443" y="-527.3" font-family="Times,serif" font-size="14.00">in_channels</text>
<text text-anchor="start" x="443" y="-512.3" font-family="Times,serif" font-size="14.00">last_z_shape</text>
<text text-anchor="start" x="443" y="-497.3" font-family="Times,serif" font-size="14.00">mid</text>
<text text-anchor="start" x="443" y="-482.3" font-family="Times,serif" font-size="14.00">norm_out</text>
<text text-anchor="start" x="443" y="-467.3" font-family="Times,serif" font-size="14.00">num_res_blocks</text>
<text text-anchor="start" x="443" y="-452.3" font-family="Times,serif" font-size="14.00">num_resolutions</text>
<text text-anchor="start" x="443" y="-437.3" font-family="Times,serif" font-size="14.00">resolution</text>
<text text-anchor="start" x="443" y="-422.3" font-family="Times,serif" font-size="14.00">tanh_out : bool</text>
<text text-anchor="start" x="443" y="-407.3" font-family="Times,serif" font-size="14.00">temb_ch : int</text>
<text text-anchor="start" x="443" y="-392.3" font-family="Times,serif" font-size="14.00">up</text>
<text text-anchor="start" x="443" y="-377.3" font-family="Times,serif" font-size="14.00">z_shape : tuple</text>
<polyline fill="none" stroke="black" points="435,-369.5 589,-369.5 "/>
<text text-anchor="start" x="443" y="-354.3" font-family="Times,serif" font-size="14.00">forward(z)</text>
</g>
<!-- diffusionmodules.model.MergedRescaleDecoder -->
<g id="node18" class="node">
<title>diffusionmodules.model.MergedRescaleDecoder</title>
<polygon fill="none" stroke="black" points="536,-850 536,-934 722,-934 722,-850 536,-850"/>
<text text-anchor="middle" x="629" y="-918.8" font-family="Times,serif" font-size="14.00">MergedRescaleDecoder</text>
<polyline fill="none" stroke="black" points="536,-911 722,-911 "/>
<text text-anchor="start" x="544" y="-895.8" font-family="Times,serif" font-size="14.00">decoder</text>
<text text-anchor="start" x="544" y="-880.8" font-family="Times,serif" font-size="14.00">rescaler</text>
<polyline fill="none" stroke="black" points="536,-873 722,-873 "/>
<text text-anchor="start" x="544" y="-857.8" font-family="Times,serif" font-size="14.00">forward(x)</text>
</g>
<!-- diffusionmodules.model.Decoder&#45;&gt;diffusionmodules.model.MergedRescaleDecoder -->
<g id="edge5" class="edge">
<title>diffusionmodules.model.Decoder&#45;&gt;diffusionmodules.model.MergedRescaleDecoder</title>
<path fill="none" stroke="black" d="M515.54,-625.69C517.2,-637.04 519.31,-648.26 522,-659 538.34,-724.33 572.94,-793.77 598.38,-839.47"/>
<polygon fill="black" stroke="black" points="598.42,-839.54 604.85,-842.8 604.31,-849.99 597.88,-846.73 598.42,-839.54"/>
<text text-anchor="middle" x="551" y="-647.8" font-family="Times,serif" font-size="14.00" fill="green">decoder</text>
</g>
<!-- diffusionmodules.model.Upsampler -->
<g id="node40" class="node">
<title>diffusionmodules.model.Upsampler</title>
<polygon fill="none" stroke="black" points="398.5,-850 398.5,-934 493.5,-934 493.5,-850 398.5,-850"/>
<text text-anchor="middle" x="446" y="-918.8" font-family="Times,serif" font-size="14.00">Upsampler</text>
<polyline fill="none" stroke="black" points="398.5,-911 493.5,-911 "/>
<text text-anchor="start" x="406.5" y="-895.8" font-family="Times,serif" font-size="14.00">decoder</text>
<text text-anchor="start" x="406.5" y="-880.8" font-family="Times,serif" font-size="14.00">rescaler</text>
<polyline fill="none" stroke="black" points="398.5,-873 493.5,-873 "/>
<text text-anchor="start" x="406.5" y="-857.8" font-family="Times,serif" font-size="14.00">forward(x)</text>
</g>
<!-- diffusionmodules.model.Decoder&#45;&gt;diffusionmodules.model.Upsampler -->
<g id="edge6" class="edge">
<title>diffusionmodules.model.Decoder&#45;&gt;diffusionmodules.model.Upsampler</title>
<path fill="none" stroke="black" d="M445.57,-625.92C443.83,-631.96 442.29,-638.01 441,-644 426.84,-709.65 431.88,-787.4 437.92,-837.89"/>
<polygon fill="black" stroke="black" points="437.92,-837.89 442.64,-843.34 439.43,-849.8 434.7,-844.35 437.92,-837.89"/>
<text text-anchor="middle" x="470" y="-647.8" font-family="Times,serif" font-size="14.00" fill="green">decoder</text>
</g>
<!-- diffusionmodules.model.Decoder_Mix -->
<g id="node6" class="node">
<title>diffusionmodules.model.Decoder_Mix</title>
<polygon fill="none" stroke="black" points="1104,-0.5 1104,-294.5 1258,-294.5 1258,-0.5 1104,-0.5"/>
<text text-anchor="middle" x="1181" y="-279.3" font-family="Times,serif" font-size="14.00">Decoder_Mix</text>
<polyline fill="none" stroke="black" points="1104,-271.5 1258,-271.5 "/>
<text text-anchor="start" x="1112" y="-256.3" font-family="Times,serif" font-size="14.00">ch</text>
<text text-anchor="start" x="1112" y="-241.3" font-family="Times,serif" font-size="14.00">conv_in</text>
<text text-anchor="start" x="1112" y="-226.3" font-family="Times,serif" font-size="14.00">conv_out</text>
<text text-anchor="start" x="1112" y="-211.3" font-family="Times,serif" font-size="14.00">fusion_w : float</text>
<text text-anchor="start" x="1112" y="-196.3" font-family="Times,serif" font-size="14.00">give_pre_end : bool</text>
<text text-anchor="start" x="1112" y="-181.3" font-family="Times,serif" font-size="14.00">in_channels</text>
<text text-anchor="start" x="1112" y="-166.3" font-family="Times,serif" font-size="14.00">last_z_shape</text>
<text text-anchor="start" x="1112" y="-151.3" font-family="Times,serif" font-size="14.00">mid</text>
<text text-anchor="start" x="1112" y="-136.3" font-family="Times,serif" font-size="14.00">norm_out</text>
<text text-anchor="start" x="1112" y="-121.3" font-family="Times,serif" font-size="14.00">num_res_blocks</text>
<text text-anchor="start" x="1112" y="-106.3" font-family="Times,serif" font-size="14.00">num_resolutions</text>
<text text-anchor="start" x="1112" y="-91.3" font-family="Times,serif" font-size="14.00">resolution</text>
<text text-anchor="start" x="1112" y="-76.3" font-family="Times,serif" font-size="14.00">tanh_out : bool</text>
<text text-anchor="start" x="1112" y="-61.3" font-family="Times,serif" font-size="14.00">temb_ch : int</text>
<text text-anchor="start" x="1112" y="-46.3" font-family="Times,serif" font-size="14.00">up</text>
<text text-anchor="start" x="1112" y="-31.3" font-family="Times,serif" font-size="14.00">z_shape : tuple</text>
<polyline fill="none" stroke="black" points="1104,-23.5 1258,-23.5 "/>
<text text-anchor="start" x="1112" y="-8.3" font-family="Times,serif" font-size="14.00">forward(z, enc_fea)</text>
</g>
<!-- diffusionmodules.model.Downsample -->
<g id="node7" class="node">
<title>diffusionmodules.model.Downsample</title>
<polygon fill="none" stroke="black" points="1276,-105.5 1276,-189.5 1384,-189.5 1384,-105.5 1276,-105.5"/>
<text text-anchor="middle" x="1330" y="-174.3" font-family="Times,serif" font-size="14.00">Downsample</text>
<polyline fill="none" stroke="black" points="1276,-166.5 1384,-166.5 "/>
<text text-anchor="start" x="1284" y="-151.3" font-family="Times,serif" font-size="14.00">conv</text>
<text text-anchor="start" x="1284" y="-136.3" font-family="Times,serif" font-size="14.00">with_conv</text>
<polyline fill="none" stroke="black" points="1276,-128.5 1384,-128.5 "/>
<text text-anchor="start" x="1284" y="-113.3" font-family="Times,serif" font-size="14.00">forward(x)</text>
</g>
<!-- diffusionmodules.openaimodel.Downsample -->
<g id="node8" class="node">
<title>diffusionmodules.openaimodel.Downsample</title>
<polygon fill="none" stroke="black" points="1402,-83 1402,-212 1512,-212 1512,-83 1402,-83"/>
<text text-anchor="middle" x="1457" y="-196.8" font-family="Times,serif" font-size="14.00">Downsample</text>
<polyline fill="none" stroke="black" points="1402,-189 1512,-189 "/>
<text text-anchor="start" x="1410" y="-173.8" font-family="Times,serif" font-size="14.00">channels</text>
<text text-anchor="start" x="1410" y="-158.8" font-family="Times,serif" font-size="14.00">dims : int</text>
<text text-anchor="start" x="1410" y="-143.8" font-family="Times,serif" font-size="14.00">op</text>
<text text-anchor="start" x="1410" y="-128.8" font-family="Times,serif" font-size="14.00">out_channels</text>
<text text-anchor="start" x="1410" y="-113.8" font-family="Times,serif" font-size="14.00">use_conv</text>
<polyline fill="none" stroke="black" points="1402,-106 1512,-106 "/>
<text text-anchor="start" x="1410" y="-90.8" font-family="Times,serif" font-size="14.00">forward(x)</text>
</g>
<!-- diffusionmodules.openaimodel.ResBlock -->
<g id="node24" class="node">
<title>diffusionmodules.openaimodel.ResBlock</title>
<polygon fill="none" stroke="black" points="1581.5,-354 1581.5,-618 1792.5,-618 1792.5,-354 1581.5,-354"/>
<text text-anchor="middle" x="1687" y="-602.8" font-family="Times,serif" font-size="14.00">ResBlock</text>
<polyline fill="none" stroke="black" points="1581.5,-595 1792.5,-595 "/>
<text text-anchor="start" x="1589.5" y="-579.8" font-family="Times,serif" font-size="14.00">channels</text>
<text text-anchor="start" x="1589.5" y="-564.8" font-family="Times,serif" font-size="14.00">dropout</text>
<text text-anchor="start" x="1589.5" y="-549.8" font-family="Times,serif" font-size="14.00">emb_channels</text>
<text text-anchor="start" x="1589.5" y="-534.8" font-family="Times,serif" font-size="14.00">emb_layers</text>
<text text-anchor="start" x="1589.5" y="-519.8" font-family="Times,serif" font-size="14.00">h_upd</text>
<text text-anchor="start" x="1589.5" y="-504.8" font-family="Times,serif" font-size="14.00">in_layers</text>
<text text-anchor="start" x="1589.5" y="-489.8" font-family="Times,serif" font-size="14.00">out_channels</text>
<text text-anchor="start" x="1589.5" y="-474.8" font-family="Times,serif" font-size="14.00">out_layers</text>
<text text-anchor="start" x="1589.5" y="-459.8" font-family="Times,serif" font-size="14.00">skip_connection</text>
<text text-anchor="start" x="1589.5" y="-444.8" font-family="Times,serif" font-size="14.00">updown : bool</text>
<text text-anchor="start" x="1589.5" y="-429.8" font-family="Times,serif" font-size="14.00">use_checkpoint : bool</text>
<text text-anchor="start" x="1589.5" y="-414.8" font-family="Times,serif" font-size="14.00">use_conv : bool</text>
<text text-anchor="start" x="1589.5" y="-399.8" font-family="Times,serif" font-size="14.00">use_scale_shift_norm : bool</text>
<text text-anchor="start" x="1589.5" y="-384.8" font-family="Times,serif" font-size="14.00">x_upd</text>
<polyline fill="none" stroke="black" points="1581.5,-377 1792.5,-377 "/>
<text text-anchor="start" x="1589.5" y="-361.8" font-family="Times,serif" font-size="14.00">forward(x, emb)</text>
</g>
<!-- diffusionmodules.openaimodel.Downsample&#45;&gt;diffusionmodules.openaimodel.ResBlock -->
<g id="edge14" class="edge">
<title>diffusionmodules.openaimodel.Downsample&#45;&gt;diffusionmodules.openaimodel.ResBlock</title>
<path fill="none" stroke="black" d="M1500.53,-212.19C1526.01,-249.47 1559.25,-298.09 1590.59,-343.94"/>
<polygon fill="black" stroke="black" points="1590.68,-344.08 1597.37,-346.78 1597.45,-353.99 1590.76,-351.29 1590.68,-344.08"/>
<text text-anchor="middle" x="1600.5" y="-316.8" font-family="Times,serif" font-size="14.00" fill="green">h_upd</text>
</g>
<!-- diffusionmodules.openaimodel.Downsample&#45;&gt;diffusionmodules.openaimodel.ResBlock -->
<g id="edge15" class="edge">
<title>diffusionmodules.openaimodel.Downsample&#45;&gt;diffusionmodules.openaimodel.ResBlock</title>
<path fill="none" stroke="black" d="M1473.69,-212.36C1484.83,-248.18 1501.75,-292.64 1525,-328 1533.36,-340.71 1551.56,-360.17 1572.87,-381.1"/>
<polygon fill="black" stroke="black" points="1572.9,-381.13 1579.99,-382.45 1581.5,-389.51 1574.41,-388.19 1572.9,-381.13"/>
<text text-anchor="middle" x="1546.5" y="-316.8" font-family="Times,serif" font-size="14.00" fill="green">x_upd</text>
</g>
<!-- diffusionmodules.openaimodel.ResBlockDual -->
<g id="node25" class="node">
<title>diffusionmodules.openaimodel.ResBlockDual</title>
<polygon fill="none" stroke="black" points="1318.5,-346.5 1318.5,-625.5 1529.5,-625.5 1529.5,-346.5 1318.5,-346.5"/>
<text text-anchor="middle" x="1424" y="-610.3" font-family="Times,serif" font-size="14.00">ResBlockDual</text>
<polyline fill="none" stroke="black" points="1318.5,-602.5 1529.5,-602.5 "/>
<text text-anchor="start" x="1326.5" y="-587.3" font-family="Times,serif" font-size="14.00">channels</text>
<text text-anchor="start" x="1326.5" y="-572.3" font-family="Times,serif" font-size="14.00">dropout</text>
<text text-anchor="start" x="1326.5" y="-557.3" font-family="Times,serif" font-size="14.00">emb_channels</text>
<text text-anchor="start" x="1326.5" y="-542.3" font-family="Times,serif" font-size="14.00">emb_layers</text>
<text text-anchor="start" x="1326.5" y="-527.3" font-family="Times,serif" font-size="14.00">h_upd</text>
<text text-anchor="start" x="1326.5" y="-512.3" font-family="Times,serif" font-size="14.00">in_layers</text>
<text text-anchor="start" x="1326.5" y="-497.3" font-family="Times,serif" font-size="14.00">out_channels</text>
<text text-anchor="start" x="1326.5" y="-482.3" font-family="Times,serif" font-size="14.00">out_layers</text>
<text text-anchor="start" x="1326.5" y="-467.3" font-family="Times,serif" font-size="14.00">skip_connection</text>
<text text-anchor="start" x="1326.5" y="-452.3" font-family="Times,serif" font-size="14.00">spade</text>
<text text-anchor="start" x="1326.5" y="-437.3" font-family="Times,serif" font-size="14.00">updown : bool</text>
<text text-anchor="start" x="1326.5" y="-422.3" font-family="Times,serif" font-size="14.00">use_checkpoint : bool</text>
<text text-anchor="start" x="1326.5" y="-407.3" font-family="Times,serif" font-size="14.00">use_conv : bool</text>
<text text-anchor="start" x="1326.5" y="-392.3" font-family="Times,serif" font-size="14.00">use_scale_shift_norm : bool</text>
<text text-anchor="start" x="1326.5" y="-377.3" font-family="Times,serif" font-size="14.00">x_upd</text>
<polyline fill="none" stroke="black" points="1318.5,-369.5 1529.5,-369.5 "/>
<text text-anchor="start" x="1326.5" y="-354.3" font-family="Times,serif" font-size="14.00">forward(x, emb, s_cond)</text>
</g>
<!-- diffusionmodules.openaimodel.Downsample&#45;&gt;diffusionmodules.openaimodel.ResBlockDual -->
<g id="edge16" class="edge">
<title>diffusionmodules.openaimodel.Downsample&#45;&gt;diffusionmodules.openaimodel.ResBlockDual</title>
<path fill="none" stroke="black" d="M1425.41,-212.06C1412.27,-241.91 1398.58,-278.46 1392,-313 1390.69,-319.88 1389.88,-326.92 1389.48,-334.03"/>
<polygon fill="black" stroke="black" points="1389.48,-334.05 1393.33,-340.14 1389.19,-346.05 1385.33,-339.95 1389.48,-334.05"/>
<text text-anchor="middle" x="1413.5" y="-316.8" font-family="Times,serif" font-size="14.00" fill="green">h_upd</text>
</g>
<!-- diffusionmodules.openaimodel.Downsample&#45;&gt;diffusionmodules.openaimodel.ResBlockDual -->
<g id="edge17" class="edge">
<title>diffusionmodules.openaimodel.Downsample&#45;&gt;diffusionmodules.openaimodel.ResBlockDual</title>
<path fill="none" stroke="black" d="M1441.54,-212.21C1431.77,-240.78 1416.44,-272.93 1393,-295 1376.11,-310.91 1357.28,-293.98 1344,-313 1339.23,-319.83 1336.19,-326.99 1334.57,-334.34"/>
<polygon fill="black" stroke="black" points="1334.55,-334.54 1337.83,-340.97 1333.16,-346.46 1329.88,-340.04 1334.55,-334.54"/>
<text text-anchor="middle" x="1365.5" y="-316.8" font-family="Times,serif" font-size="14.00" fill="green">x_upd</text>
</g>
<!-- diffusionmodules.model.Encoder -->
<g id="node9" class="node">
<title>diffusionmodules.model.Encoder</title>
<polygon fill="none" stroke="black" points="762.5,-369 762.5,-603 937.5,-603 937.5,-369 762.5,-369"/>
<text text-anchor="middle" x="850" y="-587.8" font-family="Times,serif" font-size="14.00">Encoder</text>
<polyline fill="none" stroke="black" points="762.5,-580 937.5,-580 "/>
<text text-anchor="start" x="770.5" y="-564.8" font-family="Times,serif" font-size="14.00">ch</text>
<text text-anchor="start" x="770.5" y="-549.8" font-family="Times,serif" font-size="14.00">conv_in</text>
<text text-anchor="start" x="770.5" y="-534.8" font-family="Times,serif" font-size="14.00">conv_out</text>
<text text-anchor="start" x="770.5" y="-519.8" font-family="Times,serif" font-size="14.00">down</text>
<text text-anchor="start" x="770.5" y="-504.8" font-family="Times,serif" font-size="14.00">in_ch_mult : tuple</text>
<text text-anchor="start" x="770.5" y="-489.8" font-family="Times,serif" font-size="14.00">in_channels</text>
<text text-anchor="start" x="770.5" y="-474.8" font-family="Times,serif" font-size="14.00">mid</text>
<text text-anchor="start" x="770.5" y="-459.8" font-family="Times,serif" font-size="14.00">norm_out</text>
<text text-anchor="start" x="770.5" y="-444.8" font-family="Times,serif" font-size="14.00">num_res_blocks</text>
<text text-anchor="start" x="770.5" y="-429.8" font-family="Times,serif" font-size="14.00">num_resolutions</text>
<text text-anchor="start" x="770.5" y="-414.8" font-family="Times,serif" font-size="14.00">resolution</text>
<text text-anchor="start" x="770.5" y="-399.8" font-family="Times,serif" font-size="14.00">temb_ch : int</text>
<polyline fill="none" stroke="black" points="762.5,-392 937.5,-392 "/>
<text text-anchor="start" x="770.5" y="-376.8" font-family="Times,serif" font-size="14.00">forward(x, return_fea)</text>
</g>
<!-- diffusionmodules.model.MergedRescaleEncoder -->
<g id="node19" class="node">
<title>diffusionmodules.model.MergedRescaleEncoder</title>
<polygon fill="none" stroke="black" points="746,-850 746,-934 932,-934 932,-850 746,-850"/>
<text text-anchor="middle" x="839" y="-918.8" font-family="Times,serif" font-size="14.00">MergedRescaleEncoder</text>
<polyline fill="none" stroke="black" points="746,-911 932,-911 "/>
<text text-anchor="start" x="754" y="-895.8" font-family="Times,serif" font-size="14.00">encoder</text>
<text text-anchor="start" x="754" y="-880.8" font-family="Times,serif" font-size="14.00">rescaler</text>
<polyline fill="none" stroke="black" points="746,-873 932,-873 "/>
<text text-anchor="start" x="754" y="-857.8" font-family="Times,serif" font-size="14.00">forward(x)</text>
</g>
<!-- diffusionmodules.model.Encoder&#45;&gt;diffusionmodules.model.MergedRescaleEncoder -->
<g id="edge7" class="edge">
<title>diffusionmodules.model.Encoder&#45;&gt;diffusionmodules.model.MergedRescaleEncoder</title>
<path fill="none" stroke="black" d="M846.84,-603.04C844.74,-680.31 842.07,-778.2 840.45,-837.64"/>
<polygon fill="black" stroke="black" points="840.45,-837.73 844.29,-843.83 840.12,-849.72 836.29,-843.62 840.45,-837.73"/>
<text text-anchor="middle" x="875" y="-647.8" font-family="Times,serif" font-size="14.00" fill="green">encoder</text>
</g>
<!-- diffusionmodules.openaimodel.EncoderUNetModelWT -->
<g id="node10" class="node">
<title>diffusionmodules.openaimodel.EncoderUNetModelWT</title>
<polygon fill="none" stroke="black" points="2132,-715 2132,-1069 2338,-1069 2338,-715 2132,-715"/>
<text text-anchor="middle" x="2235" y="-1053.8" font-family="Times,serif" font-size="14.00">EncoderUNetModelWT</text>
<polyline fill="none" stroke="black" points="2132,-1046 2338,-1046 "/>
<text text-anchor="start" x="2140" y="-1030.8" font-family="Times,serif" font-size="14.00">attention_resolutions</text>
<text text-anchor="start" x="2140" y="-1015.8" font-family="Times,serif" font-size="14.00">channel_mult : tuple</text>
<text text-anchor="start" x="2140" y="-1000.8" font-family="Times,serif" font-size="14.00">conv_resample : bool</text>
<text text-anchor="start" x="2140" y="-985.8" font-family="Times,serif" font-size="14.00">dropout : int</text>
<text text-anchor="start" x="2140" y="-970.8" font-family="Times,serif" font-size="14.00">dtype</text>
<text text-anchor="start" x="2140" y="-955.8" font-family="Times,serif" font-size="14.00">fea_tran</text>
<text text-anchor="start" x="2140" y="-940.8" font-family="Times,serif" font-size="14.00">in_channels</text>
<text text-anchor="start" x="2140" y="-925.8" font-family="Times,serif" font-size="14.00">input_block_chans : list</text>
<text text-anchor="start" x="2140" y="-910.8" font-family="Times,serif" font-size="14.00">input_blocks</text>
<text text-anchor="start" x="2140" y="-895.8" font-family="Times,serif" font-size="14.00">middle_block</text>
<text text-anchor="start" x="2140" y="-880.8" font-family="Times,serif" font-size="14.00">model_channels</text>
<text text-anchor="start" x="2140" y="-865.8" font-family="Times,serif" font-size="14.00">num_head_channels : int</text>
<text text-anchor="start" x="2140" y="-850.8" font-family="Times,serif" font-size="14.00">num_heads : int</text>
<text text-anchor="start" x="2140" y="-835.8" font-family="Times,serif" font-size="14.00">num_heads_upsample : int</text>
<text text-anchor="start" x="2140" y="-820.8" font-family="Times,serif" font-size="14.00">num_res_blocks</text>
<text text-anchor="start" x="2140" y="-805.8" font-family="Times,serif" font-size="14.00">out_channels</text>
<text text-anchor="start" x="2140" y="-790.8" font-family="Times,serif" font-size="14.00">time_embed</text>
<text text-anchor="start" x="2140" y="-775.8" font-family="Times,serif" font-size="14.00">use_checkpoint : bool</text>
<polyline fill="none" stroke="black" points="2132,-768 2338,-768 "/>
<text text-anchor="start" x="2140" y="-752.8" font-family="Times,serif" font-size="14.00">convert_to_fp16()</text>
<text text-anchor="start" x="2140" y="-737.8" font-family="Times,serif" font-size="14.00">convert_to_fp32()</text>
<text text-anchor="start" x="2140" y="-722.8" font-family="Times,serif" font-size="14.00">forward(x, timesteps)</text>
</g>
<!-- diffusionmodules.model.FirstStagePostProcessor -->
<g id="node11" class="node">
<title>diffusionmodules.model.FirstStagePostProcessor</title>
<polygon fill="none" stroke="black" points="1877,-60.5 1877,-234.5 2107,-234.5 2107,-60.5 1877,-60.5"/>
<text text-anchor="middle" x="1992" y="-219.3" font-family="Times,serif" font-size="14.00">FirstStagePostProcessor</text>
<polyline fill="none" stroke="black" points="1877,-211.5 2107,-211.5 "/>
<text text-anchor="start" x="1885" y="-196.3" font-family="Times,serif" font-size="14.00">do_reshape : bool</text>
<text text-anchor="start" x="1885" y="-181.3" font-family="Times,serif" font-size="14.00">downsampler</text>
<text text-anchor="start" x="1885" y="-166.3" font-family="Times,serif" font-size="14.00">model</text>
<text text-anchor="start" x="1885" y="-151.3" font-family="Times,serif" font-size="14.00">pretrained_model : NoneType</text>
<text text-anchor="start" x="1885" y="-136.3" font-family="Times,serif" font-size="14.00">proj</text>
<text text-anchor="start" x="1885" y="-121.3" font-family="Times,serif" font-size="14.00">proj_norm</text>
<polyline fill="none" stroke="black" points="1877,-113.5 2107,-113.5 "/>
<text text-anchor="start" x="1885" y="-98.3" font-family="Times,serif" font-size="14.00">encode_with_pretrained(x)</text>
<text text-anchor="start" x="1885" y="-83.3" font-family="Times,serif" font-size="14.00">forward(x)</text>
<text text-anchor="start" x="1885" y="-68.3" font-family="Times,serif" font-size="14.00">instantiate_pretrained(config)</text>
</g>
<!-- diffusionmodules.model.Fuse_sft_block_RRDB -->
<g id="node12" class="node">
<title>diffusionmodules.model.Fuse_sft_block_RRDB</title>
<polygon fill="none" stroke="black" points="2311,-436.5 2311,-535.5 2543,-535.5 2543,-436.5 2311,-436.5"/>
<text text-anchor="middle" x="2427" y="-520.3" font-family="Times,serif" font-size="14.00">Fuse_sft_block_RRDB</text>
<polyline fill="none" stroke="black" points="2311,-512.5 2543,-512.5 "/>
<text text-anchor="start" x="2319" y="-497.3" font-family="Times,serif" font-size="14.00">encode_enc_1</text>
<text text-anchor="start" x="2319" y="-482.3" font-family="Times,serif" font-size="14.00">encode_enc_2</text>
<text text-anchor="start" x="2319" y="-467.3" font-family="Times,serif" font-size="14.00">encode_enc_3</text>
<polyline fill="none" stroke="black" points="2311,-459.5 2543,-459.5 "/>
<text text-anchor="start" x="2319" y="-444.3" font-family="Times,serif" font-size="14.00">forward(enc_feat, dec_feat, w)</text>
</g>
<!-- diffusionmodules.util.GroupNorm32 -->
<g id="node13" class="node">
<title>diffusionmodules.util.GroupNorm32</title>
<polygon fill="none" stroke="black" points="2542.5,-112.5 2542.5,-182.5 2661.5,-182.5 2661.5,-112.5 2542.5,-112.5"/>
<text text-anchor="middle" x="2602" y="-167.3" font-family="Times,serif" font-size="14.00">GroupNorm32</text>
<polyline fill="none" stroke="black" points="2542.5,-159.5 2661.5,-159.5 "/>
<polyline fill="none" stroke="black" points="2542.5,-135.5 2661.5,-135.5 "/>
<text text-anchor="start" x="2550.5" y="-120.3" font-family="Times,serif" font-size="14.00">forward(x)</text>
</g>
<!-- diffusionmodules.util.HybridConditioner -->
<g id="node14" class="node">
<title>diffusionmodules.util.HybridConditioner</title>
<polygon fill="none" stroke="black" points="2680,-105.5 2680,-189.5 2914,-189.5 2914,-105.5 2680,-105.5"/>
<text text-anchor="middle" x="2797" y="-174.3" font-family="Times,serif" font-size="14.00">HybridConditioner</text>
<polyline fill="none" stroke="black" points="2680,-166.5 2914,-166.5 "/>
<text text-anchor="start" x="2688" y="-151.3" font-family="Times,serif" font-size="14.00">concat_conditioner</text>
<text text-anchor="start" x="2688" y="-136.3" font-family="Times,serif" font-size="14.00">crossattn_conditioner</text>
<polyline fill="none" stroke="black" points="2680,-128.5 2914,-128.5 "/>
<text text-anchor="start" x="2688" y="-113.3" font-family="Times,serif" font-size="14.00">forward(c_concat, c_crossattn)</text>
</g>
<!-- diffusionmodules.model.LatentRescaler&#45;&gt;diffusionmodules.model.MergedRescaleDecoder -->
<g id="edge8" class="edge">
<title>diffusionmodules.model.LatentRescaler&#45;&gt;diffusionmodules.model.MergedRescaleDecoder</title>
<path fill="none" stroke="black" d="M673.56,-558.16C669.82,-589.15 665.3,-625.89 661,-659 653.01,-720.44 643.2,-790.94 636.56,-837.94"/>
<polygon fill="black" stroke="black" points="636.54,-838.07 639.66,-844.58 634.86,-849.96 631.74,-843.45 636.54,-838.07"/>
<text text-anchor="middle" x="692" y="-647.8" font-family="Times,serif" font-size="14.00" fill="green">rescaler</text>
</g>
<!-- diffusionmodules.model.LatentRescaler&#45;&gt;diffusionmodules.model.MergedRescaleEncoder -->
<g id="edge9" class="edge">
<title>diffusionmodules.model.LatentRescaler&#45;&gt;diffusionmodules.model.MergedRescaleEncoder</title>
<path fill="none" stroke="black" d="M709.71,-558.3C740.89,-638.55 790.83,-767.04 818.63,-838.58"/>
<polygon fill="black" stroke="black" points="818.71,-838.8 824.62,-842.94 823.06,-849.98 817.16,-845.84 818.71,-838.8"/>
<text text-anchor="middle" x="776" y="-647.8" font-family="Times,serif" font-size="14.00" fill="green">rescaler</text>
</g>
<!-- diffusionmodules.model.LatentRescaler&#45;&gt;diffusionmodules.model.Upsampler -->
<g id="edge10" class="edge">
<title>diffusionmodules.model.LatentRescaler&#45;&gt;diffusionmodules.model.Upsampler</title>
<path fill="none" stroke="black" d="M653.83,-558.4C636.99,-592.99 612.49,-632.65 580,-659 560.68,-674.67 544.89,-659.71 527,-677 482.58,-719.91 462.24,-789.63 453.11,-837.77"/>
<polygon fill="black" stroke="black" points="453.07,-838 455.96,-844.61 450.98,-849.81 448.09,-843.21 453.07,-838"/>
<text text-anchor="middle" x="625" y="-647.8" font-family="Times,serif" font-size="14.00" fill="green">rescaler</text>
</g>
<!-- diffusionmodules.model.LinAttnBlock -->
<g id="node16" class="node">
<title>diffusionmodules.model.LinAttnBlock</title>
<polygon fill="none" stroke="black" points="2932.5,-112.5 2932.5,-182.5 3041.5,-182.5 3041.5,-112.5 2932.5,-112.5"/>
<text text-anchor="middle" x="2987" y="-167.3" font-family="Times,serif" font-size="14.00">LinAttnBlock</text>
<polyline fill="none" stroke="black" points="2932.5,-159.5 3041.5,-159.5 "/>
<polyline fill="none" stroke="black" points="2932.5,-135.5 3041.5,-135.5 "/>
<text text-anchor="middle" x="2987" y="-120.3" font-family="Times,serif" font-size="14.00"> </text>
</g>
<!-- diffusionmodules.model.MemoryEfficientAttnBlock -->
<g id="node17" class="node">
<title>diffusionmodules.model.MemoryEfficientAttnBlock</title>
<polygon fill="none" stroke="black" points="590,-68 590,-227 808,-227 808,-68 590,-68"/>
<text text-anchor="middle" x="699" y="-211.8" font-family="Times,serif" font-size="14.00">MemoryEfficientAttnBlock</text>
<polyline fill="none" stroke="black" points="590,-204 808,-204 "/>
<text text-anchor="start" x="598" y="-188.8" font-family="Times,serif" font-size="14.00">attention_op : Optional[Any]</text>
<text text-anchor="start" x="598" y="-173.8" font-family="Times,serif" font-size="14.00">in_channels</text>
<text text-anchor="start" x="598" y="-158.8" font-family="Times,serif" font-size="14.00">k</text>
<text text-anchor="start" x="598" y="-143.8" font-family="Times,serif" font-size="14.00">norm</text>
<text text-anchor="start" x="598" y="-128.8" font-family="Times,serif" font-size="14.00">proj_out</text>
<text text-anchor="start" x="598" y="-113.8" font-family="Times,serif" font-size="14.00">q</text>
<text text-anchor="start" x="598" y="-98.8" font-family="Times,serif" font-size="14.00">v</text>
<polyline fill="none" stroke="black" points="590,-91 808,-91 "/>
<text text-anchor="start" x="598" y="-75.8" font-family="Times,serif" font-size="14.00">forward(x)</text>
</g>
<!-- diffusionmodules.model.MemoryEfficientAttnBlock&#45;&gt;diffusionmodules.model.LatentRescaler -->
<g id="edge11" class="edge">
<title>diffusionmodules.model.MemoryEfficientAttnBlock&#45;&gt;diffusionmodules.model.LatentRescaler</title>
<path fill="none" stroke="black" d="M695.01,-227.39C692.37,-279.75 688.9,-348.36 686.21,-401.61"/>
<polygon fill="black" stroke="black" points="686.2,-401.78 689.9,-407.97 685.6,-413.76 681.91,-407.57 686.2,-401.78"/>
<text text-anchor="middle" x="706" y="-316.8" font-family="Times,serif" font-size="14.00" fill="green">attn</text>
</g>
<!-- diffusionmodules.model.Model -->
<g id="node20" class="node">
<title>diffusionmodules.model.Model</title>
<polygon fill="none" stroke="black" points="3059.5,-8 3059.5,-287 3228.5,-287 3228.5,-8 3059.5,-8"/>
<text text-anchor="middle" x="3144" y="-271.8" font-family="Times,serif" font-size="14.00">Model</text>
<polyline fill="none" stroke="black" points="3059.5,-264 3228.5,-264 "/>
<text text-anchor="start" x="3067.5" y="-248.8" font-family="Times,serif" font-size="14.00">ch</text>
<text text-anchor="start" x="3067.5" y="-233.8" font-family="Times,serif" font-size="14.00">conv_in</text>
<text text-anchor="start" x="3067.5" y="-218.8" font-family="Times,serif" font-size="14.00">conv_out</text>
<text text-anchor="start" x="3067.5" y="-203.8" font-family="Times,serif" font-size="14.00">down</text>
<text text-anchor="start" x="3067.5" y="-188.8" font-family="Times,serif" font-size="14.00">in_channels</text>
<text text-anchor="start" x="3067.5" y="-173.8" font-family="Times,serif" font-size="14.00">mid</text>
<text text-anchor="start" x="3067.5" y="-158.8" font-family="Times,serif" font-size="14.00">norm_out</text>
<text text-anchor="start" x="3067.5" y="-143.8" font-family="Times,serif" font-size="14.00">num_res_blocks</text>
<text text-anchor="start" x="3067.5" y="-128.8" font-family="Times,serif" font-size="14.00">num_resolutions</text>
<text text-anchor="start" x="3067.5" y="-113.8" font-family="Times,serif" font-size="14.00">resolution</text>
<text text-anchor="start" x="3067.5" y="-98.8" font-family="Times,serif" font-size="14.00">temb</text>
<text text-anchor="start" x="3067.5" y="-83.8" font-family="Times,serif" font-size="14.00">temb_ch</text>
<text text-anchor="start" x="3067.5" y="-68.8" font-family="Times,serif" font-size="14.00">up</text>
<text text-anchor="start" x="3067.5" y="-53.8" font-family="Times,serif" font-size="14.00">use_timestep : bool</text>
<polyline fill="none" stroke="black" points="3059.5,-46 3228.5,-46 "/>
<text text-anchor="start" x="3067.5" y="-30.8" font-family="Times,serif" font-size="14.00">forward(x, t, context)</text>
<text text-anchor="start" x="3067.5" y="-15.8" font-family="Times,serif" font-size="14.00">get_last_layer()</text>
</g>
<!-- diffusionmodules.openaimodel.QKVAttention -->
<g id="node21" class="node">
<title>diffusionmodules.openaimodel.QKVAttention</title>
<polygon fill="none" stroke="black" points="0,-98 0,-197 218,-197 218,-98 0,-98"/>
<text text-anchor="middle" x="109" y="-181.8" font-family="Times,serif" font-size="14.00">QKVAttention</text>
<polyline fill="none" stroke="black" points="0,-174 218,-174 "/>
<text text-anchor="start" x="8" y="-158.8" font-family="Times,serif" font-size="14.00">attention_op : Optional[Any]</text>
<text text-anchor="start" x="8" y="-143.8" font-family="Times,serif" font-size="14.00">n_heads</text>
<polyline fill="none" stroke="black" points="0,-136 218,-136 "/>
<text text-anchor="start" x="8" y="-120.8" font-family="Times,serif" font-size="14.00">count_flops(model, _x, y)</text>
<text text-anchor="start" x="8" y="-105.8" font-family="Times,serif" font-size="14.00">forward(qkv)</text>
</g>
<!-- diffusionmodules.openaimodel.QKVAttention&#45;&gt;diffusionmodules.openaimodel.AttentionBlock -->
<g id="edge18" class="edge">
<title>diffusionmodules.openaimodel.QKVAttention&#45;&gt;diffusionmodules.openaimodel.AttentionBlock</title>
<path fill="none" stroke="black" d="M139.74,-197.07C172.54,-248.88 225.2,-332.08 265.51,-395.75"/>
<polygon fill="black" stroke="black" points="265.7,-396.05 272.29,-398.98 272.12,-406.19 265.53,-403.26 265.7,-396.05"/>
<text text-anchor="middle" x="255" y="-316.8" font-family="Times,serif" font-size="14.00" fill="green">attention</text>
</g>
<!-- diffusionmodules.openaimodel.QKVAttention&#45;&gt;diffusionmodules.openaimodel.AttentionPool2d -->
<g id="edge19" class="edge">
<title>diffusionmodules.openaimodel.QKVAttention&#45;&gt;diffusionmodules.openaimodel.AttentionPool2d</title>
<path fill="none" stroke="black" d="M109,-197.07C109,-252.56 109,-344.04 109,-408.99"/>
<polygon fill="black" stroke="black" points="109,-409.2 113,-415.2 109,-421.2 105,-415.2 109,-409.2"/>
<text text-anchor="middle" x="142" y="-316.8" font-family="Times,serif" font-size="14.00" fill="green">attention</text>
</g>
<!-- diffusionmodules.openaimodel.QKVAttentionLegacy -->
<g id="node22" class="node">
<title>diffusionmodules.openaimodel.QKVAttentionLegacy</title>
<polygon fill="none" stroke="black" points="236,-98 236,-197 454,-197 454,-98 236,-98"/>
<text text-anchor="middle" x="345" y="-181.8" font-family="Times,serif" font-size="14.00">QKVAttentionLegacy</text>
<polyline fill="none" stroke="black" points="236,-174 454,-174 "/>
<text text-anchor="start" x="244" y="-158.8" font-family="Times,serif" font-size="14.00">attention_op : Optional[Any]</text>
<text text-anchor="start" x="244" y="-143.8" font-family="Times,serif" font-size="14.00">n_heads</text>
<polyline fill="none" stroke="black" points="236,-136 454,-136 "/>
<text text-anchor="start" x="244" y="-120.8" font-family="Times,serif" font-size="14.00">count_flops(model, _x, y)</text>
<text text-anchor="start" x="244" y="-105.8" font-family="Times,serif" font-size="14.00">forward(qkv)</text>
</g>
<!-- diffusionmodules.openaimodel.QKVAttentionLegacy&#45;&gt;diffusionmodules.openaimodel.AttentionBlock -->
<g id="edge20" class="edge">
<title>diffusionmodules.openaimodel.QKVAttentionLegacy&#45;&gt;diffusionmodules.openaimodel.AttentionBlock</title>
<path fill="none" stroke="black" d="M341.68,-197.07C338.17,-248.45 332.55,-330.71 328.21,-394.17"/>
<polygon fill="black" stroke="black" points="328.2,-394.22 331.79,-400.48 327.39,-406.19 323.8,-399.93 328.2,-394.22"/>
<text text-anchor="middle" x="367" y="-316.8" font-family="Times,serif" font-size="14.00" fill="green">attention</text>
</g>
<!-- diffusionmodules.model.ResBlock -->
<g id="node23" class="node">
<title>diffusionmodules.model.ResBlock</title>
<polygon fill="none" stroke="black" points="2329.5,-68 2329.5,-227 2524.5,-227 2524.5,-68 2329.5,-68"/>
<text text-anchor="middle" x="2427" y="-211.8" font-family="Times,serif" font-size="14.00">ResBlock</text>
<polyline fill="none" stroke="black" points="2329.5,-204 2524.5,-204 "/>
<text text-anchor="start" x="2337.5" y="-188.8" font-family="Times,serif" font-size="14.00">conv1</text>
<text text-anchor="start" x="2337.5" y="-173.8" font-family="Times,serif" font-size="14.00">conv2</text>
<text text-anchor="start" x="2337.5" y="-158.8" font-family="Times,serif" font-size="14.00">conv_out</text>
<text text-anchor="start" x="2337.5" y="-143.8" font-family="Times,serif" font-size="14.00">in_channels</text>
<text text-anchor="start" x="2337.5" y="-128.8" font-family="Times,serif" font-size="14.00">norm1</text>
<text text-anchor="start" x="2337.5" y="-113.8" font-family="Times,serif" font-size="14.00">norm2</text>
<text text-anchor="start" x="2337.5" y="-98.8" font-family="Times,serif" font-size="14.00">out_channels : NoneType</text>
<polyline fill="none" stroke="black" points="2329.5,-91 2524.5,-91 "/>
<text text-anchor="start" x="2337.5" y="-75.8" font-family="Times,serif" font-size="14.00">forward(x_in)</text>
</g>
<!-- diffusionmodules.model.ResBlock&#45;&gt;diffusionmodules.model.Fuse_sft_block_RRDB -->
<g id="edge12" class="edge">
<title>diffusionmodules.model.ResBlock&#45;&gt;diffusionmodules.model.Fuse_sft_block_RRDB</title>
<path fill="none" stroke="black" d="M2382.28,-227.21C2369.62,-258.12 2360.77,-294.23 2367,-328 2373.15,-361.31 2386.06,-396.7 2398.33,-425.42"/>
<polygon fill="black" stroke="black" points="2398.37,-425.5 2404.43,-429.39 2403.17,-436.49 2397.1,-432.6 2398.37,-425.5"/>
<text text-anchor="middle" x="2416" y="-316.8" font-family="Times,serif" font-size="14.00" fill="green">encode_enc_1</text>
</g>
<!-- diffusionmodules.model.ResBlock&#45;&gt;diffusionmodules.model.Fuse_sft_block_RRDB -->
<g id="edge13" class="edge">
<title>diffusionmodules.model.ResBlock&#45;&gt;diffusionmodules.model.Fuse_sft_block_RRDB</title>
<path fill="none" stroke="black" d="M2455.09,-227.07C2463.23,-258.28 2468.98,-294.63 2465,-328 2461.13,-360.43 2452.92,-395.84 2445.12,-424.82"/>
<polygon fill="black" stroke="black" points="2445.11,-424.83 2447.37,-431.68 2441.93,-436.4 2439.66,-429.55 2445.11,-424.83"/>
<text text-anchor="middle" x="2515" y="-316.8" font-family="Times,serif" font-size="14.00" fill="green">encode_enc_3</text>
</g>
<!-- diffusionmodules.openaimodel.TimestepBlock -->
<g id="node30" class="node">
<title>diffusionmodules.openaimodel.TimestepBlock</title>
<polygon fill="none" stroke="black" points="1621.5,-857 1621.5,-927 1752.5,-927 1752.5,-857 1621.5,-857"/>
<text text-anchor="middle" x="1687" y="-911.8" font-family="Times,serif" font-size="14.00">TimestepBlock</text>
<polyline fill="none" stroke="black" points="1621.5,-904 1752.5,-904 "/>
<polyline fill="none" stroke="black" points="1621.5,-880 1752.5,-880 "/>
<text text-anchor="start" x="1629.5" y="-864.8" font-family="Times,serif" font-size="14.00">forward(x, emb)</text>
</g>
<!-- diffusionmodules.openaimodel.ResBlock&#45;&gt;diffusionmodules.openaimodel.TimestepBlock -->
<g id="edge1" class="edge">
<title>diffusionmodules.openaimodel.ResBlock&#45;&gt;diffusionmodules.openaimodel.TimestepBlock</title>
<path fill="none" stroke="black" d="M1687,-618.17C1687,-696.96 1687,-792.2 1687,-846.78"/>
<polygon fill="none" stroke="black" points="1683.5,-846.81 1687,-856.81 1690.5,-846.81 1683.5,-846.81"/>
</g>
<!-- diffusionmodules.openaimodel.TimestepBlockDual -->
<g id="node32" class="node">
<title>diffusionmodules.openaimodel.TimestepBlockDual</title>
<polygon fill="none" stroke="black" points="1337,-857 1337,-927 1511,-927 1511,-857 1337,-857"/>
<text text-anchor="middle" x="1424" y="-911.8" font-family="Times,serif" font-size="14.00">TimestepBlockDual</text>
<polyline fill="none" stroke="black" points="1337,-904 1511,-904 "/>
<polyline fill="none" stroke="black" points="1337,-880 1511,-880 "/>
<text text-anchor="start" x="1345" y="-864.8" font-family="Times,serif" font-size="14.00">forward(x, emb, cond)</text>
</g>
<!-- diffusionmodules.openaimodel.ResBlockDual&#45;&gt;diffusionmodules.openaimodel.TimestepBlockDual -->
<g id="edge2" class="edge">
<title>diffusionmodules.openaimodel.ResBlockDual&#45;&gt;diffusionmodules.openaimodel.TimestepBlockDual</title>
<path fill="none" stroke="black" d="M1424,-625.75C1424,-703.03 1424,-794.04 1424,-846.86"/>
<polygon fill="none" stroke="black" points="1420.5,-846.9 1424,-856.9 1427.5,-846.9 1420.5,-846.9"/>
</g>
<!-- diffusionmodules.model.Resize -->
<g id="node26" class="node">
<title>diffusionmodules.model.Resize</title>
<polygon fill="none" stroke="black" points="3246.5,-98 3246.5,-197 3431.5,-197 3431.5,-98 3246.5,-98"/>
<text text-anchor="middle" x="3339" y="-181.8" font-family="Times,serif" font-size="14.00">Resize</text>
<polyline fill="none" stroke="black" points="3246.5,-174 3431.5,-174 "/>
<text text-anchor="start" x="3254.5" y="-158.8" font-family="Times,serif" font-size="14.00">conv</text>
<text text-anchor="start" x="3254.5" y="-143.8" font-family="Times,serif" font-size="14.00">mode : str</text>
<text text-anchor="start" x="3254.5" y="-128.8" font-family="Times,serif" font-size="14.00">with_conv : bool</text>
<polyline fill="none" stroke="black" points="3246.5,-121 3431.5,-121 "/>
<text text-anchor="start" x="3254.5" y="-105.8" font-family="Times,serif" font-size="14.00">forward(x, scale_factor)</text>
</g>
<!-- diffusionmodules.model.ResnetBlock -->
<g id="node27" class="node">
<title>diffusionmodules.model.ResnetBlock</title>
<polygon fill="none" stroke="black" points="3449.5,-38 3449.5,-257 3644.5,-257 3644.5,-38 3449.5,-38"/>
<text text-anchor="middle" x="3547" y="-241.8" font-family="Times,serif" font-size="14.00">ResnetBlock</text>
<polyline fill="none" stroke="black" points="3449.5,-234 3644.5,-234 "/>
<text text-anchor="start" x="3457.5" y="-218.8" font-family="Times,serif" font-size="14.00">conv1</text>
<text text-anchor="start" x="3457.5" y="-203.8" font-family="Times,serif" font-size="14.00">conv2</text>
<text text-anchor="start" x="3457.5" y="-188.8" font-family="Times,serif" font-size="14.00">conv_shortcut</text>
<text text-anchor="start" x="3457.5" y="-173.8" font-family="Times,serif" font-size="14.00">dropout</text>
<text text-anchor="start" x="3457.5" y="-158.8" font-family="Times,serif" font-size="14.00">in_channels</text>
<text text-anchor="start" x="3457.5" y="-143.8" font-family="Times,serif" font-size="14.00">nin_shortcut</text>
<text text-anchor="start" x="3457.5" y="-128.8" font-family="Times,serif" font-size="14.00">norm1</text>
<text text-anchor="start" x="3457.5" y="-113.8" font-family="Times,serif" font-size="14.00">norm2</text>
<text text-anchor="start" x="3457.5" y="-98.8" font-family="Times,serif" font-size="14.00">out_channels : NoneType</text>
<text text-anchor="start" x="3457.5" y="-83.8" font-family="Times,serif" font-size="14.00">temb_proj</text>
<text text-anchor="start" x="3457.5" y="-68.8" font-family="Times,serif" font-size="14.00">use_conv_shortcut : bool</text>
<polyline fill="none" stroke="black" points="3449.5,-61 3644.5,-61 "/>
<text text-anchor="start" x="3457.5" y="-45.8" font-family="Times,serif" font-size="14.00">forward(x, temb)</text>
</g>
<!-- diffusionmodules.util.SiLU -->
<g id="node28" class="node">
<title>diffusionmodules.util.SiLU</title>
<polygon fill="none" stroke="black" points="3663,-112.5 3663,-182.5 3755,-182.5 3755,-112.5 3663,-112.5"/>
<text text-anchor="middle" x="3709" y="-167.3" font-family="Times,serif" font-size="14.00">SiLU</text>
<polyline fill="none" stroke="black" points="3663,-159.5 3755,-159.5 "/>
<polyline fill="none" stroke="black" points="3663,-135.5 3755,-135.5 "/>
<text text-anchor="start" x="3671" y="-120.3" font-family="Times,serif" font-size="14.00">forward(x)</text>
</g>
<!-- diffusionmodules.model.SimpleDecoder -->
<g id="node29" class="node">
<title>diffusionmodules.model.SimpleDecoder</title>
<polygon fill="none" stroke="black" points="3773.5,-98 3773.5,-197 3898.5,-197 3898.5,-98 3773.5,-98"/>
<text text-anchor="middle" x="3836" y="-181.8" font-family="Times,serif" font-size="14.00">SimpleDecoder</text>
<polyline fill="none" stroke="black" points="3773.5,-174 3898.5,-174 "/>
<text text-anchor="start" x="3781.5" y="-158.8" font-family="Times,serif" font-size="14.00">conv_out</text>
<text text-anchor="start" x="3781.5" y="-143.8" font-family="Times,serif" font-size="14.00">model</text>
<text text-anchor="start" x="3781.5" y="-128.8" font-family="Times,serif" font-size="14.00">norm_out</text>
<polyline fill="none" stroke="black" points="3773.5,-121 3898.5,-121 "/>
<text text-anchor="start" x="3781.5" y="-105.8" font-family="Times,serif" font-size="14.00">forward(x)</text>
</g>
<!-- diffusionmodules.openaimodel.TimestepBlock3cond -->
<g id="node31" class="node">
<title>diffusionmodules.openaimodel.TimestepBlock3cond</title>
<polygon fill="none" stroke="black" points="3916.5,-112.5 3916.5,-182.5 4179.5,-182.5 4179.5,-112.5 3916.5,-112.5"/>
<text text-anchor="middle" x="4048" y="-167.3" font-family="Times,serif" font-size="14.00">TimestepBlock3cond</text>
<polyline fill="none" stroke="black" points="3916.5,-159.5 4179.5,-159.5 "/>
<polyline fill="none" stroke="black" points="3916.5,-135.5 4179.5,-135.5 "/>
<text text-anchor="start" x="3924.5" y="-120.3" font-family="Times,serif" font-size="14.00">forward(x, emb, s_cond, seg_cond)</text>
</g>
<!-- diffusionmodules.openaimodel.TimestepEmbedSequential -->
<g id="node33" class="node">
<title>diffusionmodules.openaimodel.TimestepEmbedSequential</title>
<polygon fill="none" stroke="black" points="1933,-451 1933,-521 2293,-521 2293,-451 1933,-451"/>
<text text-anchor="middle" x="2113" y="-505.8" font-family="Times,serif" font-size="14.00">TimestepEmbedSequential</text>
<polyline fill="none" stroke="black" points="1933,-498 2293,-498 "/>
<polyline fill="none" stroke="black" points="1933,-474 2293,-474 "/>
<text text-anchor="start" x="1941" y="-458.8" font-family="Times,serif" font-size="14.00">forward(x, emb, context, struct_cond, seg_cond)</text>
</g>
<!-- diffusionmodules.openaimodel.TimestepEmbedSequential&#45;&gt;diffusionmodules.openaimodel.EncoderUNetModelWT -->
<g id="edge21" class="edge">
<title>diffusionmodules.openaimodel.TimestepEmbedSequential&#45;&gt;diffusionmodules.openaimodel.EncoderUNetModelWT</title>
<path fill="none" stroke="black" d="M2123.3,-521.1C2135.65,-562 2157.33,-633.79 2178.32,-703.31"/>
<polygon fill="black" stroke="black" points="2178.35,-703.41 2183.91,-708 2181.82,-714.9 2176.26,-710.31 2178.35,-703.41"/>
<text text-anchor="middle" x="2211" y="-647.8" font-family="Times,serif" font-size="14.00" fill="green">middle_block</text>
</g>
<!-- diffusionmodules.openaimodel.TimestepEmbedSequential&#45;&gt;diffusionmodules.openaimodel.TimestepBlock -->
<g id="edge3" class="edge">
<title>diffusionmodules.openaimodel.TimestepEmbedSequential&#45;&gt;diffusionmodules.openaimodel.TimestepBlock</title>
<path fill="none" stroke="black" d="M2005.38,-521.14C1927.6,-550.91 1825.31,-601.33 1761,-677 1719.35,-726.02 1700.71,-799.8 1692.68,-846.66"/>
<polygon fill="none" stroke="black" points="1689.18,-846.38 1691.04,-856.81 1696.09,-847.5 1689.18,-846.38"/>
</g>
<!-- diffusionmodules.openaimodel.UNetModel -->
<g id="node35" class="node">
<title>diffusionmodules.openaimodel.UNetModel</title>
<polygon fill="none" stroke="black" points="2356.5,-677.5 2356.5,-1106.5 2607.5,-1106.5 2607.5,-677.5 2356.5,-677.5"/>
<text text-anchor="middle" x="2482" y="-1091.3" font-family="Times,serif" font-size="14.00">UNetModel</text>
<polyline fill="none" stroke="black" points="2356.5,-1083.5 2607.5,-1083.5 "/>
<text text-anchor="start" x="2364.5" y="-1068.3" font-family="Times,serif" font-size="14.00">attention_resolutions</text>
<text text-anchor="start" x="2364.5" y="-1053.3" font-family="Times,serif" font-size="14.00">channel_mult : tuple</text>
<text text-anchor="start" x="2364.5" y="-1038.3" font-family="Times,serif" font-size="14.00">conv_resample : bool</text>
<text text-anchor="start" x="2364.5" y="-1023.3" font-family="Times,serif" font-size="14.00">dropout : int</text>
<text text-anchor="start" x="2364.5" y="-1008.3" font-family="Times,serif" font-size="14.00">dtype</text>
<text text-anchor="start" x="2364.5" y="-993.3" font-family="Times,serif" font-size="14.00">id_predictor</text>
<text text-anchor="start" x="2364.5" y="-978.3" font-family="Times,serif" font-size="14.00">image_size</text>
<text text-anchor="start" x="2364.5" y="-963.3" font-family="Times,serif" font-size="14.00">in_channels</text>
<text text-anchor="start" x="2364.5" y="-948.3" font-family="Times,serif" font-size="14.00">input_blocks</text>
<text text-anchor="start" x="2364.5" y="-933.3" font-family="Times,serif" font-size="14.00">label_emb</text>
<text text-anchor="start" x="2364.5" y="-918.3" font-family="Times,serif" font-size="14.00">middle_block</text>
<text text-anchor="start" x="2364.5" y="-903.3" font-family="Times,serif" font-size="14.00">model_channels</text>
<text text-anchor="start" x="2364.5" y="-888.3" font-family="Times,serif" font-size="14.00">num_classes : NoneType</text>
<text text-anchor="start" x="2364.5" y="-873.3" font-family="Times,serif" font-size="14.00">num_head_channels : int</text>
<text text-anchor="start" x="2364.5" y="-858.3" font-family="Times,serif" font-size="14.00">num_heads : int</text>
<text text-anchor="start" x="2364.5" y="-843.3" font-family="Times,serif" font-size="14.00">num_heads_upsample : int</text>
<text text-anchor="start" x="2364.5" y="-828.3" font-family="Times,serif" font-size="14.00">num_res_blocks</text>
<text text-anchor="start" x="2364.5" y="-813.3" font-family="Times,serif" font-size="14.00">out</text>
<text text-anchor="start" x="2364.5" y="-798.3" font-family="Times,serif" font-size="14.00">out_channels</text>
<text text-anchor="start" x="2364.5" y="-783.3" font-family="Times,serif" font-size="14.00">output_blocks</text>
<text text-anchor="start" x="2364.5" y="-768.3" font-family="Times,serif" font-size="14.00">predict_codebook_ids</text>
<text text-anchor="start" x="2364.5" y="-753.3" font-family="Times,serif" font-size="14.00">time_embed</text>
<text text-anchor="start" x="2364.5" y="-738.3" font-family="Times,serif" font-size="14.00">use_checkpoint : bool</text>
<polyline fill="none" stroke="black" points="2356.5,-730.5 2607.5,-730.5 "/>
<text text-anchor="start" x="2364.5" y="-715.3" font-family="Times,serif" font-size="14.00">convert_to_fp16()</text>
<text text-anchor="start" x="2364.5" y="-700.3" font-family="Times,serif" font-size="14.00">convert_to_fp32()</text>
<text text-anchor="start" x="2364.5" y="-685.3" font-family="Times,serif" font-size="14.00">forward(x, timesteps, context, y)</text>
</g>
<!-- diffusionmodules.openaimodel.TimestepEmbedSequential&#45;&gt;diffusionmodules.openaimodel.UNetModel -->
<g id="edge22" class="edge">
<title>diffusionmodules.openaimodel.TimestepEmbedSequential&#45;&gt;diffusionmodules.openaimodel.UNetModel</title>
<path fill="none" stroke="black" d="M2164.07,-521.03C2214.4,-556.18 2291.6,-614.57 2347,-677 2347.49,-677.55 2347.98,-678.11 2348.47,-678.66"/>
<polygon fill="black" stroke="black" points="2348.51,-678.72 2355.46,-680.67 2356.32,-687.83 2349.38,-685.87 2348.51,-678.72"/>
<text text-anchor="middle" x="2372" y="-647.8" font-family="Times,serif" font-size="14.00" fill="green">middle_block</text>
</g>
<!-- diffusionmodules.openaimodel.UNetModelDualcondV2 -->
<g id="node36" class="node">
<title>diffusionmodules.openaimodel.UNetModelDualcondV2</title>
<polygon fill="none" stroke="black" points="1770.5,-677.5 1770.5,-1106.5 2113.5,-1106.5 2113.5,-677.5 1770.5,-677.5"/>
<text text-anchor="middle" x="1942" y="-1091.3" font-family="Times,serif" font-size="14.00">UNetModelDualcondV2</text>
<polyline fill="none" stroke="black" points="1770.5,-1083.5 2113.5,-1083.5 "/>
<text text-anchor="start" x="1778.5" y="-1068.3" font-family="Times,serif" font-size="14.00">attention_resolutions</text>
<text text-anchor="start" x="1778.5" y="-1053.3" font-family="Times,serif" font-size="14.00">channel_mult : tuple</text>
<text text-anchor="start" x="1778.5" y="-1038.3" font-family="Times,serif" font-size="14.00">conv_resample : bool</text>
<text text-anchor="start" x="1778.5" y="-1023.3" font-family="Times,serif" font-size="14.00">dropout : int</text>
<text text-anchor="start" x="1778.5" y="-1008.3" font-family="Times,serif" font-size="14.00">dtype</text>
<text text-anchor="start" x="1778.5" y="-993.3" font-family="Times,serif" font-size="14.00">id_predictor</text>
<text text-anchor="start" x="1778.5" y="-978.3" font-family="Times,serif" font-size="14.00">image_size</text>
<text text-anchor="start" x="1778.5" y="-963.3" font-family="Times,serif" font-size="14.00">in_channels</text>
<text text-anchor="start" x="1778.5" y="-948.3" font-family="Times,serif" font-size="14.00">input_blocks</text>
<text text-anchor="start" x="1778.5" y="-933.3" font-family="Times,serif" font-size="14.00">label_emb</text>
<text text-anchor="start" x="1778.5" y="-918.3" font-family="Times,serif" font-size="14.00">middle_block</text>
<text text-anchor="start" x="1778.5" y="-903.3" font-family="Times,serif" font-size="14.00">model_channels</text>
<text text-anchor="start" x="1778.5" y="-888.3" font-family="Times,serif" font-size="14.00">num_classes : NoneType</text>
<text text-anchor="start" x="1778.5" y="-873.3" font-family="Times,serif" font-size="14.00">num_head_channels : int</text>
<text text-anchor="start" x="1778.5" y="-858.3" font-family="Times,serif" font-size="14.00">num_heads : int</text>
<text text-anchor="start" x="1778.5" y="-843.3" font-family="Times,serif" font-size="14.00">num_heads_upsample : int</text>
<text text-anchor="start" x="1778.5" y="-828.3" font-family="Times,serif" font-size="14.00">num_res_blocks</text>
<text text-anchor="start" x="1778.5" y="-813.3" font-family="Times,serif" font-size="14.00">out</text>
<text text-anchor="start" x="1778.5" y="-798.3" font-family="Times,serif" font-size="14.00">out_channels</text>
<text text-anchor="start" x="1778.5" y="-783.3" font-family="Times,serif" font-size="14.00">output_blocks</text>
<text text-anchor="start" x="1778.5" y="-768.3" font-family="Times,serif" font-size="14.00">predict_codebook_ids</text>
<text text-anchor="start" x="1778.5" y="-753.3" font-family="Times,serif" font-size="14.00">time_embed</text>
<text text-anchor="start" x="1778.5" y="-738.3" font-family="Times,serif" font-size="14.00">use_checkpoint : bool</text>
<polyline fill="none" stroke="black" points="1770.5,-730.5 2113.5,-730.5 "/>
<text text-anchor="start" x="1778.5" y="-715.3" font-family="Times,serif" font-size="14.00">convert_to_fp16()</text>
<text text-anchor="start" x="1778.5" y="-700.3" font-family="Times,serif" font-size="14.00">convert_to_fp32()</text>
<text text-anchor="start" x="1778.5" y="-685.3" font-family="Times,serif" font-size="14.00">forward(x, timesteps, context, struct_cond, y)</text>
</g>
<!-- diffusionmodules.openaimodel.TimestepEmbedSequential&#45;&gt;diffusionmodules.openaimodel.UNetModelDualcondV2 -->
<g id="edge23" class="edge">
<title>diffusionmodules.openaimodel.TimestepEmbedSequential&#45;&gt;diffusionmodules.openaimodel.UNetModelDualcondV2</title>
<path fill="none" stroke="black" d="M2098.57,-521.1C2084.38,-554.63 2061.4,-608.9 2037.37,-665.67"/>
<polygon fill="black" stroke="black" points="2037.23,-666 2038.58,-673.09 2032.56,-677.05 2031.21,-669.97 2037.23,-666"/>
<text text-anchor="middle" x="2090" y="-647.8" font-family="Times,serif" font-size="14.00" fill="green">middle_block</text>
</g>
<!-- diffusionmodules.openaimodel.TransposedUpsample -->
<g id="node34" class="node">
<title>diffusionmodules.openaimodel.TransposedUpsample</title>
<polygon fill="none" stroke="black" points="4197.5,-98 4197.5,-197 4368.5,-197 4368.5,-98 4197.5,-98"/>
<text text-anchor="middle" x="4283" y="-181.8" font-family="Times,serif" font-size="14.00">TransposedUpsample</text>
<polyline fill="none" stroke="black" points="4197.5,-174 4368.5,-174 "/>
<text text-anchor="start" x="4205.5" y="-158.8" font-family="Times,serif" font-size="14.00">channels</text>
<text text-anchor="start" x="4205.5" y="-143.8" font-family="Times,serif" font-size="14.00">out_channels</text>
<text text-anchor="start" x="4205.5" y="-128.8" font-family="Times,serif" font-size="14.00">up</text>
<polyline fill="none" stroke="black" points="4197.5,-121 4368.5,-121 "/>
<text text-anchor="start" x="4205.5" y="-105.8" font-family="Times,serif" font-size="14.00">forward(x)</text>
</g>
<!-- diffusionmodules.model.Upsample -->
<g id="node37" class="node">
<title>diffusionmodules.model.Upsample</title>
<polygon fill="none" stroke="black" points="4387,-105.5 4387,-189.5 4479,-189.5 4479,-105.5 4387,-105.5"/>
<text text-anchor="middle" x="4433" y="-174.3" font-family="Times,serif" font-size="14.00">Upsample</text>
<polyline fill="none" stroke="black" points="4387,-166.5 4479,-166.5 "/>
<text text-anchor="start" x="4395" y="-151.3" font-family="Times,serif" font-size="14.00">conv</text>
<text text-anchor="start" x="4395" y="-136.3" font-family="Times,serif" font-size="14.00">with_conv</text>
<polyline fill="none" stroke="black" points="4387,-128.5 4479,-128.5 "/>
<text text-anchor="start" x="4395" y="-113.3" font-family="Times,serif" font-size="14.00">forward(x)</text>
</g>
<!-- diffusionmodules.openaimodel.Upsample -->
<g id="node38" class="node">
<title>diffusionmodules.openaimodel.Upsample</title>
<polygon fill="none" stroke="black" points="1633,-83 1633,-212 1743,-212 1743,-83 1633,-83"/>
<text text-anchor="middle" x="1688" y="-196.8" font-family="Times,serif" font-size="14.00">Upsample</text>
<polyline fill="none" stroke="black" points="1633,-189 1743,-189 "/>
<text text-anchor="start" x="1641" y="-173.8" font-family="Times,serif" font-size="14.00">channels</text>
<text text-anchor="start" x="1641" y="-158.8" font-family="Times,serif" font-size="14.00">conv</text>
<text text-anchor="start" x="1641" y="-143.8" font-family="Times,serif" font-size="14.00">dims : int</text>
<text text-anchor="start" x="1641" y="-128.8" font-family="Times,serif" font-size="14.00">out_channels</text>
<text text-anchor="start" x="1641" y="-113.8" font-family="Times,serif" font-size="14.00">use_conv</text>
<polyline fill="none" stroke="black" points="1633,-106 1743,-106 "/>
<text text-anchor="start" x="1641" y="-90.8" font-family="Times,serif" font-size="14.00">forward(x)</text>
</g>
<!-- diffusionmodules.openaimodel.Upsample&#45;&gt;diffusionmodules.openaimodel.ResBlock -->
<g id="edge24" class="edge">
<title>diffusionmodules.openaimodel.Upsample&#45;&gt;diffusionmodules.openaimodel.ResBlock</title>
<path fill="none" stroke="black" d="M1694.97,-212.02C1697.96,-246.34 1700.47,-289.47 1699,-328 1698.83,-332.5 1698.63,-337.07 1698.41,-341.68"/>
<polygon fill="black" stroke="black" points="1698.39,-341.99 1702.07,-348.19 1697.77,-353.97 1694.08,-347.77 1698.39,-341.99"/>
<text text-anchor="middle" x="1721.5" y="-316.8" font-family="Times,serif" font-size="14.00" fill="green">h_upd</text>
</g>
<!-- diffusionmodules.openaimodel.Upsample&#45;&gt;diffusionmodules.openaimodel.ResBlock -->
<g id="edge25" class="edge">
<title>diffusionmodules.openaimodel.Upsample&#45;&gt;diffusionmodules.openaimodel.ResBlock</title>
<path fill="none" stroke="black" d="M1725.54,-212.21C1741.2,-246.03 1754.26,-288.64 1747,-328 1746.15,-332.63 1745.16,-337.3 1744.06,-341.98"/>
<polygon fill="black" stroke="black" points="1744.06,-342.02 1746.47,-348.81 1741.12,-353.65 1738.71,-346.86 1744.06,-342.02"/>
<text text-anchor="middle" x="1770.5" y="-316.8" font-family="Times,serif" font-size="14.00" fill="green">x_upd</text>
</g>
<!-- diffusionmodules.openaimodel.Upsample&#45;&gt;diffusionmodules.openaimodel.ResBlockDual -->
<g id="edge26" class="edge">
<title>diffusionmodules.openaimodel.Upsample&#45;&gt;diffusionmodules.openaimodel.ResBlockDual</title>
<path fill="none" stroke="black" d="M1632.76,-206.63C1602.09,-236.27 1561.94,-271.03 1521,-295 1500.26,-307.15 1486.32,-295.35 1470,-313 1463.72,-319.78 1458.29,-327.33 1453.58,-335.37"/>
<polygon fill="black" stroke="black" points="1453.45,-335.61 1454.15,-342.78 1447.8,-346.19 1447.1,-339.02 1453.45,-335.61"/>
<text text-anchor="middle" x="1491.5" y="-316.8" font-family="Times,serif" font-size="14.00" fill="green">h_upd</text>
</g>
<!-- diffusionmodules.openaimodel.Upsample&#45;&gt;diffusionmodules.openaimodel.ResBlockDual -->
<g id="edge27" class="edge">
<title>diffusionmodules.openaimodel.Upsample&#45;&gt;diffusionmodules.openaimodel.ResBlockDual</title>
<path fill="none" stroke="black" d="M1680.32,-212.07C1672.57,-250.27 1657.06,-297.28 1626,-328 1608.01,-345.79 1593.73,-333.04 1572,-346 1560.87,-352.64 1549.89,-360.23 1539.25,-368.38"/>
<polygon fill="black" stroke="black" points="1538.99,-368.57 1536.75,-375.43 1529.56,-376 1531.81,-369.14 1538.99,-368.57"/>
<text text-anchor="middle" x="1658.5" y="-316.8" font-family="Times,serif" font-size="14.00" fill="green">x_upd</text>
</g>
<!-- diffusionmodules.model.UpsampleDecoder -->
<g id="node39" class="node">
<title>diffusionmodules.model.UpsampleDecoder</title>
<polygon fill="none" stroke="black" points="4497,-68 4497,-227 4645,-227 4645,-68 4497,-68"/>
<text text-anchor="middle" x="4571" y="-211.8" font-family="Times,serif" font-size="14.00">UpsampleDecoder</text>
<polyline fill="none" stroke="black" points="4497,-204 4645,-204 "/>
<text text-anchor="start" x="4505" y="-188.8" font-family="Times,serif" font-size="14.00">conv_out</text>
<text text-anchor="start" x="4505" y="-173.8" font-family="Times,serif" font-size="14.00">norm_out</text>
<text text-anchor="start" x="4505" y="-158.8" font-family="Times,serif" font-size="14.00">num_res_blocks</text>
<text text-anchor="start" x="4505" y="-143.8" font-family="Times,serif" font-size="14.00">num_resolutions</text>
<text text-anchor="start" x="4505" y="-128.8" font-family="Times,serif" font-size="14.00">res_blocks</text>
<text text-anchor="start" x="4505" y="-113.8" font-family="Times,serif" font-size="14.00">temb_ch : int</text>
<text text-anchor="start" x="4505" y="-98.8" font-family="Times,serif" font-size="14.00">upsample_blocks</text>
<polyline fill="none" stroke="black" points="4497,-91 4645,-91 "/>
<text text-anchor="start" x="4505" y="-75.8" font-family="Times,serif" font-size="14.00">forward(x)</text>
</g>
</g>
</svg>
