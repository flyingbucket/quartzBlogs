<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.50.0 (0)
 -->
<!-- Title: classes_ldm.modules.diffusionmodules.model Pages: 1 -->
<svg width="2388pt" height="770pt"
 viewBox="0.00 0.00 2388.00 770.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 766)">
<title>classes_ldm.modules.diffusionmodules.model</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-766 2384,-766 2384,4 -4,4"/>
<!-- diffusionmodules.model.AttnBlock -->
<g id="node1" class="node">
<title>diffusionmodules.model.AttnBlock</title>
<polygon fill="none" stroke="black" points="135,-75.5 135,-219.5 235,-219.5 235,-75.5 135,-75.5"/>
<text text-anchor="middle" x="185" y="-204.3" font-family="Times,serif" font-size="14.00">AttnBlock</text>
<polyline fill="none" stroke="black" points="135,-196.5 235,-196.5 "/>
<text text-anchor="start" x="143" y="-181.3" font-family="Times,serif" font-size="14.00">in_channels</text>
<text text-anchor="start" x="143" y="-166.3" font-family="Times,serif" font-size="14.00">k</text>
<text text-anchor="start" x="143" y="-151.3" font-family="Times,serif" font-size="14.00">norm</text>
<text text-anchor="start" x="143" y="-136.3" font-family="Times,serif" font-size="14.00">proj_out</text>
<text text-anchor="start" x="143" y="-121.3" font-family="Times,serif" font-size="14.00">q</text>
<text text-anchor="start" x="143" y="-106.3" font-family="Times,serif" font-size="14.00">v</text>
<polyline fill="none" stroke="black" points="135,-98.5 235,-98.5 "/>
<text text-anchor="start" x="143" y="-83.3" font-family="Times,serif" font-size="14.00">forward(x)</text>
</g>
<!-- diffusionmodules.model.LatentRescaler -->
<g id="node8" class="node">
<title>diffusionmodules.model.LatentRescaler</title>
<polygon fill="none" stroke="black" points="211.5,-414 211.5,-558 336.5,-558 336.5,-414 211.5,-414"/>
<text text-anchor="middle" x="274" y="-542.8" font-family="Times,serif" font-size="14.00">LatentRescaler</text>
<polyline fill="none" stroke="black" points="211.5,-535 336.5,-535 "/>
<text text-anchor="start" x="219.5" y="-519.8" font-family="Times,serif" font-size="14.00">attn</text>
<text text-anchor="start" x="219.5" y="-504.8" font-family="Times,serif" font-size="14.00">conv_in</text>
<text text-anchor="start" x="219.5" y="-489.8" font-family="Times,serif" font-size="14.00">conv_out</text>
<text text-anchor="start" x="219.5" y="-474.8" font-family="Times,serif" font-size="14.00">factor</text>
<text text-anchor="start" x="219.5" y="-459.8" font-family="Times,serif" font-size="14.00">res_block1</text>
<text text-anchor="start" x="219.5" y="-444.8" font-family="Times,serif" font-size="14.00">res_block2</text>
<polyline fill="none" stroke="black" points="211.5,-437 336.5,-437 "/>
<text text-anchor="start" x="219.5" y="-421.8" font-family="Times,serif" font-size="14.00">forward(x)</text>
</g>
<!-- diffusionmodules.model.AttnBlock&#45;&gt;diffusionmodules.model.LatentRescaler -->
<g id="edge1" class="edge">
<title>diffusionmodules.model.AttnBlock&#45;&gt;diffusionmodules.model.LatentRescaler</title>
<path fill="none" stroke="black" d="M203.87,-219.86C217.98,-273.18 237.28,-346.18 252.07,-402.08"/>
<polygon fill="black" stroke="black" points="252.08,-402.14 257.49,-406.92 255.15,-413.74 249.75,-408.96 252.08,-402.14"/>
<text text-anchor="middle" x="248" y="-316.8" font-family="Times,serif" font-size="14.00" fill="green">attn</text>
</g>
<!-- diffusionmodules.model.Decoder -->
<g id="node2" class="node">
<title>diffusionmodules.model.Decoder</title>
<polygon fill="none" stroke="black" points="0,-346.5 0,-625.5 154,-625.5 154,-346.5 0,-346.5"/>
<text text-anchor="middle" x="77" y="-610.3" font-family="Times,serif" font-size="14.00">Decoder</text>
<polyline fill="none" stroke="black" points="0,-602.5 154,-602.5 "/>
<text text-anchor="start" x="8" y="-587.3" font-family="Times,serif" font-size="14.00">ch</text>
<text text-anchor="start" x="8" y="-572.3" font-family="Times,serif" font-size="14.00">conv_in</text>
<text text-anchor="start" x="8" y="-557.3" font-family="Times,serif" font-size="14.00">conv_out</text>
<text text-anchor="start" x="8" y="-542.3" font-family="Times,serif" font-size="14.00">give_pre_end : bool</text>
<text text-anchor="start" x="8" y="-527.3" font-family="Times,serif" font-size="14.00">in_channels</text>
<text text-anchor="start" x="8" y="-512.3" font-family="Times,serif" font-size="14.00">last_z_shape</text>
<text text-anchor="start" x="8" y="-497.3" font-family="Times,serif" font-size="14.00">mid</text>
<text text-anchor="start" x="8" y="-482.3" font-family="Times,serif" font-size="14.00">norm_out</text>
<text text-anchor="start" x="8" y="-467.3" font-family="Times,serif" font-size="14.00">num_res_blocks</text>
<text text-anchor="start" x="8" y="-452.3" font-family="Times,serif" font-size="14.00">num_resolutions</text>
<text text-anchor="start" x="8" y="-437.3" font-family="Times,serif" font-size="14.00">resolution</text>
<text text-anchor="start" x="8" y="-422.3" font-family="Times,serif" font-size="14.00">tanh_out : bool</text>
<text text-anchor="start" x="8" y="-407.3" font-family="Times,serif" font-size="14.00">temb_ch : int</text>
<text text-anchor="start" x="8" y="-392.3" font-family="Times,serif" font-size="14.00">up</text>
<text text-anchor="start" x="8" y="-377.3" font-family="Times,serif" font-size="14.00">z_shape : tuple</text>
<polyline fill="none" stroke="black" points="0,-369.5 154,-369.5 "/>
<text text-anchor="start" x="8" y="-354.3" font-family="Times,serif" font-size="14.00">forward(z)</text>
</g>
<!-- diffusionmodules.model.MergedRescaleDecoder -->
<g id="node11" class="node">
<title>diffusionmodules.model.MergedRescaleDecoder</title>
<polygon fill="none" stroke="black" points="132,-677.5 132,-761.5 318,-761.5 318,-677.5 132,-677.5"/>
<text text-anchor="middle" x="225" y="-746.3" font-family="Times,serif" font-size="14.00">MergedRescaleDecoder</text>
<polyline fill="none" stroke="black" points="132,-738.5 318,-738.5 "/>
<text text-anchor="start" x="140" y="-723.3" font-family="Times,serif" font-size="14.00">decoder</text>
<text text-anchor="start" x="140" y="-708.3" font-family="Times,serif" font-size="14.00">rescaler</text>
<polyline fill="none" stroke="black" points="132,-700.5 318,-700.5 "/>
<text text-anchor="start" x="140" y="-685.3" font-family="Times,serif" font-size="14.00">forward(x)</text>
</g>
<!-- diffusionmodules.model.Decoder&#45;&gt;diffusionmodules.model.MergedRescaleDecoder -->
<g id="edge2" class="edge">
<title>diffusionmodules.model.Decoder&#45;&gt;diffusionmodules.model.MergedRescaleDecoder</title>
<path fill="none" stroke="black" d="M96.23,-625.56C101.19,-637.5 107.36,-648.87 115,-659 117.71,-662.59 120.7,-665.99 123.91,-669.21"/>
<polygon fill="black" stroke="black" points="123.96,-669.26 131.1,-670.31 132.87,-677.29 125.74,-676.24 123.96,-669.26"/>
<text text-anchor="middle" x="144" y="-647.8" font-family="Times,serif" font-size="14.00" fill="green">decoder</text>
</g>
<!-- diffusionmodules.model.Upsampler -->
<g id="node20" class="node">
<title>diffusionmodules.model.Upsampler</title>
<polygon fill="none" stroke="black" points="6.5,-677.5 6.5,-761.5 101.5,-761.5 101.5,-677.5 6.5,-677.5"/>
<text text-anchor="middle" x="54" y="-746.3" font-family="Times,serif" font-size="14.00">Upsampler</text>
<polyline fill="none" stroke="black" points="6.5,-738.5 101.5,-738.5 "/>
<text text-anchor="start" x="14.5" y="-723.3" font-family="Times,serif" font-size="14.00">decoder</text>
<text text-anchor="start" x="14.5" y="-708.3" font-family="Times,serif" font-size="14.00">rescaler</text>
<polyline fill="none" stroke="black" points="6.5,-700.5 101.5,-700.5 "/>
<text text-anchor="start" x="14.5" y="-685.3" font-family="Times,serif" font-size="14.00">forward(x)</text>
</g>
<!-- diffusionmodules.model.Decoder&#45;&gt;diffusionmodules.model.Upsampler -->
<g id="edge3" class="edge">
<title>diffusionmodules.model.Decoder&#45;&gt;diffusionmodules.model.Upsampler</title>
<path fill="none" stroke="black" d="M32.35,-625.52C31.78,-636.8 32.21,-648.06 34,-659 34.35,-661.16 34.78,-663.36 35.25,-665.56"/>
<polygon fill="black" stroke="black" points="35.29,-665.7 40.65,-670.52 38.26,-677.32 32.9,-672.5 35.29,-665.7"/>
<text text-anchor="middle" x="63" y="-647.8" font-family="Times,serif" font-size="14.00" fill="green">decoder</text>
</g>
<!-- diffusionmodules.model.Decoder_Mix -->
<g id="node3" class="node">
<title>diffusionmodules.model.Decoder_Mix</title>
<polygon fill="none" stroke="black" points="489,-0.5 489,-294.5 643,-294.5 643,-0.5 489,-0.5"/>
<text text-anchor="middle" x="566" y="-279.3" font-family="Times,serif" font-size="14.00">Decoder_Mix</text>
<polyline fill="none" stroke="black" points="489,-271.5 643,-271.5 "/>
<text text-anchor="start" x="497" y="-256.3" font-family="Times,serif" font-size="14.00">ch</text>
<text text-anchor="start" x="497" y="-241.3" font-family="Times,serif" font-size="14.00">conv_in</text>
<text text-anchor="start" x="497" y="-226.3" font-family="Times,serif" font-size="14.00">conv_out</text>
<text text-anchor="start" x="497" y="-211.3" font-family="Times,serif" font-size="14.00">fusion_w : float</text>
<text text-anchor="start" x="497" y="-196.3" font-family="Times,serif" font-size="14.00">give_pre_end : bool</text>
<text text-anchor="start" x="497" y="-181.3" font-family="Times,serif" font-size="14.00">in_channels</text>
<text text-anchor="start" x="497" y="-166.3" font-family="Times,serif" font-size="14.00">last_z_shape</text>
<text text-anchor="start" x="497" y="-151.3" font-family="Times,serif" font-size="14.00">mid</text>
<text text-anchor="start" x="497" y="-136.3" font-family="Times,serif" font-size="14.00">norm_out</text>
<text text-anchor="start" x="497" y="-121.3" font-family="Times,serif" font-size="14.00">num_res_blocks</text>
<text text-anchor="start" x="497" y="-106.3" font-family="Times,serif" font-size="14.00">num_resolutions</text>
<text text-anchor="start" x="497" y="-91.3" font-family="Times,serif" font-size="14.00">resolution</text>
<text text-anchor="start" x="497" y="-76.3" font-family="Times,serif" font-size="14.00">tanh_out : bool</text>
<text text-anchor="start" x="497" y="-61.3" font-family="Times,serif" font-size="14.00">temb_ch : int</text>
<text text-anchor="start" x="497" y="-46.3" font-family="Times,serif" font-size="14.00">up</text>
<text text-anchor="start" x="497" y="-31.3" font-family="Times,serif" font-size="14.00">z_shape : tuple</text>
<polyline fill="none" stroke="black" points="489,-23.5 643,-23.5 "/>
<text text-anchor="start" x="497" y="-8.3" font-family="Times,serif" font-size="14.00">forward(z, enc_fea)</text>
</g>
<!-- diffusionmodules.model.Downsample -->
<g id="node4" class="node">
<title>diffusionmodules.model.Downsample</title>
<polygon fill="none" stroke="black" points="661,-105.5 661,-189.5 769,-189.5 769,-105.5 661,-105.5"/>
<text text-anchor="middle" x="715" y="-174.3" font-family="Times,serif" font-size="14.00">Downsample</text>
<polyline fill="none" stroke="black" points="661,-166.5 769,-166.5 "/>
<text text-anchor="start" x="669" y="-151.3" font-family="Times,serif" font-size="14.00">conv</text>
<text text-anchor="start" x="669" y="-136.3" font-family="Times,serif" font-size="14.00">with_conv</text>
<polyline fill="none" stroke="black" points="661,-128.5 769,-128.5 "/>
<text text-anchor="start" x="669" y="-113.3" font-family="Times,serif" font-size="14.00">forward(x)</text>
</g>
<!-- diffusionmodules.model.Encoder -->
<g id="node5" class="node">
<title>diffusionmodules.model.Encoder</title>
<polygon fill="none" stroke="black" points="354.5,-369 354.5,-603 529.5,-603 529.5,-369 354.5,-369"/>
<text text-anchor="middle" x="442" y="-587.8" font-family="Times,serif" font-size="14.00">Encoder</text>
<polyline fill="none" stroke="black" points="354.5,-580 529.5,-580 "/>
<text text-anchor="start" x="362.5" y="-564.8" font-family="Times,serif" font-size="14.00">ch</text>
<text text-anchor="start" x="362.5" y="-549.8" font-family="Times,serif" font-size="14.00">conv_in</text>
<text text-anchor="start" x="362.5" y="-534.8" font-family="Times,serif" font-size="14.00">conv_out</text>
<text text-anchor="start" x="362.5" y="-519.8" font-family="Times,serif" font-size="14.00">down</text>
<text text-anchor="start" x="362.5" y="-504.8" font-family="Times,serif" font-size="14.00">in_ch_mult : tuple</text>
<text text-anchor="start" x="362.5" y="-489.8" font-family="Times,serif" font-size="14.00">in_channels</text>
<text text-anchor="start" x="362.5" y="-474.8" font-family="Times,serif" font-size="14.00">mid</text>
<text text-anchor="start" x="362.5" y="-459.8" font-family="Times,serif" font-size="14.00">norm_out</text>
<text text-anchor="start" x="362.5" y="-444.8" font-family="Times,serif" font-size="14.00">num_res_blocks</text>
<text text-anchor="start" x="362.5" y="-429.8" font-family="Times,serif" font-size="14.00">num_resolutions</text>
<text text-anchor="start" x="362.5" y="-414.8" font-family="Times,serif" font-size="14.00">resolution</text>
<text text-anchor="start" x="362.5" y="-399.8" font-family="Times,serif" font-size="14.00">temb_ch : int</text>
<polyline fill="none" stroke="black" points="354.5,-392 529.5,-392 "/>
<text text-anchor="start" x="362.5" y="-376.8" font-family="Times,serif" font-size="14.00">forward(x, return_fea)</text>
</g>
<!-- diffusionmodules.model.MergedRescaleEncoder -->
<g id="node12" class="node">
<title>diffusionmodules.model.MergedRescaleEncoder</title>
<polygon fill="none" stroke="black" points="342,-677.5 342,-761.5 528,-761.5 528,-677.5 342,-677.5"/>
<text text-anchor="middle" x="435" y="-746.3" font-family="Times,serif" font-size="14.00">MergedRescaleEncoder</text>
<polyline fill="none" stroke="black" points="342,-738.5 528,-738.5 "/>
<text text-anchor="start" x="350" y="-723.3" font-family="Times,serif" font-size="14.00">encoder</text>
<text text-anchor="start" x="350" y="-708.3" font-family="Times,serif" font-size="14.00">rescaler</text>
<polyline fill="none" stroke="black" points="342,-700.5 528,-700.5 "/>
<text text-anchor="start" x="350" y="-685.3" font-family="Times,serif" font-size="14.00">forward(x)</text>
</g>
<!-- diffusionmodules.model.Encoder&#45;&gt;diffusionmodules.model.MergedRescaleEncoder -->
<g id="edge4" class="edge">
<title>diffusionmodules.model.Encoder&#45;&gt;diffusionmodules.model.MergedRescaleEncoder</title>
<path fill="none" stroke="black" d="M438.49,-603.09C437.83,-624.83 437.18,-646.55 436.61,-665.18"/>
<polygon fill="black" stroke="black" points="436.61,-665.26 440.43,-671.38 436.25,-677.26 432.43,-671.14 436.61,-665.26"/>
<text text-anchor="middle" x="467" y="-647.8" font-family="Times,serif" font-size="14.00" fill="green">encoder</text>
</g>
<!-- diffusionmodules.model.FirstStagePostProcessor -->
<g id="node6" class="node">
<title>diffusionmodules.model.FirstStagePostProcessor</title>
<polygon fill="none" stroke="black" points="787,-60.5 787,-234.5 1017,-234.5 1017,-60.5 787,-60.5"/>
<text text-anchor="middle" x="902" y="-219.3" font-family="Times,serif" font-size="14.00">FirstStagePostProcessor</text>
<polyline fill="none" stroke="black" points="787,-211.5 1017,-211.5 "/>
<text text-anchor="start" x="795" y="-196.3" font-family="Times,serif" font-size="14.00">do_reshape : bool</text>
<text text-anchor="start" x="795" y="-181.3" font-family="Times,serif" font-size="14.00">downsampler</text>
<text text-anchor="start" x="795" y="-166.3" font-family="Times,serif" font-size="14.00">model</text>
<text text-anchor="start" x="795" y="-151.3" font-family="Times,serif" font-size="14.00">pretrained_model : NoneType</text>
<text text-anchor="start" x="795" y="-136.3" font-family="Times,serif" font-size="14.00">proj</text>
<text text-anchor="start" x="795" y="-121.3" font-family="Times,serif" font-size="14.00">proj_norm</text>
<polyline fill="none" stroke="black" points="787,-113.5 1017,-113.5 "/>
<text text-anchor="start" x="795" y="-98.3" font-family="Times,serif" font-size="14.00">encode_with_pretrained(x)</text>
<text text-anchor="start" x="795" y="-83.3" font-family="Times,serif" font-size="14.00">forward(x)</text>
<text text-anchor="start" x="795" y="-68.3" font-family="Times,serif" font-size="14.00">instantiate_pretrained(config)</text>
</g>
<!-- diffusionmodules.model.Fuse_sft_block_RRDB -->
<g id="node7" class="node">
<title>diffusionmodules.model.Fuse_sft_block_RRDB</title>
<polygon fill="none" stroke="black" points="1017,-436.5 1017,-535.5 1249,-535.5 1249,-436.5 1017,-436.5"/>
<text text-anchor="middle" x="1133" y="-520.3" font-family="Times,serif" font-size="14.00">Fuse_sft_block_RRDB</text>
<polyline fill="none" stroke="black" points="1017,-512.5 1249,-512.5 "/>
<text text-anchor="start" x="1025" y="-497.3" font-family="Times,serif" font-size="14.00">encode_enc_1</text>
<text text-anchor="start" x="1025" y="-482.3" font-family="Times,serif" font-size="14.00">encode_enc_2</text>
<text text-anchor="start" x="1025" y="-467.3" font-family="Times,serif" font-size="14.00">encode_enc_3</text>
<polyline fill="none" stroke="black" points="1017,-459.5 1249,-459.5 "/>
<text text-anchor="start" x="1025" y="-444.3" font-family="Times,serif" font-size="14.00">forward(enc_feat, dec_feat, w)</text>
</g>
<!-- diffusionmodules.model.LatentRescaler&#45;&gt;diffusionmodules.model.MergedRescaleDecoder -->
<g id="edge5" class="edge">
<title>diffusionmodules.model.LatentRescaler&#45;&gt;diffusionmodules.model.MergedRescaleDecoder</title>
<path fill="none" stroke="black" d="M271.11,-558.37C268.46,-589.72 263.45,-626.68 254,-659 253.33,-661.27 252.59,-663.57 251.78,-665.87"/>
<polygon fill="black" stroke="black" points="251.68,-666.11 253.2,-673.16 247.28,-677.28 245.76,-670.23 251.68,-666.11"/>
<text text-anchor="middle" x="287" y="-647.8" font-family="Times,serif" font-size="14.00" fill="green">rescaler</text>
</g>
<!-- diffusionmodules.model.LatentRescaler&#45;&gt;diffusionmodules.model.MergedRescaleEncoder -->
<g id="edge6" class="edge">
<title>diffusionmodules.model.LatentRescaler&#45;&gt;diffusionmodules.model.MergedRescaleEncoder</title>
<path fill="none" stroke="black" d="M305.73,-558.01C316.95,-580.49 330.43,-604.94 345,-626 356.27,-642.3 361.29,-644.68 375,-659 378.07,-662.21 381.26,-665.49 384.49,-668.78"/>
<polygon fill="black" stroke="black" points="384.65,-668.95 391.71,-670.41 393.08,-677.48 386.02,-676.03 384.65,-668.95"/>
<text text-anchor="middle" x="404" y="-647.8" font-family="Times,serif" font-size="14.00" fill="green">rescaler</text>
</g>
<!-- diffusionmodules.model.LatentRescaler&#45;&gt;diffusionmodules.model.Upsampler -->
<g id="edge7" class="edge">
<title>diffusionmodules.model.LatentRescaler&#45;&gt;diffusionmodules.model.Upsampler</title>
<path fill="none" stroke="black" d="M246.05,-558.15C229.37,-592.68 205.11,-632.35 173,-659 154.83,-674.08 144.33,-666.86 123,-677 119.46,-678.68 115.88,-680.49 112.29,-682.38"/>
<polygon fill="black" stroke="black" points="112.12,-682.47 108.78,-688.86 101.59,-688.24 104.93,-681.85 112.12,-682.47"/>
<text text-anchor="middle" x="218" y="-647.8" font-family="Times,serif" font-size="14.00" fill="green">rescaler</text>
</g>
<!-- diffusionmodules.model.LinAttnBlock -->
<g id="node9" class="node">
<title>diffusionmodules.model.LinAttnBlock</title>
<polygon fill="none" stroke="black" points="1248.5,-112.5 1248.5,-182.5 1357.5,-182.5 1357.5,-112.5 1248.5,-112.5"/>
<text text-anchor="middle" x="1303" y="-167.3" font-family="Times,serif" font-size="14.00">LinAttnBlock</text>
<polyline fill="none" stroke="black" points="1248.5,-159.5 1357.5,-159.5 "/>
<polyline fill="none" stroke="black" points="1248.5,-135.5 1357.5,-135.5 "/>
<text text-anchor="middle" x="1303" y="-120.3" font-family="Times,serif" font-size="14.00"> </text>
</g>
<!-- diffusionmodules.model.MemoryEfficientAttnBlock -->
<g id="node10" class="node">
<title>diffusionmodules.model.MemoryEfficientAttnBlock</title>
<polygon fill="none" stroke="black" points="253,-68 253,-227 471,-227 471,-68 253,-68"/>
<text text-anchor="middle" x="362" y="-211.8" font-family="Times,serif" font-size="14.00">MemoryEfficientAttnBlock</text>
<polyline fill="none" stroke="black" points="253,-204 471,-204 "/>
<text text-anchor="start" x="261" y="-188.8" font-family="Times,serif" font-size="14.00">attention_op : Optional[Any]</text>
<text text-anchor="start" x="261" y="-173.8" font-family="Times,serif" font-size="14.00">in_channels</text>
<text text-anchor="start" x="261" y="-158.8" font-family="Times,serif" font-size="14.00">k</text>
<text text-anchor="start" x="261" y="-143.8" font-family="Times,serif" font-size="14.00">norm</text>
<text text-anchor="start" x="261" y="-128.8" font-family="Times,serif" font-size="14.00">proj_out</text>
<text text-anchor="start" x="261" y="-113.8" font-family="Times,serif" font-size="14.00">q</text>
<text text-anchor="start" x="261" y="-98.8" font-family="Times,serif" font-size="14.00">v</text>
<polyline fill="none" stroke="black" points="253,-91 471,-91 "/>
<text text-anchor="start" x="261" y="-75.8" font-family="Times,serif" font-size="14.00">forward(x)</text>
</g>
<!-- diffusionmodules.model.MemoryEfficientAttnBlock&#45;&gt;diffusionmodules.model.LatentRescaler -->
<g id="edge8" class="edge">
<title>diffusionmodules.model.MemoryEfficientAttnBlock&#45;&gt;diffusionmodules.model.LatentRescaler</title>
<path fill="none" stroke="black" d="M341.37,-227.39C327.65,-279.86 309.66,-348.65 295.72,-401.95"/>
<polygon fill="black" stroke="black" points="295.67,-402.15 298.02,-408.97 292.63,-413.76 290.28,-406.94 295.67,-402.15"/>
<text text-anchor="middle" x="333" y="-316.8" font-family="Times,serif" font-size="14.00" fill="green">attn</text>
</g>
<!-- diffusionmodules.model.Model -->
<g id="node13" class="node">
<title>diffusionmodules.model.Model</title>
<polygon fill="none" stroke="black" points="1375.5,-8 1375.5,-287 1544.5,-287 1544.5,-8 1375.5,-8"/>
<text text-anchor="middle" x="1460" y="-271.8" font-family="Times,serif" font-size="14.00">Model</text>
<polyline fill="none" stroke="black" points="1375.5,-264 1544.5,-264 "/>
<text text-anchor="start" x="1383.5" y="-248.8" font-family="Times,serif" font-size="14.00">ch</text>
<text text-anchor="start" x="1383.5" y="-233.8" font-family="Times,serif" font-size="14.00">conv_in</text>
<text text-anchor="start" x="1383.5" y="-218.8" font-family="Times,serif" font-size="14.00">conv_out</text>
<text text-anchor="start" x="1383.5" y="-203.8" font-family="Times,serif" font-size="14.00">down</text>
<text text-anchor="start" x="1383.5" y="-188.8" font-family="Times,serif" font-size="14.00">in_channels</text>
<text text-anchor="start" x="1383.5" y="-173.8" font-family="Times,serif" font-size="14.00">mid</text>
<text text-anchor="start" x="1383.5" y="-158.8" font-family="Times,serif" font-size="14.00">norm_out</text>
<text text-anchor="start" x="1383.5" y="-143.8" font-family="Times,serif" font-size="14.00">num_res_blocks</text>
<text text-anchor="start" x="1383.5" y="-128.8" font-family="Times,serif" font-size="14.00">num_resolutions</text>
<text text-anchor="start" x="1383.5" y="-113.8" font-family="Times,serif" font-size="14.00">resolution</text>
<text text-anchor="start" x="1383.5" y="-98.8" font-family="Times,serif" font-size="14.00">temb</text>
<text text-anchor="start" x="1383.5" y="-83.8" font-family="Times,serif" font-size="14.00">temb_ch</text>
<text text-anchor="start" x="1383.5" y="-68.8" font-family="Times,serif" font-size="14.00">up</text>
<text text-anchor="start" x="1383.5" y="-53.8" font-family="Times,serif" font-size="14.00">use_timestep : bool</text>
<polyline fill="none" stroke="black" points="1375.5,-46 1544.5,-46 "/>
<text text-anchor="start" x="1383.5" y="-30.8" font-family="Times,serif" font-size="14.00">forward(x, t, context)</text>
<text text-anchor="start" x="1383.5" y="-15.8" font-family="Times,serif" font-size="14.00">get_last_layer()</text>
</g>
<!-- diffusionmodules.model.ResBlock -->
<g id="node14" class="node">
<title>diffusionmodules.model.ResBlock</title>
<polygon fill="none" stroke="black" points="1035.5,-68 1035.5,-227 1230.5,-227 1230.5,-68 1035.5,-68"/>
<text text-anchor="middle" x="1133" y="-211.8" font-family="Times,serif" font-size="14.00">ResBlock</text>
<polyline fill="none" stroke="black" points="1035.5,-204 1230.5,-204 "/>
<text text-anchor="start" x="1043.5" y="-188.8" font-family="Times,serif" font-size="14.00">conv1</text>
<text text-anchor="start" x="1043.5" y="-173.8" font-family="Times,serif" font-size="14.00">conv2</text>
<text text-anchor="start" x="1043.5" y="-158.8" font-family="Times,serif" font-size="14.00">conv_out</text>
<text text-anchor="start" x="1043.5" y="-143.8" font-family="Times,serif" font-size="14.00">in_channels</text>
<text text-anchor="start" x="1043.5" y="-128.8" font-family="Times,serif" font-size="14.00">norm1</text>
<text text-anchor="start" x="1043.5" y="-113.8" font-family="Times,serif" font-size="14.00">norm2</text>
<text text-anchor="start" x="1043.5" y="-98.8" font-family="Times,serif" font-size="14.00">out_channels : NoneType</text>
<polyline fill="none" stroke="black" points="1035.5,-91 1230.5,-91 "/>
<text text-anchor="start" x="1043.5" y="-75.8" font-family="Times,serif" font-size="14.00">forward(x_in)</text>
</g>
<!-- diffusionmodules.model.ResBlock&#45;&gt;diffusionmodules.model.Fuse_sft_block_RRDB -->
<g id="edge9" class="edge">
<title>diffusionmodules.model.ResBlock&#45;&gt;diffusionmodules.model.Fuse_sft_block_RRDB</title>
<path fill="none" stroke="black" d="M1088.28,-227.21C1075.62,-258.12 1066.77,-294.23 1073,-328 1079.15,-361.31 1092.06,-396.7 1104.33,-425.42"/>
<polygon fill="black" stroke="black" points="1104.37,-425.5 1110.43,-429.39 1109.17,-436.49 1103.1,-432.6 1104.37,-425.5"/>
<text text-anchor="middle" x="1122" y="-316.8" font-family="Times,serif" font-size="14.00" fill="green">encode_enc_1</text>
</g>
<!-- diffusionmodules.model.ResBlock&#45;&gt;diffusionmodules.model.Fuse_sft_block_RRDB -->
<g id="edge10" class="edge">
<title>diffusionmodules.model.ResBlock&#45;&gt;diffusionmodules.model.Fuse_sft_block_RRDB</title>
<path fill="none" stroke="black" d="M1161.09,-227.07C1169.23,-258.28 1174.98,-294.63 1171,-328 1167.13,-360.43 1158.92,-395.84 1151.12,-424.82"/>
<polygon fill="black" stroke="black" points="1151.11,-424.83 1153.37,-431.68 1147.93,-436.4 1145.66,-429.55 1151.11,-424.83"/>
<text text-anchor="middle" x="1221" y="-316.8" font-family="Times,serif" font-size="14.00" fill="green">encode_enc_3</text>
</g>
<!-- diffusionmodules.model.Resize -->
<g id="node15" class="node">
<title>diffusionmodules.model.Resize</title>
<polygon fill="none" stroke="black" points="1562.5,-98 1562.5,-197 1747.5,-197 1747.5,-98 1562.5,-98"/>
<text text-anchor="middle" x="1655" y="-181.8" font-family="Times,serif" font-size="14.00">Resize</text>
<polyline fill="none" stroke="black" points="1562.5,-174 1747.5,-174 "/>
<text text-anchor="start" x="1570.5" y="-158.8" font-family="Times,serif" font-size="14.00">conv</text>
<text text-anchor="start" x="1570.5" y="-143.8" font-family="Times,serif" font-size="14.00">mode : str</text>
<text text-anchor="start" x="1570.5" y="-128.8" font-family="Times,serif" font-size="14.00">with_conv : bool</text>
<polyline fill="none" stroke="black" points="1562.5,-121 1747.5,-121 "/>
<text text-anchor="start" x="1570.5" y="-105.8" font-family="Times,serif" font-size="14.00">forward(x, scale_factor)</text>
</g>
<!-- diffusionmodules.model.ResnetBlock -->
<g id="node16" class="node">
<title>diffusionmodules.model.ResnetBlock</title>
<polygon fill="none" stroke="black" points="1765.5,-38 1765.5,-257 1960.5,-257 1960.5,-38 1765.5,-38"/>
<text text-anchor="middle" x="1863" y="-241.8" font-family="Times,serif" font-size="14.00">ResnetBlock</text>
<polyline fill="none" stroke="black" points="1765.5,-234 1960.5,-234 "/>
<text text-anchor="start" x="1773.5" y="-218.8" font-family="Times,serif" font-size="14.00">conv1</text>
<text text-anchor="start" x="1773.5" y="-203.8" font-family="Times,serif" font-size="14.00">conv2</text>
<text text-anchor="start" x="1773.5" y="-188.8" font-family="Times,serif" font-size="14.00">conv_shortcut</text>
<text text-anchor="start" x="1773.5" y="-173.8" font-family="Times,serif" font-size="14.00">dropout</text>
<text text-anchor="start" x="1773.5" y="-158.8" font-family="Times,serif" font-size="14.00">in_channels</text>
<text text-anchor="start" x="1773.5" y="-143.8" font-family="Times,serif" font-size="14.00">nin_shortcut</text>
<text text-anchor="start" x="1773.5" y="-128.8" font-family="Times,serif" font-size="14.00">norm1</text>
<text text-anchor="start" x="1773.5" y="-113.8" font-family="Times,serif" font-size="14.00">norm2</text>
<text text-anchor="start" x="1773.5" y="-98.8" font-family="Times,serif" font-size="14.00">out_channels : NoneType</text>
<text text-anchor="start" x="1773.5" y="-83.8" font-family="Times,serif" font-size="14.00">temb_proj</text>
<text text-anchor="start" x="1773.5" y="-68.8" font-family="Times,serif" font-size="14.00">use_conv_shortcut : bool</text>
<polyline fill="none" stroke="black" points="1765.5,-61 1960.5,-61 "/>
<text text-anchor="start" x="1773.5" y="-45.8" font-family="Times,serif" font-size="14.00">forward(x, temb)</text>
</g>
<!-- diffusionmodules.model.SimpleDecoder -->
<g id="node17" class="node">
<title>diffusionmodules.model.SimpleDecoder</title>
<polygon fill="none" stroke="black" points="1978.5,-98 1978.5,-197 2103.5,-197 2103.5,-98 1978.5,-98"/>
<text text-anchor="middle" x="2041" y="-181.8" font-family="Times,serif" font-size="14.00">SimpleDecoder</text>
<polyline fill="none" stroke="black" points="1978.5,-174 2103.5,-174 "/>
<text text-anchor="start" x="1986.5" y="-158.8" font-family="Times,serif" font-size="14.00">conv_out</text>
<text text-anchor="start" x="1986.5" y="-143.8" font-family="Times,serif" font-size="14.00">model</text>
<text text-anchor="start" x="1986.5" y="-128.8" font-family="Times,serif" font-size="14.00">norm_out</text>
<polyline fill="none" stroke="black" points="1978.5,-121 2103.5,-121 "/>
<text text-anchor="start" x="1986.5" y="-105.8" font-family="Times,serif" font-size="14.00">forward(x)</text>
</g>
<!-- diffusionmodules.model.Upsample -->
<g id="node18" class="node">
<title>diffusionmodules.model.Upsample</title>
<polygon fill="none" stroke="black" points="2122,-105.5 2122,-189.5 2214,-189.5 2214,-105.5 2122,-105.5"/>
<text text-anchor="middle" x="2168" y="-174.3" font-family="Times,serif" font-size="14.00">Upsample</text>
<polyline fill="none" stroke="black" points="2122,-166.5 2214,-166.5 "/>
<text text-anchor="start" x="2130" y="-151.3" font-family="Times,serif" font-size="14.00">conv</text>
<text text-anchor="start" x="2130" y="-136.3" font-family="Times,serif" font-size="14.00">with_conv</text>
<polyline fill="none" stroke="black" points="2122,-128.5 2214,-128.5 "/>
<text text-anchor="start" x="2130" y="-113.3" font-family="Times,serif" font-size="14.00">forward(x)</text>
</g>
<!-- diffusionmodules.model.UpsampleDecoder -->
<g id="node19" class="node">
<title>diffusionmodules.model.UpsampleDecoder</title>
<polygon fill="none" stroke="black" points="2232,-68 2232,-227 2380,-227 2380,-68 2232,-68"/>
<text text-anchor="middle" x="2306" y="-211.8" font-family="Times,serif" font-size="14.00">UpsampleDecoder</text>
<polyline fill="none" stroke="black" points="2232,-204 2380,-204 "/>
<text text-anchor="start" x="2240" y="-188.8" font-family="Times,serif" font-size="14.00">conv_out</text>
<text text-anchor="start" x="2240" y="-173.8" font-family="Times,serif" font-size="14.00">norm_out</text>
<text text-anchor="start" x="2240" y="-158.8" font-family="Times,serif" font-size="14.00">num_res_blocks</text>
<text text-anchor="start" x="2240" y="-143.8" font-family="Times,serif" font-size="14.00">num_resolutions</text>
<text text-anchor="start" x="2240" y="-128.8" font-family="Times,serif" font-size="14.00">res_blocks</text>
<text text-anchor="start" x="2240" y="-113.8" font-family="Times,serif" font-size="14.00">temb_ch : int</text>
<text text-anchor="start" x="2240" y="-98.8" font-family="Times,serif" font-size="14.00">upsample_blocks</text>
<polyline fill="none" stroke="black" points="2232,-91 2380,-91 "/>
<text text-anchor="start" x="2240" y="-75.8" font-family="Times,serif" font-size="14.00">forward(x)</text>
</g>
</g>
</svg>
